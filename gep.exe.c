//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    int32_t * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int32_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
    int32_t e20;
    int32_t e21;
    int32_t e22;
    int32_t e23;
    int32_t e24;
    int32_t e25;
    int32_t e26;
    int32_t e27;
    int32_t e28;
    int32_t e29;
    int32_t e30;
    int32_t e31;
    int32_t e32;
    int32_t e33;
    int32_t e34;
    int32_t e35;
    int32_t e36;
    int32_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int32_t e40;
    int32_t e41;
    int32_t e42;
    int32_t e43;
    int32_t e44;
    int32_t e45;
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
};

struct _SECURITY_ATTRIBUTES {
    int32_t e0;
    int32_t * e1;
    bool e2;
};

struct _STARTUPINFOA {
    int32_t e0;
    char * e1;
    char * e2;
    char * e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int16_t e12;
    int16_t e13;
    char * e14;
    int32_t * e15;
    int32_t * e16;
    int32_t * e17;
};

struct _cpinfo {
    int32_t e0;
    char e1[1];
    char e2[1];
};

// ------------------- Function Prototypes --------------------

int32_t __callnewh(int32_t a1);
int32_t __FF_MSGBANNER(void);
int32_t __heap_alloc(uint32_t a1);
int32_t __NMSG_WRITE(int32_t a1);
int32_t _fflush(int32_t a1);
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue);
int32_t entry_point(int32_t a1);
int32_t function_287aad7(void);
int32_t function_287d277(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8);
int32_t function_401000(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401530(int32_t a1, uint32_t a2, int32_t result, int32_t a4);
int32_t function_40163a(int32_t lpMem);
int32_t function_401670(int32_t result, int32_t a2, int32_t a3);
int32_t function_40176e(int32_t a1);
int32_t function_4017c4(int32_t a1, uint32_t a2, int32_t result, int32_t a4);
int32_t function_401920(int32_t a1);
int32_t function_401a78(int32_t a1, int32_t a2, uint32_t a3);
int32_t function_401b04(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401b24(int32_t a1, int32_t a2);
int32_t function_401b37(void);
int32_t function_401b64(int32_t a1);
int32_t function_401b75(int32_t a1);
int32_t function_401b86(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401c1f(int32_t * a1, int32_t * a2);
int32_t function_401c39(int32_t * a1, char * a2);
int32_t function_401c6b(void);
int32_t function_401d10(void);
int32_t function_401d24(char * a1);
int32_t function_401e59(int32_t a1);
int32_t function_401e7c(void);
int32_t function_401e7d(int32_t a1, int32_t a2);
int32_t function_401f92(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite);
int32_t function_40217a(int32_t a1);
int32_t function_4021d6(void);
int32_t function_402250(int32_t result5, uint32_t a2, uint32_t a3);
int32_t function_402585(int32_t a1);
int32_t function_4025c1(void);
int32_t function_4025ff(int32_t a1, int32_t a2);
int32_t function_40262a(int32_t a1, int32_t a2);
int32_t function_402955(int32_t a1);
int32_t function_402c5e(int32_t a1);
int32_t function_402d0f(int32_t a1);
int32_t function_402e0a(int32_t a1);
int32_t function_402ebd(int32_t a1);
int32_t function_402ee8(int32_t a1);
int32_t function_402fc1(uint32_t a1, int32_t a2, int32_t a3);
int32_t function_4031d2(int32_t a1);
int32_t function_40337d(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod);
int32_t function_403417(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_403587(void);
int32_t function_4035ff(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_40368c(int32_t a1, int32_t a2);
int32_t function_4036c9(int32_t a1, int32_t a2, int32_t * a3);
int32_t function_403e0a(int32_t a1, int32_t a2, int32_t result);
int32_t function_403e3f(int32_t result, int32_t a2);
int32_t function_403e70(int32_t a1, int32_t result, int32_t a3);
int32_t function_403ea8(int32_t a1);
int32_t function_403eb5(int32_t a1);
int32_t function_403ec5(int32_t a1);
int32_t function_403ed3(int32_t a1, int32_t a2);
int32_t function_403f50(void);
int32_t function_403fa8(int32_t a1, int32_t ExceptionInfo);
int32_t function_4040e9(int32_t a1, int32_t a2, int32_t a3);
int32_t function_40412c(void);
int32_t function_4041e5(void);
int32_t function_40427e(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5);
int32_t function_404432(void);
int32_t function_404631(void);
int32_t function_404654(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4048c0(int32_t a1);
int32_t function_404904(uint32_t a1, int32_t a2);
int32_t function_40492a(int32_t a1);
int32_t function_404991(uint32_t a1);
int32_t function_4049f0(int32_t result5, uint32_t a2, uint32_t a3);
int32_t function_404d25(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11);
int32_t function_404dba(uint32_t a1, int32_t hHandle);
int32_t function_404e31(uint32_t a1);
int32_t function_404eab(uint32_t a1);
int32_t function_404ee8(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_4051b0(int32_t a1);
int32_t function_40522b(int32_t lpMultiByteStr, int32_t a2);
int32_t function_405390(int32_t result, int32_t a2, int32_t a3);
int32_t function_4053f0(int32_t a1);
int32_t function_405400(int32_t * a1, int32_t a2);
int32_t function_405461(int32_t a1, int32_t result, int32_t a3);
int32_t function_4054e0(int32_t a1);
int32_t function_405679(int32_t result, int32_t a2, int32_t a3, int32_t a4);
int32_t function_4056c3(int32_t a1);
int32_t function_4056f6(void);
int32_t function_40571f(void);
int32_t function_4058a4(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4058c0(int32_t * a1, char * a2, int32_t a3);
int32_t function_405949(uint32_t a1, int32_t a2);
int32_t function_405a8f(void);
int32_t function_405a98(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9);
int32_t function_405cbc(int32_t a1, int32_t result);
int32_t function_405ce7(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7);
int32_t function_405e30(uint32_t a1, int32_t a2);
int32_t function_405eb0(int32_t result);
int32_t function_f9c37359(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0x6000006; // 0x4060bc
char * g2; // 0x40645c
int16_t * g3 = NULL; // 0x406460
int32_t g4 = 0; // 0x407000
int32_t g5 = 0; // 0x407004
int32_t g6 = 0; // 0x407008
int32_t g7 = 0; // 0x407014
int32_t g8 = 0; // 0x407018
int32_t g9 = 0; // 0x407020
int32_t g10 = 0; // 0x407024
int32_t g11 = 0; // 0x407028
char * g12 = "\"L\x84\x42 \xd0\x80\x1c\x04\x88\x01%,@\x01,\x02\xd1\x80\x1e\x1eI.\xe0"; // 0x407030
int32_t g13 = 0x48276839; // 0x4070d8
char * g14 = "\xdc"; // 0x40718c
char * g15; // 0x40718d
char * g16; // 0x40718e
char * g17 = "\x04\xff"; // 0x40718f
char * g18 = "\xff"; // 0x407190
char * g19; // 0x407191
char * g20; // 0x407192
char * g21; // 0x407193
char * g22[4] = {
    "unknown",
    "v1.1.1",
    "v1.2.0",
    "v1.2.1"
}; // 0x4071ac
int32_t g24 = 0; // 0x4073c0
int32_t g25 = 0; // 0x4073d0
int32_t g26 = 0; // 0x4073f0
bool g27 = false; // 0x407420
bool g28 = true; // 0x407630
int32_t g29 = 1; // 0x407634
int32_t g30 = 1016; // 0x407644
int32_t g31 = -1; // 0x407648
char (*g32)[7] = "(null)"; // 0x407650
int16_t (*g33)[7] = L"(null)"; // 0x407654
int32_t g34 = -0x3ffffffb; // 0x407658
int32_t g35 = 0; // 0x407660
int32_t g36 = 3; // 0x4076d0
int32_t g37 = 7; // 0x4076d4
int32_t g38 = 10; // 0x4076d8
int32_t g39 = 140; // 0x4076dc
int32_t g40 = 2; // 0x4076f0
char (*g41)[37] = "R6002\r\n- floating point not loaded\r\n"; // 0x4076f4
int32_t g42 = 1; // 0x407780
int32_t g43 = 22; // 0x407784
bool g44 = false; // 0x4078e8
char * g45 = "\x01\x02\x04\b"; // 0x407b20
int32_t g46 = 932; // 0x407b28
int32_t g47 = -0x7d867da0; // 0x407b2c
char * g48 = "\xa6\xdf"; // 0x407b38
bool g49 = true; // 0x407c18
int32_t g50 = 0; // 0x407c30
int32_t g51 = 0; // 0x407c34
int32_t g52 = 0; // 0x407c38
uint32_t g53 = 0; // 0x407c3c
int32_t g54 = 0; // 0x407c40
int32_t g55 = 0; // 0x407c44
int32_t g56 = 0; // 0x407c48
int32_t g57 = 0; // 0x407c4c
int32_t g58 = 0; // 0x407c50
int32_t g59 = 0; // 0x407c58
int32_t g60 = 0; // 0x407c5c
char * g61; // 0x407c68
char g62 = 0; // 0x407c70
int32_t g63 = 0; // 0x407c74
int32_t g64 = 0; // 0x407c78
int32_t g65 = 0; // 0x407c7c
char * g66; // 0x407c80
int32_t g67 = 0; // 0x407c88
int32_t g68 = 0; // 0x407c8c
int32_t g69 = 0; // 0x407c90
int32_t g70 = 0; // 0x407c94
int32_t g71 = 0; // 0x407c9c
char * g72; // 0x407ca0
int32_t g73 = 0; // 0x407da4
int32_t g74 = 0; // 0x407dac
int32_t g75 = 0; // 0x407db0
int32_t g76 = 0; // 0x407db4
int32_t g77 = 0; // 0x407db8
int32_t g78 = 0; // 0x407dbc
int32_t g79 = 0; // 0x407dc0
int32_t g80 = 0; // 0x407dcc
int32_t g81 = 0; // 0x407ddc
int32_t g82 = 0; // 0x407de4
int32_t g83 = 0; // 0x407de8
int32_t g84 = 0; // 0x407dec
int32_t g85 = 0; // 0x407df0
int32_t g86 = 0; // 0x407dfc
char * g87; // 0x407e00
char * g88; // 0x407f00
char * g89; // 0x407f01
int32_t g90 = 0; // 0x408004
int32_t g91 = 0; // 0x408020
int32_t g92 = 0; // 0x408024
bool g93 = false; // 0x408120
int32_t g94 = 0; // 0x408124
int32_t g95 = 0; // 0x408128
int32_t g96 = 0; // 0x40812c
int32_t g97 = 0; // 0x408130
int32_t g98 = 0; // 0x408134
int32_t g99 = 0; // 0x408138
int32_t g100 = 0; // 0x40813c
char * g101; // 0x408140
int32_t g102 = 0; // 0x408144
int32_t g103 = 0; // 0x408160
int32_t g104 = 0; // 0x409160
int32_t g105 = 0; // 0x409164
int32_t g106 = 0; // 0x409168
int32_t g107 = 0; // 0x40916c
int32_t g108 = 0; // 0x409170
int32_t g109;
int32_t g110;
int32_t g111;
int32_t g112;
int32_t g113;
int32_t g114;
int32_t g115;
int32_t g116;
int32_t g117;
int32_t g118;
int32_t g119;
int32_t g120;
int32_t * g23 = &g103; // 0x4073b0

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x401530
int32_t function_401000(int32_t a1, int32_t a2, int32_t a3) {
    char * v1 = "Gameboy advance Eeprom Patcher (v0.5) by alf66\n"; // bp-284, 0x40100a
    function_401d24("Gameboy advance Eeprom Patcher (v0.5) by alf66\n");
    int32_t v2; // bp-280, 0x401000
    int32_t v3 = &v2; // 0x401021
    if (a1 != 3) {
        // 0x401023
        v1 = (char *)*(int32_t *)a2;
        function_401c39(&g26, "Usage: %s input.gba output.gba\n");
        v1 = (char *)-1;
        function_401b64(-1);
        v3 = (int32_t)&v1;
    }
    int32_t v4 = v3 - 4;
    int32_t * v5 = (int32_t *)v4;
    *v5 = (int32_t)"rb";
    int32_t * v6 = (int32_t *)(*(int32_t *)(v3 + 288) + 4); // 0x401052
    int32_t * v7 = (int32_t *)(v3 - 8);
    *v7 = *v6;
    int32_t v8 = function_401b24((int32_t)&g112, (int32_t)&g112); // 0x401056
    int32_t * v9 = v7; // 0x401062
    if (v8 == 0) {
        // 0x401064
        *v5 = *v6;
        *v5 = (int32_t)" File %s not found.\n";
        v9 = (int32_t *)(v3 - 12);
        *v9 = (int32_t)&g26;
        function_401c39(&g112, (char *)&g112);
        *v5 = -1;
        function_401b64((int32_t)&g112);
    }
    // 0x401081
    *v5 = 2;
    *v9 = 0;
    int32_t * v10 = (int32_t *)(v3 - 12); // 0x401085
    *v10 = v8;
    function_401a78((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    int32_t * v11 = (int32_t *)(v3 - 16); // 0x40108b
    *v11 = v8;
    int32_t v12 = function_401920((int32_t)&g112); // 0x40108c
    int32_t * v13 = (int32_t *)(v3 - 20); // 0x401091
    *v13 = 0;
    int32_t * v14 = (int32_t *)(v3 - 24); // 0x401095
    *v14 = 0;
    int32_t * v15 = (int32_t *)(v3 - 28); // 0x401097
    *v15 = v8;
    int32_t * v16 = (int32_t *)(v3 + 20); // 0x401098
    *v16 = v12;
    function_401a78((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    *(int32_t *)(v3 - 32) = v12;
    int32_t v17 = (int32_t)_malloc((int32_t)&g112); // 0x4010a2
    *(int32_t *)(v3 - 36) = ((v12 >> 31 & 0xfffff) + v12) / 0x100000;
    *(int32_t *)(v3 - 40) = (int32_t)"ROM size: %dMB\n";
    function_401d24((char *)&g112);
    *(int32_t *)(v3 - 44) = v8;
    *(int32_t *)(v3 - 48) = v12;
    *(int32_t *)(v3 - 52) = 1;
    *(int32_t *)(v3 - 56) = v17;
    function_4017c4((int32_t)&g112, (int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    *(int32_t *)(v3 - 60) = v8;
    function_40176e((int32_t)&g112);
    *(int32_t *)(v3 - 64) = 12;
    int32_t v18 = v3 + 24; // 0x4010da
    *(int32_t *)(v3 - 68) = v17 + 160;
    *(int32_t *)(v3 - 72) = v18;
    function_401670((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    *(char *)(v3 + 36) = 0;
    *v5 = v18;
    *v9 = (int32_t)"ROM name: %s\n";
    function_401d24((char *)&g112);
    *v10 = 4;
    *v11 = v17 + 172;
    *v13 = v18;
    function_401670((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    *(char *)(v3 + 28) = 0;
    *v14 = v18;
    *v15 = (int32_t)"ROM code: %s\n";
    function_401d24((char *)&g112);
    int32_t * v19 = (int32_t *)(v3 + 16); // 0x40112b
    *v19 = -1;
    int32_t v20 = 0; // 0x401131
    int32_t v21 = v12; // 0x401131
    int32_t v22 = -1; // 0x401131
    int32_t v23; // 0x401000
    int32_t * v24; // 0x401000
    int32_t * v25; // 0x401000
    bool v26; // 0x401000
    uint32_t v27; // 0x401000
    int32_t v28; // 0x401000
    int32_t v29; // 0x401000
    int32_t v30; // 0x401000
    int32_t v31; // 0x401183
    if (v12 < 1) {
        goto lab_0x401259;
    } else {
        while (true) {
          lab_0x401137:;
            int32_t v32 = v22;
            int32_t v33 = v20 + v17;
            v28 = v32;
            if (*(char *)v33 != 69) {
                goto lab_0x401247;
            } else {
                // 0x401141
                v28 = v32;
                if (*(char *)(v33 + 1) != 69) {
                    goto lab_0x401247;
                } else {
                    // 0x40114c
                    v28 = v32;
                    if (*(char *)(v33 + 2) != 80) {
                        goto lab_0x401247;
                    } else {
                        // 0x401157
                        v28 = v32;
                        if (*(char *)(v33 + 3) != 82) {
                            goto lab_0x401247;
                        } else {
                            // 0x401162
                            v28 = v32;
                            if (*(char *)(v33 + 4) != 79) {
                                goto lab_0x401247;
                            } else {
                                // 0x40116d
                                v28 = v32;
                                if (*(char *)(v33 + 5) != 77) {
                                    goto lab_0x401247;
                                } else {
                                    // 0x401178
                                    v28 = v32;
                                    if (*(char *)(v33 + 6) != 95) {
                                        goto lab_0x401247;
                                    } else {
                                        // 0x401183
                                        v31 = v33 + 8;
                                        *v19 = 0;
                                        int32_t v34 = (int32_t)"111";
                                        v27 = v31;
                                        unsigned char v35 = *(char *)v27; // 0x401196
                                        unsigned char v36 = *(char *)v34; // 0x40119a
                                        while (v35 == v36) {
                                            if (v35 == 0) {
                                                goto lab_0x4011c3_2;
                                            }
                                            unsigned char v37 = *(char *)(v27 + 1); // 0x4011a2
                                            unsigned char v38 = *(char *)(v34 + 1); // 0x4011a7
                                            if (v37 != v38) {
                                                // 0x4011bf
                                                v26 = v37 < v38;
                                                goto lab_0x4011bf_2;
                                            }
                                            int32_t v39 = v27 + 2; // 0x4011b4
                                            int32_t v40 = v34 + 2; // 0x4011b4
                                            if (v37 == 0) {
                                                goto lab_0x4011c3_2;
                                            }
                                            v34 = v40;
                                            v27 = v39;
                                            v35 = *(char *)v27;
                                            v36 = *(char *)v34;
                                        }
                                        // 0x4011bf
                                        v26 = v35 < v36;
                                        goto lab_0x4011bf_2;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
      lab_0x401254:
        // 0x401254
        v25 = v9;
        v24 = v5;
        v23 = v4;
        v29 = v21;
        v30 = v3;
        if (v22 != -1) {
            goto lab_0x401273;
        } else {
            goto lab_0x401259;
        }
    }
  lab_0x401247:
    // 0x401247
    v22 = v28;
    v21 = *v16;
    v20++;
    if (v20 >= v21) {
        // break -> 0x401254
        goto lab_0x401254;
    }
    goto lab_0x401137;
  lab_0x4011bf_2:;
    bool v41 = v26;
    int32_t v42 = v41; // 0x4011ba
    uint32_t v43 = v27 + v42; // 0x4011ba
    bool v44 = v41 ? v27 < (int32_t)v41 - v42 | v43 != -1 : v27 < v43; // 0x4011ba
    int32_t v45 = 0; // 0x4011c1
    if (v41 == !v44) {
      lab_0x4011c3_2:
        // 0x4011c3
        *v19 = 1;
        v45 = 1;
    }
    int32_t v46 = v45;
    int32_t v47 = (int32_t)"120";
    uint32_t v48 = v31;
    unsigned char v49 = *(char *)v48; // 0x4011d2
    unsigned char v50 = *(char *)v47; // 0x4011d6
    bool v51; // 0x401000
    while (v49 == v50) {
        if (v49 == 0) {
            goto lab_0x4011ff_2;
        }
        unsigned char v52 = *(char *)(v48 + 1); // 0x4011de
        unsigned char v53 = *(char *)(v47 + 1); // 0x4011e3
        if (v52 != v53) {
            // 0x4011fb
            v51 = v52 < v53;
            goto lab_0x4011fb_2;
        }
        int32_t v54 = v48 + 2; // 0x4011f0
        int32_t v55 = v47 + 2; // 0x4011f0
        if (v52 == 0) {
            goto lab_0x4011ff_2;
        }
        v47 = v55;
        v48 = v54;
        v49 = *(char *)v48;
        v50 = *(char *)v47;
    }
    // 0x4011fb
    v51 = v49 < v50;
    goto lab_0x4011fb_2;
  lab_0x4011fb_2:;
    bool v56 = v51;
    int32_t v57 = v56; // 0x4011f6
    uint32_t v58 = v48 + v57; // 0x4011f6
    bool v59 = v56 ? v48 < (int32_t)v56 - v57 | v58 != -1 : v48 < v58; // 0x4011f6
    int32_t v60 = v46; // 0x4011fd
    if (v56 == !v59) {
      lab_0x4011ff_2:
        // 0x4011ff
        *v19 = 2;
        v60 = 2;
    }
    int32_t v61 = v60;
    int32_t v62 = (int32_t)"121";
    uint32_t v63 = v31;
    unsigned char v64 = *(char *)v63; // 0x40120e
    unsigned char v65; // 0x40121a
    unsigned char v66; // 0x40121f
    while (v64 == *(char *)v62) {
        if (v64 == 0) {
            goto lab_0x40123b_2;
        }
        // 0x40121a
        v65 = *(char *)(v63 + 1);
        v66 = *(char *)(v62 + 1);
        if (v65 != v66) {
            // 0x401237
            goto lab_0x401237_2;
        }
        int32_t v67 = v63 + 2; // 0x40122c
        int32_t v68 = v62 + 2; // 0x40122c
        if (v65 == 0) {
            goto lab_0x40123b_2;
        }
        v62 = v68;
        v63 = v67;
        v64 = *(char *)v63;
    }
    // 0x401237
    goto lab_0x401237_2;
  lab_0x401237_2:;
    bool v69 = v65 < v66;
    int32_t v70 = v69; // 0x401232
    uint32_t v71 = v63 + v70; // 0x401232
    bool v72 = v69 ? v63 < (int32_t)v69 - v70 | v71 != -1 : v63 < v71; // 0x401232
    v28 = v61;
    if (v69 == !v72) {
      lab_0x40123b_2:
        // 0x40123b
        *v19 = 3;
        v28 = 3;
    }
    goto lab_0x401247;
  lab_0x401259:
    // 0x401259
    *v5 = (int32_t)"Not an eeprom rom.\n";
    function_401d24((char *)&g112);
    *v9 = v17;
    function_40163a((int32_t)&g112);
    *v5 = 0;
    function_401b64((int32_t)&g112);
    int32_t v73 = v4 - 4; // 0x40127a
    v25 = (int32_t *)(v4 - 8);
    v24 = (int32_t *)v73;
    v23 = v73;
    v29 = v21;
    v30 = v4;
    goto lab_0x401273;
  lab_0x401273:;
    int32_t v74 = *(int32_t *)(4 * v22 + (int32_t)&g22); // 0x401273
    *v24 = v74;
    *v25 = (int32_t)"EEProm Library: %s\n";
    function_401d24((char *)&g112);
    int32_t * v75 = v24; // 0x40128a
    int32_t v76 = v30; // 0x40128a
    if (v22 == 0) {
        // 0x40128c
        *v24 = (int32_t)"Backup Libray revision not supported.\n";
        function_401d24((char *)&g112);
        *v25 = v17;
        function_40163a((int32_t)&g112);
        *v24 = v22;
        function_401b64((int32_t)&g112);
        v75 = (int32_t *)(v23 - 4);
        v76 = v23;
    }
    // 0x4012a5
    *v75 = (int32_t)"Scanning rom...\n";
    function_401d24((char *)&g112);
    int32_t v77 = v29 - 8; // 0x4012af
    int32_t * v78 = (int32_t *)(v76 + 20);
    if (v77 < 1) {
        // 0x4014ca
        *v75 = (int32_t)"Scan error. too much pattern\n";
        function_401d24((char *)&g112);
        goto lab_0x4014d7;
    } else {
        int32_t v79 = *v78; // 0x4012c1
        int32_t v80 = 8 * v22; // 0x4012c5
        int32_t v81 = 0;
        int32_t v82 = 0;
        int32_t v83 = v82 + v17;
        char v84 = *(char *)v83; // 0x4012cc
        int32_t v85 = v79; // 0x4012cf
        int32_t v86 = v81; // 0x4012cf
        char v87; // 0x4012d5
        char v88; // 0x4012e2
        char v89; // 0x4012ef
        char v90; // 0x4012fc
        char v91; // 0x401309
        char v92; // 0x401316
        char v93; // 0x40131f
        char v94; // 0x401323
        if (v84 == *(char *)(v80 + (int32_t)&g14)) {
            // 0x4012d1
            v87 = *(char *)(v80 + (int32_t)&g15);
            v85 = v79;
            v86 = v81;
            if (*(char *)(v83 + 1) == v87) {
                // 0x4012de
                v88 = *(char *)(v80 + (int32_t)&g16);
                v85 = v79;
                v86 = v81;
                if (*(char *)(v83 + 2) == v88) {
                    // 0x4012eb
                    v89 = *(char *)(v80 + (int32_t)&g17);
                    v85 = v79;
                    v86 = v81;
                    if (*(char *)(v83 + 3) == v89) {
                        // 0x4012f8
                        v90 = *(char *)(v80 + (int32_t)&g18);
                        v85 = v79;
                        v86 = v81;
                        if (*(char *)(v83 + 4) == v90) {
                            // 0x401305
                            v91 = *(char *)(v80 + (int32_t)&g19);
                            v85 = v79;
                            v86 = v81;
                            if (*(char *)(v83 + 5) == v91) {
                                // 0x401312
                                v92 = *(char *)(v80 + (int32_t)&g20);
                                v85 = v79;
                                v86 = v81;
                                if (*(char *)(v83 + 6) == v92) {
                                    // 0x40131f
                                    v93 = *(char *)(v83 + 7);
                                    v94 = *(char *)(v80 + (int32_t)&g21);
                                    v85 = v93 != v94 ? v79 : v82;
                                    v86 = v81 + (int32_t)(v93 == v94);
                                }
                            }
                        }
                    }
                }
            }
        }
        int32_t v95 = v86;
        int32_t v96 = v85;
        int32_t v97 = v82 + 1; // 0x40132f
        while (v97 != v77) {
            // 0x4012c5
            v81 = v95;
            int32_t v98 = v96;
            v82 = v97;
            v83 = v82 + v17;
            v84 = *(char *)v83;
            v85 = v98;
            v86 = v81;
            if (v84 == *(char *)(v80 + (int32_t)&g14)) {
                // 0x4012d1
                v87 = *(char *)(v80 + (int32_t)&g15);
                v85 = v98;
                v86 = v81;
                if (*(char *)(v83 + 1) == v87) {
                    // 0x4012de
                    v88 = *(char *)(v80 + (int32_t)&g16);
                    v85 = v98;
                    v86 = v81;
                    if (*(char *)(v83 + 2) == v88) {
                        // 0x4012eb
                        v89 = *(char *)(v80 + (int32_t)&g17);
                        v85 = v98;
                        v86 = v81;
                        if (*(char *)(v83 + 3) == v89) {
                            // 0x4012f8
                            v90 = *(char *)(v80 + (int32_t)&g18);
                            v85 = v98;
                            v86 = v81;
                            if (*(char *)(v83 + 4) == v90) {
                                // 0x401305
                                v91 = *(char *)(v80 + (int32_t)&g19);
                                v85 = v98;
                                v86 = v81;
                                if (*(char *)(v83 + 5) == v91) {
                                    // 0x401312
                                    v92 = *(char *)(v80 + (int32_t)&g20);
                                    v85 = v98;
                                    v86 = v81;
                                    if (*(char *)(v83 + 6) == v92) {
                                        // 0x40131f
                                        v93 = *(char *)(v83 + 7);
                                        v94 = *(char *)(v80 + (int32_t)&g21);
                                        v85 = v93 != v94 ? v98 : v82;
                                        v86 = v81 + (int32_t)(v93 == v94);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // 0x40132f
            v95 = v86;
            v96 = v85;
            v97 = v82 + 1;
        }
        if (v95 != 1) {
            // 0x4014ca
            *v75 = (int32_t)"Scan error. too much pattern\n";
            function_401d24((char *)&g112);
            goto lab_0x4014d7;
        } else {
            int32_t v99 = v79 - 2; // 0x401345
            int32_t v100 = v99; // 0x40134a
            int32_t v101 = v99; // 0x40134a
            if (v99 >= 1) {
                int32_t v102 = v100 - 1; // 0x40134f
                v101 = v102;
                while (*(char *)(v100 + v17) == *(char *)(v17 - 1 + v79)) {
                    // 0x401354
                    v100 = v102;
                    v101 = v102;
                    if (v102 >= 0 != v102 != 0) {
                        // break -> 0x401358
                        break;
                    }
                    v102 = v100 - 1;
                    v101 = v102;
                }
            }
            int32_t v103 = v101 + 258 & -256; // 0x40135e
            int32_t v104 = v79; // 0x401369
            int32_t v105 = v103; // 0x401369
            if (v79 - v103 <= 179) {
                // 0x40136b
                *v75 = (int32_t)"Not enought room in the end of the ROM.\n";
                function_401d24((char *)&g112);
                *(int32_t *)(v76 - 8) = (int32_t)"Forcing offset - warning may be buggy\n";
                function_401d24((char *)&g112);
                v104 = *v78;
                v105 = v104 - 176;
            }
            int32_t v106 = &g13; // 0x401391
            if (v22 != 1) {
                // 0x401393
                v106 = (v22 & -2) == 2 ? (int32_t)&g12 : v104;
            }
            char v107 = *(char *)v106; // 0x4013ac
            int32_t v108 = 0; // 0x4013b1
            if (v107 != -1) {
                int32_t v109 = 0; // 0x4013b3
                *(char *)(v105 + v17 + v109) = v107;
                v109++;
                char v110 = *(char *)(v109 + v106); // 0x4013b9
                v108 = v109;
                while (v110 != -1) {
                    // 0x4013b6
                    *(char *)(v105 + v17 + v109) = v110;
                    v109++;
                    v110 = *(char *)(v109 + v106);
                    v108 = v109;
                }
            }
            int32_t v111 = v76 + 16; // 0x4013c2
            int32_t * v112 = (int32_t *)v111; // 0x4013c2
            int32_t v113 = *v112; // 0x4013c2
            if (v113 == 1) {
                // 0x4013db
                *v112 = 31;
            } else {
                int32_t v114 = v113 - 2; // 0x4013cb
                if (v114 != 0 != v114 != 1) {
                    // 0x4013d1
                    *v112 = 19;
                }
            }
            int32_t v115 = v105 + v17 + v108; // 0x4013ea
            *(char *)v115 = *(char *)v111 + (char)v96;
            uint32_t v116 = *v112 + v96; // 0x4013f4
            *(char *)(v115 + 1) = (char)(v116 / 256);
            *(char *)(v115 + 2) = (char)(v116 / 0x10000);
            *(char *)(v115 + 3) = 8;
            if (v113 != 1) {
                if (v113 != 2 != v113 != 3) {
                    int32_t v117 = v96 + v17;
                    *(char *)v117 = 1;
                    *(char *)(v117 + 1) = 76;
                    *(char *)(v117 + 2) = 32;
                    *(char *)(v117 + 3) = 71;
                    *(char *)(v117 + 4) = 0;
                    *(char *)(v117 + 5) = 0;
                    *(char *)(v117 + 6) = (char)v105 + 1;
                    uint32_t v118 = v105 + 1; // 0x40148f
                    *(char *)(v117 + 7) = (char)(v118 / 256);
                    *(char *)(v117 + 8) = (char)(v118 / 0x10000);
                    *(char *)(v117 + 9) = 8;
                    char * v119 = (char *)(v117 + 442); // 0x4014a6
                    if (*v119 != -48) {
                        // 0x4014b8
                        *v75 = (int32_t)"octet diff de 0xd0 !! error !!\n";
                        function_401d24((char *)&g112);
                    }
                    // 0x4014c5
                    *v119 = -32;
                }
            } else {
                int32_t v120 = v96 + v17;
                *(char *)(v120 - 2) = 0;
                *(char *)v120 = 0;
                *(char *)(v120 + 1) = 71;
                *(char *)(v120 + 2) = (char)v105 + 1;
                uint32_t v121 = v105 + 1; // 0x401427
                *(char *)(v120 + 3) = (char)(v121 / 256);
                *(char *)(v120 + 4) = (char)(v121 / 0x10000);
                *(char *)(v120 + 5) = 8;
                char * v122 = (char *)(v120 + 724); // 0x40143e
                if (*v122 != -48) {
                    // 0x401449
                    *v75 = (int32_t)"value != 0xd0 !! error !!\n";
                    function_401d24((char *)&g112);
                }
                // 0x401456
                *v122 = -32;
            }
            goto lab_0x4014d7;
        }
    }
  lab_0x4014d7:
    // 0x4014d7
    *v75 = (int32_t)"Saving.\n";
    function_401d24((char *)&g112);
    *(int32_t *)(v76 - 8) = (int32_t)"wb";
    int32_t v123 = *(int32_t *)(*(int32_t *)(v76 + 288) + 8); // 0x4014ed
    *(int32_t *)(v76 - 12) = v123;
    int32_t v124 = function_401b24((int32_t)&g112, (int32_t)&g112); // 0x4014f1
    *(int32_t *)(v76 - 16) = v124;
    *(int32_t *)(v76 - 20) = *v78;
    *(int32_t *)(v76 - 24) = 1;
    *(int32_t *)(v76 - 28) = v17;
    function_401530((int32_t)&g112, (int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    *(int32_t *)(v76 - 32) = v124;
    function_40176e((int32_t)&g112);
    *(int32_t *)(v76 - 36) = (int32_t)"done\n";
    function_401d24((char *)&g112);
    *(int32_t *)(v76 - 40) = v17;
    function_40163a((int32_t)&g112);
    *v75 = 0;
    return function_401b64((int32_t)&g112);
}

// Address range: 0x401530 - 0x40163a
int32_t function_401530(int32_t a1, uint32_t a2, int32_t result, int32_t a4) {
    int32_t v1 = result * a2; // 0x40153a
    if (v1 == 0) {
        // 0x401621
        return 0;
    }
    int32_t v2 = a4 + 12; // 0x401557
    int32_t * v3 = (int32_t *)(a4 + 24);
    int32_t v4 = 0x1000; // 0x40155d
    if ((*(int16_t *)v2 & 268) != 0) {
        // 0x40155f
        v4 = *v3;
    }
    // 0x40156e
    int32_t v5; // bp-20, 0x401530
    int32_t v6 = &v5; // 0x401536
    int32_t * v7 = (int32_t *)v2;
    int32_t * v8 = (int32_t *)(a4 + 4);
    int32_t * v9 = (int32_t *)(v6 - 4);
    int32_t * v10 = (int32_t *)(v6 - 8);
    int32_t * v11 = (int32_t *)a4;
    int32_t * v12 = (int32_t *)(v6 - 12);
    int32_t v13 = a1; // 0x401530
    int32_t v14 = v4; // 0x401530
    int32_t v15 = v1;
    int32_t v16; // 0x401530
    int32_t v17; // 0x401530
    int32_t v18; // 0x401530
    uint32_t v19; // 0x401530
    int32_t v20; // 0x401530
    int32_t v21; // 0x40156e
    while (true) {
      lab_0x40156e:
        // 0x40156e
        v17 = v15;
        v19 = v14;
        v20 = v13;
        v21 = *v7;
        if ((v21 & 264) == 0) {
            goto lab_0x4015a2;
        } else {
            uint32_t v22 = *v8; // 0x401579
            if (v22 == 0) {
                goto lab_0x4015a2;
            } else {
                int32_t v23 = v17 < v22 ? v17 : v22;
                *v9 = v23;
                *v10 = v20;
                *v12 = *v11;
                function_402250(v20, (int32_t)&g112, (int32_t)&g112);
                *v8 = *v8 - v23;
                *v11 = *v11 + v23;
                v16 = v23;
                v18 = v17 - v23;
                goto lab_0x4015e8;
            }
        }
    }
  lab_0x401631_3:;
    // 0x401621
    int32_t v24; // 0x401530
    return (v1 - v24) / a2;
  lab_0x401626_2:
    // 0x401626
    *v7 = *v7 | 32;
    goto lab_0x401631_3;
  lab_0x4015a2:;
    int32_t v25; // 0x401530
    if (v17 < v19) {
        // 0x4015ed
        *v9 = a4;
        *v10 = (int32_t)*(char *)v20;
        if (function_401e7d(v20, (int32_t)&g112) == -1) {
            // break -> 0x401631
            goto lab_0x401631_3;
        }
        int32_t v26 = *v3; // 0x401604
        v13 = v20 + 1;
        v14 = v26 >= 0 == (v26 != 0) ? v26 : 1;
        v25 = v17 - 1;
        goto lab_0x401616;
    } else {
        if ((v21 & 264) != 0) {
            // 0x4015ab
            *v9 = a4;
            if (function_40217a(v20) != 0) {
                // break -> 0x401631
                goto lab_0x401631_3;
            }
        }
        int32_t v27 = v17; // 0x4015ba
        if (v19 != 0) {
            // 0x4015bc
            v27 = v17 - v17 % v19;
        }
        // 0x4015cb
        *v9 = v27;
        *v10 = v20;
        *v12 = *(int32_t *)(a4 + 16);
        int32_t v28 = function_401f92((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x4015d2
        v24 = v17;
        if (v28 == -1) {
            goto lab_0x401626_2;
        }
        int32_t v29 = v17 - v28; // 0x4015e2
        v16 = v28;
        v18 = v29;
        v24 = v29;
        if (v28 < v27) {
            goto lab_0x401626_2;
        }
        goto lab_0x4015e8;
    }
  lab_0x401616:
    // 0x401616
    v15 = v25;
    if (v15 == 0) {
        // 0x401621
        return result;
    }
    goto lab_0x40156e;
  lab_0x4015e8:
    // 0x4015e8
    v13 = v16 + v20;
    v14 = v19;
    v25 = v18;
    goto lab_0x401616;
}

// Address range: 0x40163a - 0x401669
int32_t function_40163a(int32_t lpMem) {
    // 0x40163a
    if (lpMem == 0) {
        // 0x401667
        int32_t result; // 0x40163a
        return result;
    }
    // 0x401643
    int32_t v1; // 0x40163a
    int32_t v2 = function_4025ff(lpMem, v1); // 0x401644
    if (v2 != 0) {
        // 0x40164f
        return function_40262a(v2, lpMem);
    }
    // 0x401667
    return HeapFree((int32_t *)g100, 0, (int32_t *)lpMem);
}

// Address range: 0x401670 - 0x40176e
int32_t function_401670(int32_t result, int32_t a2, int32_t a3) {
    if (a3 == 0) {
        // 0x4016c2
        return result;
    }
    int32_t v1 = a3; // 0x40168b
    int32_t v2 = a2; // 0x40168b
    int32_t v3 = result; // 0x40168b
    int32_t v4; // 0x401670
    int32_t v5; // 0x401670
    int32_t v6; // 0x401670
    int32_t v7; // 0x401670
    int32_t v8; // 0x401670
    int32_t v9; // 0x401670
    int32_t v10; // 0x401670
    if ((a2 & 3) != 0) {
        char v11 = *(char *)v2; // 0x401694
        *(char *)v3 = v11;
        v1--;
        while (v1 != 0) {
            // 0x40169d
            v3++;
            if (v11 == 0) {
                // 0x4016ca
                v5 = v1;
                v8 = v3;
                v6 = v1;
                v9 = v3;
                if ((v3 & 3) == 0) {
                    goto lab_0x4016e4;
                } else {
                    goto lab_0x4016d2;
                }
            }
            // 0x4016a1
            v2++;
            if ((v2 & 3) == 0) {
                // 0x4016a9
                v4 = v1;
                v10 = v2;
                v7 = v3;
                if (v1 >= 4) {
                    goto lab_0x401701;
                } else {
                    goto lab_0x4016b0;
                }
            }
            v11 = *(char *)v2;
            *(char *)v3 = v11;
            v1--;
        }
      lab_0x4016c2:
        // 0x4016c2
        return result;
    }
    // 0x40168d
    v1 = a3;
    v2 = a2;
    v3 = result;
    int32_t v12 = a3; // 0x401690
    v10 = a2;
    v7 = result;
    if (a3 >= 4) {
        goto lab_0x401701;
    } else {
        goto lab_0x4016b5;
    }
  lab_0x401701:;
    uint32_t v13 = *(int32_t *)v2;
    int32_t v14; // 0x401670
    if (((v13 ^ -0x7efeff00 ^ v13 + 0x7efefeff) & -0x7efeff00) != 0) {
        if ((char)v13 == 0) {
            // 0x40174b
            *(int32_t *)v14 = 0;
            goto lab_0x40174f;
        }
        if ((v13 & 0xff00) == 0) {
            // 0x401741
            *(int32_t *)v14 = v13 & 255;
            goto lab_0x40174f;
        }
        if ((v13 & 0xff0000) == 0) {
            // 0x401737
            *(int32_t *)v14 = v13 & 0xffff;
            goto lab_0x40174f;
        }
        if (v13 < 0x1000000) {
            // 0x401733
            *(int32_t *)v14 = v13;
            goto lab_0x40174f;
        }
    }
    int32_t v15 = v2 + 4; // 0x401711
    *(int32_t *)v3 = v13;
    int32_t v16 = v3 + 4; // 0x4016fb
    int32_t v17 = v1 / 4 - 1; // 0x4016fe
    v4 = v1;
    v10 = v15;
    v7 = v16;
    int32_t v18 = v17; // 0x4016ff
    int32_t v19 = v15; // 0x4016ff
    int32_t v20 = v16; // 0x4016ff
    while (v17 != 0) {
        // 0x401701
        v13 = *(int32_t *)v19;
        if (((v13 ^ -0x7efeff00 ^ v13 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v13 == 0) {
                // 0x40174b
                *(int32_t *)v14 = 0;
                goto lab_0x40174f;
            }
            if ((v13 & 0xff00) == 0) {
                // 0x401741
                *(int32_t *)v14 = v13 & 255;
                goto lab_0x40174f;
            }
            if ((v13 & 0xff0000) == 0) {
                // 0x401737
                *(int32_t *)v14 = v13 & 0xffff;
                goto lab_0x40174f;
            }
            if (v13 < 0x1000000) {
                // 0x401733
                *(int32_t *)v14 = v13;
                goto lab_0x40174f;
            }
        }
        // 0x4016f9
        v15 = v19 + 4;
        *(int32_t *)v20 = v13;
        v16 = v20 + 4;
        v17 = v18 - 1;
        v4 = v1;
        v10 = v15;
        v7 = v16;
        v18 = v17;
        v19 = v15;
        v20 = v16;
    }
    goto lab_0x4016b0;
  lab_0x4016b5:;
    int32_t v21 = v10;
    int32_t v22 = v12;
    char v23 = *(char *)v21; // 0x4016b5
    *(char *)v7 = v23;
    int32_t v24 = v7 + 1; // 0x4016ba
    int32_t v25 = v22; // 0x4016bd
    int32_t v26 = v24; // 0x4016bd
    while (v23 != 0) {
        int32_t v27 = v22 - 1; // 0x4016bf
        if (v27 == 0) {
            // 0x4016c2
            return result;
        }
        v21++;
        v22 = v27;
        v23 = *(char *)v21;
        *(char *)v24 = v23;
        v24++;
        v25 = v22;
        v26 = v24;
    }
    goto lab_0x4016ee;
  lab_0x4016b0:
    // 0x4016b0
    v12 = v4 & 3;
    if (v12 == 0) {
        // 0x4016c2
        return result;
    }
    goto lab_0x4016b5;
  lab_0x4016ee:;
    int32_t v28 = v25 - 1; // 0x4016ee
    int32_t v29 = v28; // 0x4016ef
    int32_t v30 = v26; // 0x4016ef
    if (v28 == 0) {
        // 0x4016c2
        return result;
    }
    goto lab_0x4016eb;
  lab_0x4016eb:
    // 0x4016eb
    *(char *)v30 = 0;
    v25 = v29;
    v26 = v30 + 1;
    goto lab_0x4016ee;
  lab_0x4016e4:
    // 0x4016e4
    v29 = v6;
    v30 = v9;
    if (v6 >= 4) {
        goto lab_0x401757;
    } else {
        goto lab_0x4016eb;
    }
  lab_0x4016d2:
    // 0x4016d2
    *(char *)v8 = 0;
    int32_t v31 = v5 - 1; // 0x4016d5
    if (v31 == 0) {
        goto lab_0x4016c2;
    } else {
        int32_t v32 = v8 + 1; // 0x4016d4
        v5 = v31;
        v8 = v32;
        v6 = v31;
        v9 = v32;
        if ((v32 & 3) != 0) {
            goto lab_0x4016d2;
        } else {
            goto lab_0x4016e4;
        }
    }
  lab_0x401757:;
    int32_t v33 = v6 / 4; // 0x401757
    int32_t v34 = v9; // 0x401757
    goto lab_0x401759;
  lab_0x401759:
    // 0x401759
    *(int32_t *)v34 = 0;
    int32_t v35 = v34 + 4; // 0x40175b
    int32_t v36 = v33 - 1; // 0x40175e
    v33 = v36;
    v34 = v35;
    int32_t v37 = v35; // 0x40175f
    if (v36 != 0) {
        goto lab_0x401759;
    } else {
        goto lab_0x401761;
    }
  lab_0x401761:;
    int32_t v38 = v6 & 3; // 0x401761
    v29 = v38;
    v30 = v37;
    if (v38 != 0) {
        goto lab_0x4016eb;
    } else {
        goto lab_0x4016c2;
    }
  lab_0x40174f:
    // 0x40174f
    v37 = v14 + 4;
    int32_t v39; // 0x401670
    if (v39 == 1) {
        goto lab_0x401761;
    } else {
        goto lab_0x401757;
    }
}

// Address range: 0x40176e - 0x4017c4
int32_t function_40176e(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x401777
    int32_t v2 = *v1; // 0x401777
    if ((v2 & 64) != 0 || (v2 & 131) == 0) {
        // 0x4017bd
        *v1 = 0;
        return -1;
    }
    int32_t result = function_40217a(a1); // 0x401788
    function_402ebd(a1);
    if (function_402e0a(*(int32_t *)(a1 + 16)) < 0) {
        // 0x4017bd
        *v1 = 0;
        return -1;
    }
    int32_t * v3 = (int32_t *)(a1 + 28); // 0x4017a9
    int32_t v4 = *v3; // 0x4017a9
    if (v4 != 0) {
        // 0x4017b0
        function_40163a(v4);
        *v3 = 0;
    }
    // 0x4017bd
    *v1 = 0;
    return result;
}

// Address range: 0x4017c4 - 0x4018ac
int32_t function_4017c4(int32_t a1, uint32_t a2, int32_t result, int32_t a4) {
    int32_t v1 = result * a2; // 0x4017ce
    if (v1 == 0) {
        // 0x401891
        return 0;
    }
    int32_t v2 = a4 + 12; // 0x4017eb
    int16_t * v3 = (int16_t *)v2; // 0x4017eb
    int16_t v4 = *v3; // 0x4017eb
    int32_t * v5 = (int32_t *)(a4 + 24);
    int32_t v6 = 0x1000; // 0x4017f1
    if ((v4 & 268) != 0) {
        // 0x4017f3
        v6 = *v5;
    }
    // 0x401807
    int32_t v7; // bp-20, 0x4017c4
    int32_t v8 = &v7; // 0x4017ca
    int32_t * v9 = (int32_t *)(a4 + 4);
    int32_t * v10 = (int32_t *)(v8 - 4);
    int32_t * v11 = (int32_t *)a4;
    int32_t * v12 = (int32_t *)(v8 - 8);
    int32_t * v13 = (int32_t *)(v8 - 12);
    int16_t v14 = v4; // 0x4017c4
    int32_t v15 = v1;
    int32_t v16 = v6; // 0x4017c4
    int32_t v17 = a1; // 0x4017c4
    int32_t v18; // 0x4017c4
    int32_t v19; // 0x4017c4
    uint32_t v20; // 0x4017c4
    int32_t v21; // 0x4017c4
    while (true) {
      lab_0x401807:
        // 0x401807
        v18 = v17;
        v19 = v16;
        v20 = v15;
        if ((v14 & 268) == 0) {
            goto lab_0x401839;
        } else {
            uint32_t v22 = *v9; // 0x40180f
            if (v22 == 0) {
                goto lab_0x401839;
            } else {
                int32_t v23 = v20 < v22 ? v20 : v22;
                *v10 = v23;
                *v12 = *v11;
                *v13 = v18;
                function_402250(v20, (int32_t)&g112, (int32_t)&g112);
                *v9 = *v9 - v23;
                *v11 = *v11 + v23;
                v21 = v20 - v23;
                v16 = v19;
                v17 = v23 + v18;
                goto lab_0x401884;
            }
        }
    }
    // 0x401891
    return (v1 - v20) / a2;
  lab_0x401839:
    if (v20 < v19) {
        // 0x40186c
        *v10 = a4;
        int32_t v24 = function_402ee8(v20); // 0x40186d
        if (v24 == -1) {
            return (v1 - v20) / a2;
        }
        // 0x401878
        *(char *)v18 = (char)v24;
        v21 = v20 - 1;
        v16 = *v5;
        v17 = v18 + 1;
    } else {
        int32_t v25 = v20; // 0x401844
        if (v19 != 0) {
            // 0x401846
            v25 = v20 - v20 % v19;
        }
        // 0x40184f
        *v10 = v25;
        *v12 = v18;
        *v13 = *(int32_t *)(a4 + 16);
        int32_t v26 = function_402fc1(v20, (int32_t)&g112, (int32_t)&g112); // 0x401854
        switch (v26) {
            case 0: {
                int32_t * v27 = (int32_t *)v2; // 0x401896
                *v27 = *v27 | 16;
                // 0x401891
                return (v1 - v20) / a2;
            }
            case -1: {
                int32_t * v28 = (int32_t *)v2; // 0x40189c
                *v28 = *v28 | 32;
                // 0x401891
                return (v1 - v20) / a2;
            }
        }
        // 0x401865
        v21 = v20 - v26;
        v16 = v19;
        v17 = v26 + v18;
    }
    goto lab_0x401884;
  lab_0x401884:
    // 0x401884
    v15 = v21;
    if (v15 == 0) {
        // 0x401891
        return result;
    }
    // 0x401884
    v14 = *v3;
    goto lab_0x401807;
}

// Address range: 0x4018ea - 0x401920
int32_t __heap_alloc(uint32_t a1) {
    // 0x4018ea
    if ((uint32_t)g30 >= a1) {
        int32_t result = function_402955(a1); // 0x4018f8
        if (result != 0) {
            // 0x40191e
            return result;
        }
    }
    int32_t dwBytes = a1 != 0 ? a1 + 15 & -16 : 16; // 0x40190c
    // 0x40191e
    return (int32_t)HeapAlloc((int32_t *)g100, 0, dwBytes);
}

// Address range: 0x401920 - 0x401a78
int32_t function_401920(int32_t a1) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x40192e
    int32_t * v2 = (int32_t *)(a1 + 4); // 0x401931
    if (*v2 <= 0xffffffff) {
        // 0x401939
        *v2 = 0;
    }
    int32_t v3 = function_40337d(v1, 0, 1); // 0x401940
    if (v3 < 0) {
        // 0x401a73
        return -1;
    }
    int32_t v4 = a1 + 12; // 0x40194f
    int32_t * v5 = (int32_t *)v4; // 0x40194f
    int32_t v6 = *v5; // 0x40194f
    if ((v6 & 264) == 0) {
        // 0x401a73
        return v3 - *v2;
    }
    uint32_t v7 = *(int32_t *)a1; // 0x401961
    int32_t * v8 = (int32_t *)(a1 + 8); // 0x401963
    uint32_t v9 = *v8; // 0x401963
    int32_t v10 = v7 - v9; // 0x401968
    int32_t result; // 0x401920
    if ((v6 & 3) == 0) {
        // 0x40199b
        result = v10;
        if ((char)v6 > -1) {
            // 0x4019a0
            g50 = 22;
            // 0x401a73
            return -1;
        }
    } else {
        int32_t v11 = *(int32_t *)(4 * v1 / 32 + (int32_t)&g91); // 0x40197c
        result = v10;
        if (!((v7 <= v9 | *(char *)(v11 + (8 * v1 & 248 | 4)) > -1))) {
            int32_t v12 = v10 + (int32_t)(*(char *)v9 == 10);
            int32_t v13 = v9 + 1; // 0x401998
            int32_t v14 = v13; // 0x40198e
            int32_t v15 = v12; // 0x40198e
            result = v12;
            while (v13 < v7) {
                // 0x401990
                v12 = v15 + (int32_t)(*(char *)v14 == 10);
                v13 = v14 + 1;
                v14 = v13;
                v15 = v12;
                result = v12;
            }
        }
    }
    // 0x4019b2
    if (v3 == 0) {
        // 0x401a73
        return result;
    }
    // 0x4019c0
    if ((*(char *)v4 & 1) == 0) {
        // 0x401a73
        return result + v3;
    }
    int32_t v16 = *v2; // 0x4019ca
    if (v16 == 0) {
        // 0x401a73
        return (v16 & result) + v3;
    }
    int32_t v17 = v16 + v10; // 0x4019db
    int32_t * v18 = (int32_t *)(4 * v1 / 32 + (int32_t)&g91); // 0x4019f2
    int32_t v19 = 8 * v1 & 248 | 4; // 0x4019f4
    int32_t v20 = v17; // 0x4019f9
    int32_t v21; // 0x401920
    int32_t v22; // 0x401920
    char v23; // 0x401920
    if (*(char *)(*v18 + v19) > -1) {
        return result + v3 - v20;
    } else {
        // 0x4019fb
        if (function_40337d(v1, 0, 2) != v3) {
            // 0x401a2c
            function_40337d(v1, v3, 0);
            if (v17 < 513) {
                // 0x401a46
                v21 = 512;
                if ((*v5 & 1032) == 8) {
                    goto lab_0x401a56;
                } else {
                    // 0x401a53
                    v21 = *(int32_t *)(a1 + 24);
                    goto lab_0x401a56;
                }
            } else {
                // 0x401a53
                v21 = *(int32_t *)(a1 + 24);
                goto lab_0x401a56;
            }
        } else {
            uint32_t v24 = *v8; // 0x401a0f
            uint32_t v25 = v24 + v17; // 0x401a15
            int32_t v26 = v17; // 0x401a19
            if (v24 < v25) {
                int32_t v27 = v17 + (int32_t)(*(char *)v24 == 10);
                int32_t v28 = v24 + 1; // 0x401a23
                int32_t v29 = v28; // 0x401a19
                int32_t v30 = v27; // 0x401a19
                v26 = v27;
                while (v28 < v25) {
                    // 0x401a1b
                    v27 = v30 + (int32_t)(*(char *)v29 == 10);
                    v28 = v29 + 1;
                    v29 = v28;
                    v30 = v27;
                    v26 = v27;
                }
            }
            // 0x401a26
            v22 = v26;
            v23 = *(char *)(a1 + 13) & 32;
            goto lab_0x401a60;
        }
    }
    // 0x401a73
    return result + v3 - v20;
  lab_0x401a60:
    // 0x401a60
    v20 = v22 + (int32_t)(v23 != 0);
    return result + v3 - v20;
  lab_0x401a56:
    // 0x401a56
    v22 = v21;
    v23 = *(char *)(*v18 + v19) & 4;
    goto lab_0x401a60;
}

// Address range: 0x401a78 - 0x401b04
int32_t function_401a78(int32_t a1, int32_t a2, uint32_t a3) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x401a7e
    int32_t v2 = *v1; // 0x401a7e
    if ((v2 & 131) == 0) {
        // 0x401af4
        g50 = 22;
        // 0x401b01
        return -1;
    }
    if (a3 > 1 == (a3 != 2)) {
        // 0x401af4
        g50 = 22;
        // 0x401b01
        return -1;
    }
    // 0x401a97
    *v1 = v2 & -17;
    int32_t v3 = a2; // 0x401a9f
    int32_t v4 = a3; // 0x401a9f
    if (a3 == 1) {
        // 0x401aa1
        v3 = function_401920(a1) + a2;
        v4 = 0;
    }
    // 0x401aae
    function_40217a(a1);
    int32_t v5 = *v1; // 0x401ab4
    int32_t v6; // 0x401adf
    if ((char)v5 <= 255) {
        // 0x401abc
        *v1 = v5 & -4;
        // 0x401ad7
        v6 = function_40337d(*(int32_t *)(a1 + 16), v3, v4);
        // 0x401b01
        return v6 == -1;
    }
    if ((v5 & 9) == 9) {
        if ((v5 & 1024) == 0) {
            // 0x401ad0
            *(int32_t *)(a1 + 24) = 512;
        }
    }
    // 0x401ad7
    v6 = function_40337d(*(int32_t *)(a1 + 16), v3, v4);
    // 0x401b01
    return v6 == -1;
}

// Address range: 0x401b04 - 0x401b24
int32_t function_401b04(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = function_403587(); // 0x401b04
    if (result != 0) {
        // 0x401b0e
        return function_403417(a1, a2, a3, result);
    }
    // 0x401b0d
    return result;
}

// Address range: 0x401b24 - 0x401b37
int32_t function_401b24(int32_t a1, int32_t a2) {
    // 0x401b24
    return function_401b04(a1, a2, 64);
}

// Address range: 0x401b37 - 0x401b64
int32_t function_401b37(void) {
    // 0x401b37
    function_401c1f(&g6, &g7);
    return function_401c1f(&g4, &g5);
}

// Address range: 0x401b64 - 0x401b75
int32_t function_401b64(int32_t a1) {
    // 0x401b64
    return function_401b86(a1, 0, 0);
}

// Address range: 0x401b75 - 0x401b86
int32_t function_401b75(int32_t a1) {
    // 0x401b75
    return function_401b86(a1, 1, 0);
}

// Address range: 0x401b86 - 0x401c1f
int32_t function_401b86(int32_t a1, int32_t a2, int32_t a3) {
    // 0x401b86
    int32_t v1; // bp-4, 0x401b86
    int32_t * v2 = &v1; // 0x401b90
    if (g64 == 1) {
        int32_t * processHandle = GetCurrentProcess(); // 0x401b96
        int32_t v3 = (int32_t)processHandle; // bp-12, 0x401b9c
        TerminateProcess(processHandle, (int32_t)&g112);
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t v5 = *(int32_t *)(v4 + 16); // 0x401ba9
    g63 = 1;
    g62 = v5;
    int32_t * v6; // 0x401b86
    int32_t * v7; // 0x401b86
    if (*(int32_t *)(v4 + 12) != 0) {
        // 0x401ba3
        v7 = (int32_t *)(v4 - 12);
        v6 = (int32_t *)(v4 - 8);
    } else {
        // 0x401bbb
        int32_t * v8; // 0x401b86
        if (g108 == 0) {
            // 0x401bbb
            v8 = (int32_t *)(v4 - 8);
        } else {
            int32_t * v9 = (int32_t *)(v4 - 8);
            int32_t v10 = g107 - 4; // 0x401bcb
            v8 = v9;
            if (v10 >= g108) {
                int32_t v11 = v10; // 0x401bda
                v11 -= 4;
                v8 = v9;
                while (v11 >= g108) {
                    // 0x401bd2
                    v11 -= 4;
                    v8 = v9;
                }
            }
        }
        // 0x401be6
        *v8 = (int32_t)&g9;
        int32_t * v12 = (int32_t *)(v4 - 12);
        *v12 = (int32_t)&g8;
        function_401c1f(&g112, &g112);
        v7 = v12;
        v6 = v8;
    }
    // 0x401bf7
    *v6 = (int32_t)&g11;
    *v7 = (int32_t)&g10;
    int32_t result = function_401c1f(&g112, &g112); // 0x401c01
    if (v5 != 0) {
        // 0x401c1d
        return result;
    }
    // 0x401c0d
    *(int32_t *)(v4 - 4) = *(int32_t *)(v4 + 8);
    g64 = 1;
    ExitProcess((int32_t)&g112);
    // UNREACHABLE
}

// Address range: 0x401c1f - 0x401c39
int32_t function_401c1f(int32_t * a1, int32_t * a2) {
    if (a1 >= a2) {
        // 0x401c37
        int32_t result; // 0x401c1f
        return result;
    }
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1 + 4; // 0x401c32
    while (v2 < (uint32_t)(int32_t)a2) {
        // 0x401c2a
        v1 = v2;
        v2 = v1 + 4;
    }
    // 0x401c37
    return *(int32_t *)v1;
}

// Address range: 0x401c39 - 0x401c6b
int32_t function_401c39(int32_t * a1, char * a2) {
    int32_t v1 = (int32_t)a1;
    int32_t v2; // 0x401c39
    int32_t v3; // 0x401c39
    int32_t v4; // 0x401c39
    int32_t v5 = function_4035ff(v1, v2, v3, v4); // 0x401c41
    int32_t v6; // bp+12, 0x401c39
    int32_t result = function_4036c9(v1, (int32_t)a2, &v6); // 0x401c52
    function_40368c(v5, v1);
    return result;
}

// Address range: 0x401c6b - 0x401d10
int32_t function_401c6b(void) {
    int32_t v1 = g104; // 0x401c6b
    int32_t v2 = 512; // 0x401c76
    int32_t v3; // 0x401c6b
    if (v1 != 0) {
        // 0x401c7f
        v2 = 20;
        v3 = v1;
        if (v1 < 20) {
            goto lab_0x401c85;
        } else {
            goto lab_0x401c8a;
        }
    } else {
        goto lab_0x401c85;
    }
  lab_0x401c85:
    // 0x401c85
    g104 = v2;
    v3 = v2;
    goto lab_0x401c8a;
  lab_0x401c8a:;
    int32_t v4 = function_403ed3(v3, 4); // 0x401c8d
    g102 = v4;
    if (v4 == 0) {
        // 0x401c9d
        g104 = 20;
        int32_t v5 = function_403ed3(20, 4); // 0x401ca6
        g102 = v5;
        if (v5 == 0) {
            // 0x401cb6
            __amsg_exit();
        }
    }
    int32_t v6 = (int32_t)&g23; // 0x401cc0
    int32_t v7 = 0; // 0x401cc0
    *(int32_t *)(g102 + v7) = v6;
    int32_t v8 = v6 + 32; // 0x401cce
    v6 = v8;
    v7 += 4;
    int32_t v9 = 0; // 0x401cd9
    while (v8 < (int32_t)&g28) {
        // 0x401cc5
        *(int32_t *)(g102 + v7) = v6;
        v8 = v6 + 32;
        v6 = v8;
        v7 += 4;
        v9 = 0;
    }
    int32_t v10 = &g24;
    int32_t v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g91); // 0x401cec
    int32_t result = *(int32_t *)((8 * v9 & 248) + v11); // 0x401cf3
    if (result != -1 != result != 0) {
        // 0x401cff
        *(int32_t *)v10 = -1;
    }
    int32_t v12 = v10 + 32; // 0x401d02
    v9++;
    while (v12 < (int32_t)&g27) {
        // 0x401ce2
        v10 = v12;
        v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g91);
        result = *(int32_t *)((8 * v9 & 248) + v11);
        if (result != -1 != result != 0) {
            // 0x401cff
            *(int32_t *)v10 = -1;
        }
        // 0x401d02
        v12 = v10 + 32;
        v9++;
    }
    // 0x401d0e
    return result;
}

// Address range: 0x401d10 - 0x401d24
int32_t function_401d10(void) {
    int32_t result = function_4021d6(); // 0x401d10
    if (g62 == 0) {
        // 0x401d23
        return result;
    }
    // 0x401d1e
    return function_403f50();
}

// Address range: 0x401d24 - 0x401d55
int32_t function_401d24(char * a1) {
    // 0x401d24
    int32_t v1; // 0x401d24
    int32_t v2; // 0x401d24
    int32_t v3; // 0x401d24
    int32_t v4 = function_4035ff((int32_t)&g25, v1, v2, v3); // 0x401d2d
    int32_t v5; // 0x401d24
    int32_t result = function_4036c9((int32_t)&g25, (int32_t)a1, &v5); // 0x401d3e
    function_40368c(v4, (int32_t)&g25);
    return result;
}

// Address range: 0x401d55 - 0x401e29
int32_t entry_point(int32_t a1) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x401d6a
    __writefsdword(0, (int32_t)&v1);
    uint32_t v2 = GetVersion(); // 0x401d7b
    int32_t v3 = v2 / 256 & 255; // 0x401d83
    g56 = v3;
    int32_t v4 = v2 & 255; // 0x401d8d
    g55 = v4;
    g54 = 256 * v4 | v3;
    g53 = v2 / 0x10000;
    if (function_402585(0) == 0) {
        // 0x401db8
        function_401e59(28);
        // UNREACHABLE
    }
    // 0x401dc0
    function_4031d2(0);
    g101 = GetCommandLineA();
    g66 = (char *)function_404432();
    function_4041e5();
    function_40412c();
    function_401b37();
    g60 = g59;
    function_401b64(function_401000(g57, g58, g59));
    int32_t v5; // 0x401d55
    return function_403fa8(*(int32_t *)*(int32_t *)v5, v5);
}

// Address range: 0x401e59 - 0x401e7c
int32_t function_401e59(int32_t a1) {
    // 0x401e59
    if (g67 != 2) {
        // 0x401e62
        __FF_MSGBANNER();
    }
    // 0x401e67
    __NMSG_WRITE(a1);
    ExitProcess(255);
    // UNREACHABLE
}

// Address range: 0x401e7c - 0x401e7d
int32_t function_401e7c(void) {
    // 0x401e7c
    int32_t result; // 0x401e7c
    return result;
}

// Address range: 0x401e7d - 0x401f92
int32_t function_401e7d(int32_t a1, int32_t a2) {
    int32_t v1 = 0x1000000 * a1 / 0x1000000;
    int32_t v2 = a2 + 12; // 0x401e85
    int32_t * v3 = (int32_t *)v2; // 0x401e85
    int32_t v4 = *v3; // 0x401e85
    if ((v4 & 130) == 0) {
        // 0x401f86
        *v3 = v4 | 32;
        // 0x401f8e
        return -1;
    }
    if ((v4 & 64) != 0) {
        // 0x401f86
        *v3 = v4 | 32;
        // 0x401f8e
        return -1;
    }
    int32_t v5 = *(int32_t *)(a2 + 16); // 0x401e88
    int32_t * v6 = (int32_t *)(a2 + 4);
    int32_t v7 = v4; // 0x401e9d
    if ((v4 & 1) != 0) {
        // 0x401e9f
        *v6 = 0;
        if ((v4 & 16) == 0) {
            // 0x401f86
            *v3 = v4 | 32;
            // 0x401f8e
            return -1;
        }
        // 0x401eab
        v7 = v4 & -2;
        *(int32_t *)a2 = *(int32_t *)(a2 + 8);
        *v3 = v7;
    }
    // 0x401eb5
    *v6 = 0;
    *v3 = v7 & -19 | 2;
    if ((v7 & 268) != 0) {
        goto lab_0x401eef;
    } else {
        if (a2 != (int32_t)&g25 == (a2 != (int32_t)&g26)) {
            // 0x401ee8
            function_4048c0(a2);
            goto lab_0x401eef;
        } else {
            // 0x401edd
            int32_t v8; // 0x401e7d
            if (function_404904(v5, v8) != 0) {
                goto lab_0x401eef;
            } else {
                // 0x401ee8
                function_4048c0(a2);
                goto lab_0x401eef;
            }
        }
    }
  lab_0x401eef:;
    // 0x401eef
    int32_t v9; // 0x401e7d
    int32_t v10; // 0x401e7d
    if ((*(int16_t *)v2 & 264) == 0) {
        // 0x401f5c
        v10 = function_401f92(v5, (int32_t)&v1, 1);
        v9 = 1;
    } else {
        int32_t * v11 = (int32_t *)(a2 + 8); // 0x401ef8
        int32_t v12 = *v11; // 0x401ef8
        int32_t * v13 = (int32_t *)a2; // 0x401efb
        int32_t v14 = *v13 - v12; // 0x401efd
        *v13 = v12 + 1;
        *v6 = *(int32_t *)(a2 + 24) - 1;
        int32_t v15; // 0x401e7d
        if (v14 < 1) {
            int32_t v16 = &g31; // 0x401f22
            if (v5 != -1) {
                int32_t v17 = *(int32_t *)(4 * v5 / 32 + (int32_t)&g91); // 0x401f2e
                v16 = v17 + (8 * v5 & 248);
            }
            // 0x401f3f
            v15 = 0;
            if ((*(char *)(v16 + 4) & 32) != 0) {
                // 0x401f45
                function_40337d(v5, 0, 2);
                v15 = 0;
            }
        } else {
            // 0x401f0f
            v15 = function_401f92(v5, v12, v14);
        }
        // 0x401f52
        *(char *)*v11 = (char)v1;
        v10 = v15;
        v9 = v14;
    }
    // 0x401f70
    int32_t result; // 0x401e7d
    if (v10 == v9) {
        // 0x401f7c
        result = v1 & 255;
    } else {
        // 0x401f76
        *v3 = *v3 | 32;
        result = -1;
    }
    // 0x401f8e
    return result;
}

// Address range: 0x401f92 - 0x40213f
int32_t function_401f92(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite) {
    // 0x401f92
    if ((int32_t)g93 <= a1) {
        // 0x402126
        g51 = 0;
        g50 = 9;
        // 0x40213a
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x401fbe
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x401fc1
    int32_t v3 = *v2; // 0x401fc1
    int32_t v4 = v1 | 4;
    char v5 = *(char *)(v3 + v4); // 0x401fc3
    if ((v5 & 1) == 0) {
        // 0x402126
        g51 = 0;
        g50 = 9;
        // 0x40213a
        return -1;
    }
    // 0x401fcf
    if (nNumberOfBytesToWrite == 0) {
        // 0x40213a
        return 0;
    }
    int32_t v6 = v3; // 0x401fe5
    if ((v5 & 32) != 0) {
        // 0x401fe7
        function_40337d(a1, 0, 2);
        v6 = *v2;
    }
    int32_t v7 = v6 + v1; // 0x401ff5
    int32_t v8; // 0x401f92
    int32_t v9; // 0x401f92
    int32_t errorCode; // 0x401f92
    int32_t errorCode2; // 0x401f92
    int32_t v10; // 0x401f92
    int32_t lpNumberOfBytesWritten; // bp-16, 0x401f92
    int32_t v11; // 0x401f92
    if (*(char *)(v7 + 4) > -1) {
        int32_t hFile = *(int32_t *)v7; // 0x4020cd
        int32_t v12 = hFile; // bp-1080, 0x4020cd
        int32_t v13 = &v12; // 0x4020cd
        if (!WriteFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToWrite, &lpNumberOfBytesWritten, NULL)) {
            // 0x40208b
            v8 = v13;
            errorCode = GetLastError();
            goto lab_0x402096;
        } else {
            // 0x4020d9
            v10 = lpNumberOfBytesWritten;
            v11 = 0;
            errorCode2 = 0;
            v9 = v13;
            goto lab_0x40208b;
        }
    } else {
        // 0x402013
        int32_t v14; // bp-1048, 0x401f92
        int32_t v15 = &v14; // 0x402013
        int32_t v16 = 0; // 0x402077
        int32_t v17 = 0; // 0x401f92
        int32_t v18 = lpBuffer;
        int32_t v19; // bp-1060, 0x401f92
        int32_t v20 = &v19; // 0x401f92
        int32_t v21; // 0x401f92
        int32_t v22; // 0x401f92
        int32_t v23; // 0x402067
        while (true) {
            // 0x402013
            v21 = v16;
            int32_t v24 = v15;
            int32_t v25 = v18;
            int32_t v26 = v17;
            int32_t v27; // 0x401f92
            int32_t v28; // 0x401f92
            int32_t v29; // 0x401f92
            while (v25 - lpBuffer < nNumberOfBytesToWrite) {
                char v30 = *(char *)v25; // 0x40202a
                int32_t v31 = v26; // 0x40202f
                int32_t v32 = v24; // 0x40202f
                if (v30 == 10) {
                    // 0x402031
                    *(char *)v24 = 13;
                    v31 = v26 + 1;
                    v32 = v24 + 1;
                }
                int32_t v33 = v25 + 1; // 0x402027
                int32_t v34 = v31;
                *(char *)v32 = v30;
                int32_t v35 = v32 + 1; // 0x40203a
                int32_t v36 = v35 - v15;
                v27 = v36;
                v28 = v34;
                v29 = v33;
                if (v36 >= 1024) {
                    goto lab_0x40204d;
                }
                v24 = v35;
                v25 = v33;
                v26 = v34;
            }
            // 0x402019
            v27 = v24 - v15;
            v28 = v26;
            v29 = v25;
          lab_0x40204d:
            // 0x40204d
            v18 = v29;
            v22 = v28;
            *(int32_t *)(v20 - 4) = 0;
            *(int32_t *)(v20 - 8) = (int32_t)&lpNumberOfBytesWritten;
            *(int32_t *)(v20 - 12) = v27;
            *(int32_t *)(v20 - 16) = v15;
            v23 = v20 - 20;
            *(int32_t *)v23 = *(int32_t *)(*v2 + v1);
            if (!WriteFile(&g112, &g112, (int32_t)&g112, &g112, (struct _OVERLAPPED *)&g112)) {
                // break -> 0x4020b7
                break;
            }
            // 0x402074
            v16 = lpNumberOfBytesWritten + v21;
            v17 = v22;
            v20 = v23;
            v10 = v16;
            v11 = v22;
            errorCode2 = 0;
            v9 = v23;
            if (v18 - lpBuffer < nNumberOfBytesToWrite != lpNumberOfBytesWritten >= v27) {
                goto lab_0x40208b;
            }
        }
        // 0x4020b7
        v10 = v21;
        v11 = v22;
        errorCode2 = GetLastError();
        v9 = v23;
        goto lab_0x40208b;
    }
  lab_0x40208b:
    // 0x40208b
    v8 = v9;
    errorCode = errorCode2;
    if (v10 != 0) {
        // 0x40213a
        return v10 - v11;
    }
    goto lab_0x402096;
  lab_0x402096:
    // 0x402096
    if (errorCode == 0) {
        // 0x4020fa
        if ((*(char *)(*v2 + v4) & 64) != 0) {
            // 0x402103
            if (*(char *)lpBuffer == 26) {
                // 0x40213a
                return 0;
            }
        }
        // 0x40210f
        g50 = 28;
        g51 = 0;
        // 0x40213a
        return -1;
    }
    int32_t * v37 = (int32_t *)(v8 - 4); // 0x40209b
    *v37 = 5;
    if (errorCode != 5) {
        // 0x4020ef
        *v37 = errorCode;
        function_40492a((int32_t)&g112);
    } else {
        // 0x4020a3
        g50 = 9;
        g51 = 5;
    }
    // 0x40213a
    return -1;
}

// Address range: 0x40213f - 0x40217a
int32_t _fflush(int32_t a1) {
    if (a1 == 0) {
        // 0x402148
        return _flsall(a1);
    }
    // 0x402151
    if (function_40217a(a1) != 0) {
        // 0x40215c
        return -1;
    }
    // 0x402161
    if ((*(char *)(a1 + 13) & 64) == 0) {
        // 0x40215c
        return 0;
    }
    // 0x402167
    return function_404991(*(int32_t *)(a1 + 16)) != 0;
}

// Address range: 0x40217a - 0x4021d6
int32_t function_40217a(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x402183
    int32_t v2 = *v1; // 0x402183
    int32_t * v3 = (int32_t *)(a1 + 8);
    int32_t * v4; // 0x40217a
    int32_t result; // 0x40217a
    if ((v2 & 264) == 0 || (v2 & 3) != 2) {
        // 0x40217a
        v4 = (int32_t *)a1;
        result = 0;
    } else {
        int32_t v5 = *v3; // 0x402196
        int32_t * v6 = (int32_t *)a1;
        uint32_t v7 = *v6 - v5; // 0x40219b
        v4 = v6;
        result = 0;
        if (v7 >= 1) {
            int32_t v8 = function_401f92(*(int32_t *)(a1 + 16), v5, v7); // 0x4021a6
            int32_t v9 = *v1;
            if (v8 != v7) {
                // 0x4021c0
                *v1 = v9 | 32;
                v4 = v6;
                result = -1;
            } else {
                // 0x4021b2
                v4 = v6;
                result = 0;
                if ((char)v9 <= 255) {
                    // 0x4021b9
                    *v1 = v9 & -3;
                    v4 = v6;
                    result = 0;
                }
            }
        }
    }
    // 0x4021c7
    *(int32_t *)(a1 + 4) = 0;
    *v4 = *v3;
    return result;
}

// Address range: 0x4021d6 - 0x4021df
int32_t function_4021d6(void) {
    // 0x4021d6
    return _flsall(1);
}

// Address range: 0x402250 - 0x402585
int32_t function_402250(int32_t result5, uint32_t a2, uint32_t a3) {
    int32_t result3 = a3 + a2; // 0x402262
    int32_t v1; // 0x402250
    int32_t v2; // 0x402250
    int32_t v3; // 0x402250
    int32_t v4; // 0x402250
    int32_t v5; // 0x402250
    int32_t result6; // 0x402250
    int32_t v6; // 0x402250
    int32_t v7; // 0x402250
    int32_t v8; // 0x402250
    int32_t v9; // 0x402250
    int32_t v10; // 0x402250
    int32_t v11; // 0x402250
    int32_t result2; // 0x402250
    int32_t result; // 0x402250
    if (result5 > a2 == result3 > result5) {
        int32_t v12 = a3 - 4; // 0x4023e8
        int32_t v13 = v12 + a2; // 0x4023e8
        int32_t v14 = v12 + result5; // 0x4023ec
        int32_t v15 = v14 & 3; // 0x4023f0
        if (v15 != 0) {
            // 0x40241c
            g116 = a3;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a3) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x402548;
                }
                case 2: {
                    goto lab_0x402558;
                }
                case 3: {
                    goto lab_0x40256c;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a3 / 4));
            g115 = v16;
            if (a3 < 4) {
                // 0x402298
                return result3;
            }
            int32_t v17 = a3 & 3; // 0x4023fb
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a3 & -4); // 0x402404
            g114 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x402548;
                }
                case 2: {
                    goto lab_0x402558;
                }
                case 3: {
                    goto lab_0x40256c;
                }
                default: {
                    // 0x4024102
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x402270
        if (result4 != 0) {
            // 0x40228c
            result = result5;
            if (a3 >= 4) {
                // 0x402298
                return result4;
            }
            // 0x402298
            return result;
        }
        int32_t v19 = a3 / 4; // 0x402278
        g113 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x402278
                result6 = a3 & -4;
                goto lab_0x40237c;
            }
            case 2: {
                // 0x402278
                v3 = a3 & -4;
                goto lab_0x402374;
            }
            case 3: {
                // 0x402278
                v4 = a3 & -4;
                goto lab_0x40236c;
            }
            case 4: {
                // 0x402278
                v5 = a3 & -4;
                goto lab_0x402364;
            }
            case 5: {
                // 0x402278
                v1 = a3 & -4;
                goto lab_0x40235c;
            }
            case 6: {
                // 0x402278
                v2 = a3 & -4;
                goto lab_0x402354;
            }
            case 7: {
                int32_t v20 = a3 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a2);
                v2 = v20;
                goto lab_0x402354;
            }
            default: {
                int32_t v22 = a3 & 3; // 0x40227b
                __asm_rep_movsd_memcpy((char *)result5, (char *)a2, v19);
                g109 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x402298
                    return result5;
                }
                // 0x402298
                return result2;
            }
        }
    }
  lab_0x402548:
    // 0x402548
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x402558:
    // 0x402558
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x40256c:
    // 0x40256c
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x40237c:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a2);
    // 0x402298
    return result6;
  lab_0x402374:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a2);
    result6 = v3;
    goto lab_0x40237c;
  lab_0x40236c:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a2);
    v3 = v4;
    goto lab_0x402374;
  lab_0x402364:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a2);
    v4 = v5;
    goto lab_0x40236c;
  lab_0x40235c:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a2);
    v5 = v1;
    goto lab_0x402364;
  lab_0x402354:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a2);
    v1 = v2;
    goto lab_0x40235c;
}

// Address range: 0x402585 - 0x4025c1
int32_t function_402585(int32_t a1) {
    int32_t * v1 = HeapCreate((int32_t)(bool)(a1 == 0), 0x1000, 0); // 0x402596
    g100 = (int32_t)v1;
    if (v1 == NULL) {
        // 0x4025ba
        return 0;
    }
    int32_t result = 1; // 0x4025ac
    if (function_4025c1() == 0) {
        // 0x4025ae
        HeapDestroy((int32_t *)g100);
        result = 0;
    }
    // 0x4025ba
    return result;
}

// Address range: 0x4025c1 - 0x4025ff
int32_t function_4025c1(void) {
    int32_t * v1 = HeapAlloc((int32_t *)g100, 0, 320); // 0x4025ce
    int32_t result = (int32_t)v1; // 0x4025ce
    g99 = result;
    if (v1 == NULL) {
        // 0x4025dd
        return result;
    }
    // 0x4025de
    g97 = 0;
    g98 = 0;
    g96 = result;
    g94 = 16;
    return 1;
}

// Address range: 0x4025ff - 0x40262a
int32_t function_4025ff(int32_t a1, int32_t a2) {
    uint32_t v1 = g99 + 20 * g98; // 0x40260c
    if (g99 >= v1) {
        // 0x402629
        return 0;
    }
    int32_t v2 = g99; // 0x402611
    int32_t result = v2; // 0x402620
    while (a1 - *(int32_t *)(v2 + 12) >= 0x100000) {
        // 0x402622
        v2 += 20;
        result = 0;
        if (v2 >= v1) {
            // break -> 0x402629
            break;
        }
        result = v2;
    }
    // 0x402629
    return result;
}

// Address range: 0x40262a - 0x402955
int32_t function_40262a(int32_t a1, int32_t a2) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x402638
    int32_t v2 = a2 - 4; // 0x402640
    int32_t v3 = *(int32_t *)v2; // 0x402640
    int32_t v4 = (a2 - *(int32_t *)(a1 + 12)) / 0x8000; // 0x402647
    int32_t v5 = *(int32_t *)(a2 - 8); // 0x40264c
    int32_t v6 = v3 - 1; // 0x402655
    int32_t v7 = *(int32_t *)(v6 + v2); // 0x402666
    int32_t v8 = v6; // 0x40266f
    if ((v7 & 1) == 0) {
        int32_t v9 = v3 + v2;
        int32_t * v10 = (int32_t *)(v9 + 3); // 0x402682
        int32_t * v11 = (int32_t *)(v9 + 7); // 0x402686
        if (*v10 == *v11) {
            uint32_t v12 = v7 / 16 - 1; // 0x402676
            uint32_t v13 = v12 < 63 ? v12 : 63;
            int32_t v14 = v1 + 4 + v13;
            int32_t v15 = -1 - (0x80000000 >> (v13 & 31));
            int32_t v16 = 4 * v4;
            if (v13 >= 32) {
                int32_t * v17 = (int32_t *)(v1 + 196 + v16); // 0x4026c3
                *v17 = *v17 & v15;
                char * v18 = (char *)v14; // 0x4026ca
                char v19 = *v18 - 1; // 0x4026ca
                *v18 = v19;
                if (v19 == 0) {
                    int32_t * v20 = (int32_t *)(a1 + 4); // 0x4026d1
                    *v20 = *v20 & v15;
                }
            } else {
                int32_t * v21 = (int32_t *)(v1 + 68 + v16); // 0x4026a1
                *v21 = *v21 & v15;
                char * v22 = (char *)v14; // 0x4026a5
                char v23 = *v22 - 1; // 0x4026a5
                *v22 = v23;
                if (v23 == 0) {
                    int32_t * v24 = (int32_t *)a1; // 0x4026ac
                    *v24 = *v24 & v15;
                }
            }
        }
        // 0x4026d4
        *(int32_t *)(*v11 + 4) = *v10;
        *(int32_t *)(*v10 + 8) = *v11;
        v8 = v7 + v6;
    }
    int32_t result = v1 + 324 + 516 * v4; // 0x402659
    int32_t v25; // 0x40262a
    int32_t v26; // 0x40262a
    int32_t v27; // 0x40262a
    int32_t v28; // 0x40262a
    int32_t v29; // 0x40262a
    int32_t * v30; // 0x40262a
    int32_t * v31; // 0x40262a
    if ((v5 & 1) != 0) {
        uint32_t v32 = v8 / 16 - 1; // 0x4026f5
        v31 = (int32_t *)(a2 + 4);
        v30 = (int32_t *)a2;
        v25 = v32 < 63 ? v32 : 63;
        v26 = v2;
        v28 = v8;
        goto lab_0x4027bc;
    } else {
        int32_t v33 = v2 - v5; // 0x40270d
        uint32_t v34 = v5 / 16 - 1; // 0x40271b
        uint32_t v35 = v34 < 63 ? v34 : 63;
        int32_t v36 = v8 + v5; // 0x402729
        uint32_t v37 = v36 / 16 - 1; // 0x402734
        int32_t v38 = v37 < 63 ? v37 : 63;
        v27 = v33;
        v29 = v36;
        if (v35 == v38) {
            goto lab_0x402845;
        } else {
            // 0x40273f
            v30 = (int32_t *)(v33 + 4);
            v31 = (int32_t *)(v33 + 8);
            if (*v30 == *v31) {
                uint32_t v39 = v35 & 31;
                if (v35 >= 32) {
                    int32_t v40 = -1 - (0x80000000 >> v39);
                    int32_t * v41 = (int32_t *)(v1 + 196 + 4 * v4); // 0x402781
                    *v41 = *v41 & v40;
                    char * v42 = (char *)(v1 + 4 + v35); // 0x402788
                    char v43 = *v42 - 1; // 0x402788
                    *v42 = v43;
                    if (v43 == 0) {
                        int32_t * v44 = (int32_t *)(a1 + 4); // 0x40278f
                        *v44 = *v44 & v40;
                    }
                } else {
                    int32_t v45 = v39 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v39);
                    int32_t * v46 = (int32_t *)(v1 + 68 + 4 * v4); // 0x40275f
                    *v46 = *v46 & v45;
                    char * v47 = (char *)(v1 + 4 + v35); // 0x402763
                    char v48 = *v47 - 1; // 0x402763
                    *v47 = v48;
                    if (v48 == 0) {
                        int32_t * v49 = (int32_t *)a1; // 0x40276a
                        *v49 = *v49 & v45;
                    }
                }
            }
            // 0x4027ad
            *(int32_t *)(*v31 + 4) = *v30;
            *(int32_t *)(*v30 + 8) = *v31;
            v25 = v38;
            v26 = v33;
            v28 = v36;
            goto lab_0x4027bc;
        }
    }
  lab_0x4027bc:;
    int32_t v50 = 8 * v25 + result; // 0x4027bf
    int32_t * v51 = (int32_t *)(v50 + 4); // 0x4027c2
    *v30 = *v51;
    *v31 = v50;
    *v51 = v26;
    *(int32_t *)(*v30 + 8) = v26;
    v27 = v26;
    v29 = v28;
    if (*v30 == *v31) {
        char * v52 = (char *)(v1 + 4 + v25); // 0x4027e2
        char v53 = *v52; // 0x4027e2
        *v52 = v53 + 1;
        int32_t v54 = 0x80000000 >> (v25 & 31);
        if (v25 >= 32) {
            if (v53 == 0) {
                int32_t * v55 = (int32_t *)(a1 + 4); // 0x40282c
                *v55 = *v55 | v54;
            }
            int32_t * v56 = (int32_t *)(v1 + 196 + 4 * v4); // 0x402840
            *v56 = *v56 | v54;
            v27 = v26;
            v29 = v28;
        } else {
            if (v53 == 0) {
                int32_t * v57 = (int32_t *)a1; // 0x402806
                *v57 = *v57 | v54;
            }
            int32_t * v58 = (int32_t *)(v1 + 68 + 4 * v4); // 0x402815
            *v58 = *v58 | v54;
            v27 = v26;
            v29 = v28;
        }
    }
    goto lab_0x402845;
  lab_0x402845:;
    int32_t v59 = v29;
    *(int32_t *)v27 = v59;
    *(int32_t *)(v27 - 4 + v59) = v59;
    int32_t * v60 = (int32_t *)result; // 0x40284e
    int32_t v61 = *v60 - 1; // 0x40284e
    *v60 = v61;
    if (v61 != 0) {
        // 0x402950
        return result;
    }
    int32_t v62 = g97; // 0x402856
    int32_t result2 = a1; // 0x40285d
    if (v62 != 0) {
        // 0x402863
        int32_t lpAddress; // bp-36, 0x40262a
        int32_t v63 = &lpAddress; // 0x402646
        *(int32_t *)(v63 - 4) = 0x4000;
        *(int32_t *)(v63 - 8) = 0x8000;
        *(int32_t *)(v63 - 12) = 0x8000 * g95 + *(int32_t *)(v62 + 12);
        int32_t dwSize; // 0x40262a
        int32_t dwFreeType; // 0x40262a
        VirtualFree((int32_t *)lpAddress, dwSize, dwFreeType);
        int32_t * v64 = (int32_t *)(g97 + 8); // 0x402895
        *v64 = *v64 | 0x80000000 >> (g95 & 31);
        *(int32_t *)(*(int32_t *)(g97 + 16) + 196 + 4 * g95) = 0;
        char * v65 = (char *)(*(int32_t *)(g97 + 16) + 67); // 0x4028b6
        *v65 = *v65 - 1;
        int32_t v66 = g97; // 0x4028b9
        int32_t v67 = v66; // 0x4028c5
        if (*(char *)(*(int32_t *)(v66 + 16) + 67) == 0) {
            int32_t * v68 = (int32_t *)(v66 + 4); // 0x4028c7
            *v68 = *v68 & -2;
            v67 = g97;
        }
        // 0x4028d0
        result2 = a1;
        if (*(int32_t *)(v67 + 8) == -1) {
            // 0x4028d6
            *(int32_t *)(v63 - 16) = 0x8000;
            *(int32_t *)(v63 - 20) = 0;
            *(int32_t *)(v63 - 24) = *(int32_t *)(v67 + 12);
            VirtualFree(&g112, (int32_t)&g112, (int32_t)&g112);
            *(int32_t *)(v63 - 28) = *(int32_t *)(g97 + 16);
            *(int32_t *)(v63 - 32) = 0;
            *(int32_t *)(v63 - 36) = g100;
            HeapFree(&g112, (int32_t)&g112, &g112);
            *(int32_t *)(v63 - 40) = 20 * g98 - 20 + g99 - g97;
            *(int32_t *)(v63 - 44) = g97 + 20;
            *(int32_t *)(v63 - 48) = g97;
            function_4049f0((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
            g98--;
            g96 = g99;
            result2 = g97 < a1 ? a1 - 20 : a1;
        }
    }
    // 0x402945
    g97 = result2;
    g95 = v4;
    // 0x402950
    return result2;
}

// Address range: 0x402955 - 0x402c5e
int32_t function_402955(int32_t a1) {
    uint32_t v1 = g99 + 20 * g98; // 0x40296c
    int32_t v2 = a1 + 23; // 0x402975
    int32_t v3 = v2 / 16 - 1; // 0x402981
    int32_t v4 = 0xffffffff >> (v3 & 31);
    int32_t v5 = v3 > 31 ? v4 : -1;
    int32_t v6 = v3 > 31 ? 0 : v4;
    uint32_t v7 = g96; // 0x4029a5
    int32_t v8 = v7; // 0x4029b1
    int32_t v9 = v7; // 0x4029b1
    if (v7 < v1) {
        int32_t v10 = *(int32_t *)v8; // 0x4029b6
        v9 = v8;
        while ((v10 & v6 | *(int32_t *)(v8 + 4) & v5) == 0) {
            // 0x4029c1
            v8 += 20;
            v9 = v8;
            if (v8 >= v1) {
                // break -> 0x4029cc
                break;
            }
            v10 = *(int32_t *)v8;
            v9 = v8;
        }
    }
    int32_t v11 = v9; // 0x4029cf
    if (v9 == v1) {
        int32_t v12 = g99; // 0x4029d8
        int32_t v13 = g99; // 0x4029d8
        if (g99 < v7) {
            int32_t v14 = *(int32_t *)(v12 + 4); // 0x4029da
            v13 = v12;
            while ((*(int32_t *)v12 & v6 || v14 & v5) == 0) {
                int32_t v15 = v12 + 20; // 0x4029e8
                v12 = v15;
                v13 = v15;
                if (v15 >= v7) {
                    // break -> 0x4029ef
                    break;
                }
                v14 = *(int32_t *)(v12 + 4);
                v13 = v12;
            }
        }
        // 0x4029ef
        v11 = v13;
        if (v13 == v7) {
            int32_t v16 = v13; // 0x4029f4
            int32_t v17 = v13; // 0x4029f4
            if (v13 < v1) {
                v17 = v16;
                while (*(int32_t *)(v16 + 8) == 0) {
                    int32_t v18 = v16 + 20; // 0x4029fc
                    v16 = v18;
                    v17 = v18;
                    if (v18 >= v1) {
                        // break -> 0x402a07
                        break;
                    }
                    v17 = v16;
                }
            }
            int32_t v19 = v17; // 0x402a07
            if (v17 == v1) {
                int32_t v20 = g99; // 0x402a10
                int32_t v21 = g99; // 0x402a10
                if (g99 < v7) {
                    v21 = v20;
                    while (*(int32_t *)(v20 + 8) == 0) {
                        int32_t v22 = v20 + 20; // 0x402a18
                        v20 = v22;
                        v21 = v22;
                        if (v22 >= v7) {
                            // break -> 0x402a1f
                            break;
                        }
                        v21 = v20;
                    }
                }
                // 0x402a1f
                v19 = v21;
                if (v21 == v7) {
                    int32_t v23 = function_402c5e(v21); // 0x402a21
                    v19 = v23;
                    if (v23 == 0) {
                        // 0x402c59
                        return 0;
                    }
                }
            }
            int32_t v24 = function_402d0f(v19); // 0x402a30
            int32_t * v25 = (int32_t *)(v19 + 16); // 0x402a36
            *(int32_t *)*v25 = v24;
            v11 = v19;
            if (*(int32_t *)*v25 == -1) {
                // 0x402c59
                return 0;
            }
        }
    }
    // 0x402a4a
    g96 = v11;
    int32_t v26 = *(int32_t *)(v11 + 16); // 0x402a50
    int32_t * v27 = (int32_t *)v26; // 0x402a53
    int32_t v28 = *v27; // 0x402a53
    int32_t v29; // 0x402955
    int32_t v30; // 0x402955
    int32_t v31; // 0x402955
    if (v28 == -1) {
        // 0x402a4a
        v29 = v26 + 68;
        v30 = v26 + 196;
        goto lab_0x402a71;
    } else {
        int32_t v32 = 4 * v28; // 0x402a5d
        int32_t v33 = v26 + 196;
        int32_t v34 = v26 + 68;
        int32_t v35 = *(int32_t *)(v32 + v34); // 0x402a64
        v29 = v34;
        v30 = v33;
        v31 = v28;
        if ((v35 & v6 || *(int32_t *)(v32 + v33) & v5) != 0) {
            goto lab_0x402aa8;
        } else {
            goto lab_0x402a71;
        }
    }
  lab_0x402a71:;
    int32_t v36 = *(int32_t *)v29; // 0x402a77
    v31 = 0;
    if ((v36 & v6 || *(int32_t *)v30 & v5) == 0) {
        int32_t v37 = v29;
        int32_t v38 = 1; // 0x402a94
        int32_t v39 = v37 + 4; // 0x402a9a
        int32_t v40 = *(int32_t *)v39; // 0x402a9f
        int32_t v41 = v38; // 0x402aa3
        v31 = v38;
        while ((v40 & v6 | *(int32_t *)(v37 + 132) & v5) == 0) {
            // 0x402a8e
            v37 = v39;
            v38 = v41 + 1;
            v39 = v37 + 4;
            v40 = *(int32_t *)v39;
            v41 = v38;
            v31 = v38;
        }
    }
    goto lab_0x402aa8;
  lab_0x402aa8:;
    int32_t v42 = 4 * v31; // 0x402abc
    int32_t * v43 = (int32_t *)(v42 + v26 + 68); // 0x402abc
    int32_t v44 = *v43; // 0x402abc
    int32_t v45 = v44 & v6; // 0x402ac0
    int32_t v46 = v45; // 0x402ac2
    int32_t v47 = 0; // 0x402ac2
    if (v45 == 0) {
        // 0x402ac4
        v46 = *(int32_t *)(v26 + 196 + v42) & v5;
        v47 = 32;
    }
    int32_t v48 = v47; // 0x402ad3
    if (v46 >= 0) {
        int32_t v49 = 2 * v46; // 0x402ad5
        int32_t v50 = v47 + 1; // 0x402ad7
        int32_t v51 = v50; // 0x402ad3
        int32_t v52 = v49; // 0x402ad3
        v48 = v50;
        while (v49 >= 0) {
            // 0x402ad5
            v49 = 2 * v52;
            v50 = v51 + 1;
            v51 = v50;
            v52 = v49;
            v48 = v50;
        }
    }
    int32_t v53 = v2 & -16; // 0x402978
    int32_t v54 = v26 + 324 + 516 * v31; // 0x402ab2
    int32_t v55 = v54 + 4; // 0x402add
    int32_t v56 = *(int32_t *)(8 * v48 + v55); // 0x402add
    int32_t * v57 = (int32_t *)v56; // 0x402ae1
    int32_t v58 = *v57 - v53; // 0x402ae3
    int32_t v59 = v58 < 1040 ? v58 / 16 - 1 : 63;
    if (v59 == v48) {
        if (v58 == 0) {
            goto lab_0x402c1b;
        } else {
            // 0x402c10
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x402c1b;
        }
    } else {
        int32_t * v60 = (int32_t *)(v56 + 4); // 0x402aff
        int32_t * v61 = (int32_t *)(v56 + 8); // 0x402b02
        if (*v60 == *v61) {
            uint32_t v62 = v48 & 31;
            if (v48 > 31) {
                int32_t v63 = -1 - (0x80000000 >> v62);
                int32_t * v64 = (int32_t *)(v26 + 196 + v42); // 0x402b51
                *v64 = *v64 & v63;
                char * v65 = (char *)(v26 + 4 + v48); // 0x402b53
                char v66 = *v65 - 1; // 0x402b53
                *v65 = v66;
                if (v66 == 0) {
                    int32_t * v67 = (int32_t *)(v11 + 4); // 0x402b60
                    *v67 = *v67 & v63;
                }
            } else {
                int32_t v68 = v62 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v62);
                *v43 = v68 & v44;
                char * v69 = (char *)(v26 + 4 + v48); // 0x402b29
                char v70 = *v69 - 1; // 0x402b29
                *v69 = v70;
                if (v70 == 0) {
                    int32_t * v71 = (int32_t *)v11; // 0x402b33
                    *v71 = *v71 & v68;
                }
            }
        }
        // 0x402b68
        *(int32_t *)(*v61 + 4) = *v60;
        *(int32_t *)(*v60 + 8) = *v61;
        if (v58 == 0) {
            goto lab_0x402c1b;
        } else {
            int32_t v72 = 8 * v59; // 0x402b87
            int32_t v73 = v72 + v54; // 0x402b8b
            *v60 = *(int32_t *)(v72 + v55);
            *v61 = v73;
            *(int32_t *)(v73 + 4) = v56;
            *(int32_t *)(*v60 + 8) = v56;
            if (*v60 == *v61) {
                char * v74 = (char *)(v26 + 4 + v59); // 0x402ba5
                char v75 = *v74; // 0x402ba5
                *v74 = v75 + 1;
                int32_t v76 = 0x80000000 >> (v59 & 31);
                if (v59 > 31) {
                    if (v75 == 0) {
                        int32_t * v77 = (int32_t *)(v11 + 4); // 0x402bf0
                        *v77 = *v77 | v76;
                    }
                    int32_t * v78 = (int32_t *)(v26 + 196 + v42); // 0x402c07
                    *v78 = *v78 | v76;
                } else {
                    if (v75 == 0) {
                        int32_t * v79 = (int32_t *)v11; // 0x402bc6
                        *v79 = *v79 | v76;
                    }
                    // 0x402bc8
                    *v43 = *v43 | v76;
                }
            }
            // 0x402c10
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x402c1b;
        }
    }
  lab_0x402c1b:;
    int32_t v80 = v58 + v56; // 0x402c1e
    int32_t v81 = v53 | 1; // 0x402c20
    *(int32_t *)v80 = v81;
    *(int32_t *)(v53 - 4 + v80) = v81;
    int32_t * v82 = (int32_t *)v54; // 0x402c2c
    int32_t v83 = *v82; // 0x402c2c
    *v82 = v83 + 1;
    if (v83 != 0 || v11 != g97) {
        // 0x402c51
        *v27 = v31;
        // 0x402c59
        return v80 + 4;
    }
    // 0x402c3f
    if (g95 == v31) {
        // 0x402c4a
        g97 = 0;
    }
    // 0x402c51
    *v27 = v31;
    // 0x402c59
    return v80 + 4;
}

// Address range: 0x402c5e - 0x402d0f
int32_t function_402c5e(int32_t a1) {
    int32_t v1 = g98; // 0x402c5e
    int32_t v2 = g94; // 0x402c63
    int32_t v3; // 0x402c5e
    int32_t v4; // 0x402c5e
    int32_t * v5; // 0x402c5e
    if (v1 != v2) {
        // 0x402c5e
        v3 = g99;
        v4 = v1;
        int32_t v6; // bp-8, 0x402c5e
        v5 = &v6;
    } else {
        int32_t v7 = g100; // bp-24, 0x402c80
        int32_t * v8 = HeapReAlloc((int32_t *)g100, 0, (int32_t *)g99, 4 * (v2 + 80 + 4 * v2)); // 0x402c86
        if (v8 == NULL) {
            // 0x402d0c
            return 0;
        }
        int32_t v9 = (int32_t)v8; // 0x402c86
        g94 += 16;
        g99 = v9;
        v3 = v9;
        v4 = g98;
        v5 = &v7;
    }
    int32_t v10 = (int32_t)v5;
    *(int32_t *)(v10 - 4) = 0x41c4;
    *(int32_t *)(v10 - 8) = 8;
    *(int32_t *)(v10 - 12) = g100;
    int32_t v11 = 20 * v4 + v3; // 0x402cb7
    int32_t * v12 = HeapAlloc(&g112, (int32_t)&g112, (int32_t)&g112); // 0x402cba
    int32_t * v13 = (int32_t *)(v11 + 16); // 0x402cc2
    *v13 = (int32_t)v12;
    if (v12 == NULL) {
        // 0x402d0c
        return 0;
    }
    // 0x402cc7
    *(int32_t *)(v10 - 16) = 4;
    *(int32_t *)(v10 - 20) = 0x2000;
    *(int32_t *)(v10 - 24) = 0x100000;
    *(int32_t *)(v10 - 28) = 0;
    int32_t * memory = VirtualAlloc(&g112, (int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x402cd4
    *(int32_t *)(v11 + 12) = (int32_t)memory;
    int32_t result; // 0x402c5e
    if (memory != NULL) {
        // 0x402cf5
        *(int32_t *)(v11 + 8) = -1;
        *(int32_t *)v11 = 0;
        *(int32_t *)(v11 + 4) = 0;
        g98++;
        *(int32_t *)*v13 = -1;
        result = v11;
    } else {
        // 0x402ce1
        *(int32_t *)(v10 - 32) = *v13;
        *(int32_t *)(v10 - 36) = 0;
        *(int32_t *)(v10 - 40) = g100;
        HeapFree(&g112, (int32_t)&g112, &g112);
        result = 0;
    }
    // 0x402d0c
    return result;
}

// Address range: 0x402d0f - 0x402e0a
int32_t function_402d0f(int32_t a1) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x402d19
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x402d1c
    uint32_t v3 = *v2; // 0x402d1c
    int32_t v4 = 0; // 0x402d23
    int32_t v5 = v3; // 0x402d23
    int32_t result = 0; // 0x402d23
    if (v3 >= 0) {
        v5 *= 2;
        v4++;
        result = v4;
        while (v5 >= 0) {
            // 0x402d25
            v5 *= 2;
            v4++;
            result = v4;
        }
    }
    int32_t v6 = v1 + 324 + 516 * result; // 0x402d35
    int32_t v7 = v6; // 0x402d3c
    for (int32_t i = 63; i > 0; i--) {
        int32_t v8 = v7;
        v7 = v8 + 8;
        *(int32_t *)v7 = v8;
        *(int32_t *)(v8 + 4) = v8;
    }
    uint32_t lpAddress = *(int32_t *)(a1 + 12) + 0x8000 * result; // 0x402d52
    if (VirtualAlloc((int32_t *)lpAddress, 0x8000, 0x1000, 4) == NULL) {
        // 0x402e05
        return -1;
    }
    if (lpAddress < 0xffff9000) {
        int32_t v9 = lpAddress + 16;
        *(int32_t *)(v9 - 8) = -1;
        *(int32_t *)(v9 + 4076) = -1;
        *(int32_t *)(v9 - 4) = 4080;
        *(int32_t *)v9 = v9 + 4092;
        *(int32_t *)(v9 + 4) = v9 - 0x1004;
        *(int32_t *)(v9 + 4072) = 4080;
        int32_t v10 = v9 + 0x1000; // 0x402db6
        while (v9 + 4080 <= lpAddress + 0x7000) {
            // 0x402d7f
            v9 = v10;
            *(int32_t *)(v9 - 8) = -1;
            *(int32_t *)(v9 + 4076) = -1;
            *(int32_t *)(v9 - 4) = 4080;
            *(int32_t *)v9 = v9 + 4092;
            *(int32_t *)(v9 + 4) = v9 - 0x1004;
            *(int32_t *)(v9 + 4072) = 4080;
            v10 = v9 + 0x1000;
        }
    }
    int32_t v11 = v6 + 504; // 0x402dbe
    *(int32_t *)(v6 + 508) = lpAddress + 12;
    *(int32_t *)(lpAddress + 20) = v11;
    *(int32_t *)(v6 + 512) = lpAddress + 0x700c;
    *(int32_t *)(lpAddress + 0x7010) = v11;
    int32_t v12 = 4 * result + v1;
    *(int32_t *)(v12 + 68) = 0;
    *(int32_t *)(v12 + 196) = 1;
    char * v13 = (char *)(v1 + 67); // 0x402de1
    char v14 = *v13; // 0x402de1
    *v13 = v14 + 1;
    if (v14 == 0) {
        int32_t * v15 = (int32_t *)(a1 + 4); // 0x402df2
        *v15 = *v15 | 1;
    }
    uint32_t v16 = result & 31; // 0x402dfc
    *v2 = *v2 & (v16 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v16));
    // 0x402e05
    return result;
}

// Address range: 0x402e0a - 0x402ebd
int32_t function_402e0a(int32_t a1) {
    // 0x402e0a
    if ((int32_t)g93 <= a1) {
        // 0x402ea4
        g51 = 0;
        g50 = 9;
        // 0x402eb8
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x402e32
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x402ea4
        g51 = 0;
        g50 = 9;
        // 0x402eb8
        return -1;
    }
    // 0x402e3b
    int32_t v3; // bp-16, 0x402e0a
    int32_t v4 = &v3; // 0x402e0d
    int32_t v5 = a1; // bp-20, 0x402e3b
    int32_t v6 = v4; // 0x402e45
    int32_t errorCode = 0; // 0x402e45
    if (function_404eab(a1) == -1) {
        goto lab_0x402e85;
    } else {
        if (a1 != 1 == (a1 != 2)) {
            goto lab_0x402e67;
        } else {
            // 0x402e51
            v5 = 2;
            int32_t v7 = function_404eab(2); // 0x402e53
            v6 = v4;
            errorCode = 0;
            if (function_404eab(1) == v7) {
                goto lab_0x402e85;
            } else {
                goto lab_0x402e67;
            }
        }
    }
  lab_0x402e85:;
    int32_t * v8 = (int32_t *)(v6 - 4); // 0x402e85
    *v8 = a1;
    function_404e31((int32_t)&g112);
    *(char *)(*v1 + v2) = 0;
    int32_t result = 0; // 0x402e95
    if (errorCode != 0) {
        // 0x402e97
        *v8 = errorCode;
        function_40492a((int32_t)&g112);
        result = -1;
    }
    // 0x402eb8
    return result;
  lab_0x402e67:;
    int32_t hObject = function_404eab(a1); // 0x402e68
    v5 = hObject;
    int32_t v9 = &v5; // 0x402e6e
    v6 = v9;
    errorCode = 0;
    if (!CloseHandle((int32_t *)hObject)) {
        // 0x402e79
        v6 = v9;
        errorCode = GetLastError();
    }
    goto lab_0x402e85;
}

// Address range: 0x402ebd - 0x402ee8
int32_t function_402ebd(int32_t a1) {
    int32_t v1 = a1 + 12; // 0x402ec2
    int32_t v2 = *(int32_t *)v1; // 0x402ec2
    int32_t result = v2; // 0x402ec7
    if ((v2 & 131) != 0 && (v2 & 8) != 0) {
        int32_t * v3 = (int32_t *)(a1 + 8); // 0x402ecd
        function_40163a(*v3);
        int16_t * v4 = (int16_t *)v1; // 0x402ed5
        *v4 = *v4 & -1033;
        *(int32_t *)a1 = 0;
        *v3 = 0;
        *(int32_t *)(a1 + 4) = 0;
        result = 0;
    }
    // 0x402ee6
    return result;
}

// Address range: 0x402ee8 - 0x402fc1
int32_t function_402ee8(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x402eed
    int32_t v2 = *v1; // 0x402eed
    if ((v2 & 131) == 0) {
        // 0x402fbc
        return -1;
    }
    if ((v2 & 64) != 0) {
        // 0x402fbc
        return -1;
    }
    if ((v2 & 2) != 0) {
        // 0x402f04
        *v1 = v2 | 32;
        // 0x402fbc
        return -1;
    }
    // 0x402f0e
    *v1 = v2 | 1;
    int32_t * v3; // 0x402ee8
    if ((v2 & 268) != 0) {
        int32_t * v4 = (int32_t *)(a1 + 8);
        *(int32_t *)a1 = *v4;
        v3 = v4;
    } else {
        // 0x402f19
        function_4048c0(a1);
        v3 = (int32_t *)(a1 + 8);
    }
    int32_t * v5 = (int32_t *)(a1 + 24); // 0x402f27
    int32_t * v6 = (int32_t *)(a1 + 16); // 0x402f2d
    int32_t v7 = function_402fc1(*v6, *v3, *v5); // 0x402f30
    int32_t * v8 = (int32_t *)(a1 + 4); // 0x402f38
    *v8 = v7;
    if (v7 < 1) {
        // 0x402fab
        *v1 = *v1 | (v7 == 0 ? 16 : 32);
        *v8 = 0;
        // 0x402fbc
        return -1;
    }
    int32_t v9 = *v1; // 0x402f44
    int32_t v10 = v9; // 0x402f4a
    if ((v9 & 130) == 0) {
        int32_t v11 = *v6; // 0x402f4c
        int32_t v12 = &g31; // 0x402f53
        if (v11 != -1) {
            int32_t v13 = *(int32_t *)(4 * v11 / 32 + (int32_t)&g91); // 0x402f5d
            v12 = v13 + (8 * v11 & 248);
        }
        // 0x402f6e
        v10 = v9;
        if ((*(char *)(v12 + 4) & -126) == -126) {
            int32_t v14 = v9 | 0x2000; // 0x402f7a
            *v1 = v14;
            v10 = v14;
        }
    }
    // 0x402f80
    if (!(((v10 & 8) == 0 | *v5 != 512))) {
        if ((v10 & 1024) == 0) {
            // 0x402f96
            *v5 = 0x1000;
        }
    }
    int32_t * v15 = (int32_t *)a1; // 0x402f9d
    int32_t v16 = *v15; // 0x402f9d
    *v8 = v7 - 1;
    *v15 = v16 + 1;
    return (int32_t)*(char *)v16;
}

// Address range: 0x402fc1 - 0x4031b7
int32_t function_402fc1(uint32_t a1, int32_t a2, int32_t a3) {
    // 0x402fc1
    if ((int32_t)g93 <= a1) {
        // 0x40319e
        g51 = 0;
        g50 = 9;
        // 0x4031b2
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x402fe1
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x402feb
    int32_t v3 = *v2 + v1;
    unsigned char v4 = *(char *)(v3 + 4); // 0x402ff4
    if ((v4 & 1) == 0) {
        // 0x40319e
        g51 = 0;
        g50 = 9;
        // 0x4031b2
        return -1;
    }
    // 0x403000
    if (a3 == 0) {
        // 0x4031b2
        return 0;
    }
    int32_t v5 = v4; // 0x402ff4
    if ((v5 & 2) != 0) {
        // 0x4031b2
        return 0;
    }
    int32_t v6 = v3; // 0x403017
    int32_t v7 = 0; // 0x403017
    int32_t nNumberOfBytesToRead = a3; // 0x403017
    int32_t lpBuffer = a2; // 0x403017
    if ((v5 & 72) != 0) {
        char v8 = *(char *)(v3 + 5); // 0x403019
        v6 = v3;
        v7 = 0;
        nNumberOfBytesToRead = a3;
        lpBuffer = a2;
        if (v8 != 10) {
            // 0x403020
            *(char *)a2 = v8;
            *(char *)(*v2 + (v1 | 5)) = 10;
            v6 = *v2 + v1;
            v7 = 1;
            nNumberOfBytesToRead = a3 - 1;
            lpBuffer = a2 + 1;
        }
    }
    int32_t hFile = *(int32_t *)v6; // 0x403042
    int32_t v9 = hFile; // bp-48, 0x403042
    int32_t lpNumberOfBytesRead; // bp-16, 0x402fc1
    bool v10 = ReadFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToRead, &lpNumberOfBytesRead, NULL); // 0x403045
    if (!v10) {
        int32_t errorCode = GetLastError(); // 0x40304f
        if (errorCode == 5) {
            // 0x40305c
            g50 = 9;
            g51 = 5;
            // 0x4031b2
            return -1;
        }
        int32_t result = 0; // 0x403074
        if (errorCode != 109) {
            // 0x40307d
            function_40492a(errorCode);
            result = -1;
        }
        // 0x4031b2
        return result;
    }
    int32_t result2 = lpNumberOfBytesRead + v7; // 0x40308e
    int32_t v11 = v1 | 4;
    char * v12 = (char *)(*v2 + v11); // 0x403095
    char v13 = *v12; // 0x403095
    if (v13 > -1) {
        // 0x4031b2
        return result2;
    }
    char v14; // 0x402fc1
    if (lpNumberOfBytesRead == 0) {
        // 0x4030ae
        v14 = v13 & -5;
        goto lab_0x4030b0;
    } else {
        // 0x4030a5
        if (*(char *)a2 != 10) {
            // 0x4030ae
            v14 = v13 & -5;
            goto lab_0x4030b0;
        } else {
            // 0x4030aa
            v14 = v13 | 4;
            goto lab_0x4030b0;
        }
    }
  lab_0x403175:;
    // 0x403175
    int32_t v15; // 0x402fc1
    int32_t v16 = v15; // 0x40317b
    int32_t v17; // 0x402fc1
    int32_t v18 = v17; // 0x40317b
    int32_t v19; // 0x402fc1
    int32_t v20 = v19; // 0x40317b
    int32_t v21 = v19; // 0x40317b
    uint32_t v22; // 0x4030bb
    if (v15 >= v22) {
        // 0x4031b2
        return v21 - a2;
    }
    goto lab_0x4030c8;
  lab_0x40312a:;
    // 0x40312a
    int32_t v23; // 0x402fc1
    int32_t v32; // 0x402fc1
    int32_t v31; // 0x402fc1
    char v27; // bp-5, 0x402fc1
    int32_t hFile2; // 0x403108
    int32_t v28; // 0x403113
    if (lpNumberOfBytesRead == 0) {
        goto lab_0x403171;
    } else {
        // 0x403130
        if ((*(char *)(*v2 + v11) & 72) == 0) {
            if (v23 != a2) {
                goto lab_0x40315c;
            } else {
                // 0x403151
                v31 = hFile2;
                v32 = v28;
                if (v27 != 10) {
                    goto lab_0x40315c;
                } else {
                    goto lab_0x403157;
                }
            }
        } else {
            // 0x403139
            v31 = hFile2;
            v32 = v28;
            if (v27 == 10) {
                goto lab_0x403157;
            } else {
                // 0x403140
                *(char *)v23 = 13;
                *(char *)(*v2 + (v1 | 5)) = v27;
                v15 = hFile2;
                v17 = v28;
                v19 = v23 + 1;
                goto lab_0x403175;
            }
        }
    }
  lab_0x403171:
    // 0x403171
    *(char *)v23 = 13;
    int32_t v33 = hFile2; // 0x403171
    int32_t v34 = v28; // 0x403171
    goto lab_0x403174;
  lab_0x403157:
    // 0x403157
    *(char *)v23 = 10;
    v33 = v31;
    v34 = v32;
    goto lab_0x403174;
  lab_0x403174:
    // 0x403174
    v15 = v33;
    v17 = v34;
    v19 = v23 + 1;
    goto lab_0x403175;
  lab_0x40315c:;
    // 0x40315c
    int32_t v24; // 0x402fc1
    *(int32_t *)(v24 - 24) = 1;
    *(int32_t *)(v24 - 28) = -1;
    *(int32_t *)(v24 - 32) = a1;
    function_40337d((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    v15 = hFile2;
    v17 = v28;
    v19 = v23;
    if (v27 == 10) {
        goto lab_0x403175;
    } else {
        goto lab_0x403171;
    }
  lab_0x4030b0:
    // 0x4030b0
    *v12 = v14;
    v22 = result2 + a2;
    if (v22 <= a2) {
        // 0x4031b2
        return 0;
    }
    // 0x4030c8
    v16 = a2;
    v18 = &v9;
    v20 = a2;
    while (true) {
      lab_0x4030c8:
        // 0x4030c8
        v23 = v20;
        v24 = v18;
        uint32_t v25 = v16;
        char v26 = *(char *)v25; // 0x4030cb
        switch (v26) {
            case 26: {
                goto lab_0x403183;
            }
            case 13: {
                if (v25 >= v22 - 1) {
                    // 0x403102
                    *(int32_t *)(v24 - 4) = 0;
                    *(int32_t *)(v24 - 8) = (int32_t)&lpNumberOfBytesRead;
                    hFile2 = v25 + 1;
                    *(int32_t *)(v24 - 12) = 1;
                    *(int32_t *)(v24 - 16) = (int32_t)&v27;
                    v28 = v24 - 20;
                    *(int32_t *)v28 = *(int32_t *)(*v2 + v1);
                    bool v29 = ReadFile((int32_t *)hFile2, &g112, (int32_t)&g112, &g112, (struct _OVERLAPPED *)&g112); // 0x403116
                    if (v29) {
                        goto lab_0x40312a;
                    } else {
                        // 0x403120
                        if (GetLastError() != 0) {
                            goto lab_0x403171;
                        } else {
                            goto lab_0x40312a;
                        }
                    }
                } else {
                    int32_t v30 = v25 + 1; // 0x4030ed
                    if (*(char *)v30 != 10) {
                        // 0x4030f9
                        *(char *)v23 = 13;
                        v15 = v30;
                        v17 = v24;
                        v19 = v23 + 1;
                        goto lab_0x403175;
                    } else {
                        // 0x4030f3
                        v31 = v25 + 2;
                        v32 = v24;
                        goto lab_0x403157;
                    }
                }
            }
            default: {
                // 0x4030d9
                *(char *)v23 = v26;
                v15 = v25 + 1;
                v17 = v24;
                v19 = v23 + 1;
                goto lab_0x403175;
            }
        }
    }
  lab_0x403183:;
    char * v35 = (char *)(*v2 + v11); // 0x403189
    char v36 = *v35; // 0x403189
    if ((v36 & 64) == 0) {
        // 0x40318f
        *v35 = v36 | 2;
    }
    // 0x4031b2
    return v23 - a2;
}

// Address range: 0x4031b7 - 0x4031d2
int32_t __callnewh(int32_t a1) {
    // 0x4031b7
    return g69 != 0;
}

// Address range: 0x4031d2 - 0x40337d
int32_t function_4031d2(int32_t a1) {
    struct _STARTUPINFOA * v1 = (struct _STARTUPINFOA *)256; // bp-88, 0x4031d9
    int32_t * v2 = _malloc(256); // 0x4031de
    if (v2 == NULL) {
        // 0x4031ea
        v1 = (struct _STARTUPINFOA *)27;
        __amsg_exit();
    }
    int32_t v3 = (int32_t)v2; // 0x4031de
    g91 = v3;
    g93 = false;
    int32_t v4 = v3; // 0x40320a
    if (v2 < (int32_t *)-256) {
        *(char *)(v4 + 4) = 0;
        *(int32_t *)v4 = -1;
        *(char *)(v4 + 5) = 10;
        v4 += 8;
        while (v4 < g91 + 256) {
            // 0x40320c
            *(char *)(v4 + 4) = 0;
            *(int32_t *)v4 = -1;
            *(char *)(v4 + 5) = 10;
            v4 += 8;
        }
    }
    // 0x403226
    int32_t lpStartupInfo; // bp-68, 0x4031d2
    v1 = (struct _STARTUPINFOA *)&lpStartupInfo;
    int32_t v5 = (int32_t)&v1; // 0x40322a
    GetStartupInfoA((struct _STARTUPINFOA *)&lpStartupInfo);
    int32_t v6 = v5; // 0x403237
    int32_t v7; // 0x4031d2
    int32_t v8; // 0x4031d2
    int32_t v9; // 0x4031d2
    int32_t v10; // 0x4031d2
    int32_t v11; // 0x4031d2
    uint32_t v12; // 0x4031d2
    int32_t v13; // 0x4031d2
    int32_t v14; // 0x4031d2
    int32_t v15; // 0x4031d2
    uint32_t v16; // 0x4031d2
    int32_t v17; // 0x4031d2
    int16_t v18; // 0x4031d2
    char * v19; // 0x4032c3
    if (v17 != 0 && v18 != 0) {
        int32_t v20 = *(int32_t *)v17; // 0x403249
        v16 = v20 < 2048 ? v20 : 2048;
        if (v16 > (int32_t)g93) {
            int32_t v21 = &g92; // 0x4031d2
            *(int32_t *)(v5 - 4) = 256;
            int32_t * v22 = _malloc((int32_t)&g112); // 0x40326e
            v6 = v5;
            while (v22 != NULL) {
                int32_t v23 = (int32_t)v22; // 0x40326e
                int32_t * v24 = (int32_t *)v21; // 0x40327f
                *v24 = v23;
                int32_t v25 = v23; // 0x403289
                if (v22 < (int32_t *)-256) {
                    *(char *)(v25 + 4) = 0;
                    *(int32_t *)v25 = -1;
                    *(char *)(v25 + 5) = 10;
                    int32_t v26 = v25 + 8; // 0x403298
                    v25 = v26;
                    while (v26 < *v24 + 256) {
                        // 0x40328b
                        *(char *)(v25 + 4) = 0;
                        *(int32_t *)v25 = -1;
                        *(char *)(v25 + 5) = 10;
                        v26 = v25 + 8;
                        v25 = v26;
                    }
                }
                // 0x4032a3
                v21 += 4;
                if (v16 <= (int32_t)g93) {
                    goto lab_0x4032b6;
                }
                *(int32_t *)(v5 - 4) = 256;
                v22 = _malloc((int32_t)&g112);
                v6 = v5;
            }
        } else {
          lab_0x4032b6:;
            int32_t v27 = v17 + 4; // 0x40324b
            v10 = v20 + v27;
            v13 = v5;
            v8 = v27;
            v11 = 0;
            v6 = v5;
            if (v16 >= 1) {
                while (true) {
                  lab_0x4032bc:
                    // 0x4032bc
                    v12 = v11;
                    v9 = v8;
                    int32_t v28 = v13;
                    int32_t * v29 = (int32_t *)v10; // 0x4032bc
                    int32_t v30 = *v29; // 0x4032bc
                    v15 = v28;
                    if (v30 == -1) {
                        goto lab_0x4032f9;
                    } else {
                        // 0x4032c3
                        v19 = (char *)v9;
                        char v31 = *v19; // 0x4032c3
                        v15 = v28;
                        if ((v31 & 1) == 0) {
                            goto lab_0x4032f9;
                        } else {
                            // 0x4032cb
                            v7 = v30;
                            v14 = v28;
                            if ((v31 & 8) != 0) {
                                goto lab_0x4032db;
                            } else {
                                int32_t v32 = v28 - 4; // 0x4032d0
                                *(int32_t *)v32 = v30;
                                int32_t v33 = GetFileType(&g112); // 0x4032d1
                                v15 = v32;
                                if (v33 == 0) {
                                    goto lab_0x4032f9;
                                } else {
                                    // 0x4032d0
                                    v7 = *v29;
                                    v14 = v32;
                                    goto lab_0x4032db;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x403302:;
    int32_t v34 = 0; // 0x403302
    int32_t v35 = v6; // 0x403302
    int32_t v36; // 0x4031d2
    int32_t v37; // 0x4031d2
    int32_t v38; // 0x4031d2
    char * v39; // 0x403314
    while (true) {
      lab_0x403304:;
        int32_t v40 = v35;
        v36 = v34;
        int32_t v41 = g91 + 8 * v36; // 0x403309
        int32_t * v42 = (int32_t *)v41; // 0x403309
        if (*v42 != -1) {
            char * v43 = (char *)(v41 + 4); // 0x40335f
            *v43 = *v43 | -128;
            v38 = v40;
            goto lab_0x403363;
        } else {
            // 0x403312
            v39 = (char *)(v41 + 4);
            *v39 = -127;
            int32_t * v44; // 0x4031d2
            int32_t v45; // 0x4031d2
            int32_t v46; // 0x4031d2
            if (v36 != 0) {
                int32_t v47 = v40 - 4; // 0x403329
                v44 = (int32_t *)v47;
                v45 = v47;
                v46 = (int32_t)(v36 != 1) - 11;
            } else {
                int32_t v48 = v40 - 4;
                int32_t * v49 = (int32_t *)v48;
                *v49 = -10;
                v44 = v49;
                v45 = v48;
                v46 = -10;
            }
            // 0x403329
            *v44 = v46;
            int32_t * v50 = GetStdHandle((int32_t)&g112); // 0x40332a
            v37 = v45;
            if (v50 == (int32_t *)-1) {
                goto lab_0x40334e;
            } else {
                int32_t v51 = (int32_t)v50; // 0x40332a
                int32_t v52 = v40 - 8; // 0x403337
                *(int32_t *)v52 = v51;
                int32_t v53 = GetFileType(&g112); // 0x403338
                v37 = v52;
                if (v53 == 0) {
                    goto lab_0x40334e;
                } else {
                    int32_t v54 = v53 & 255; // 0x403342
                    *v42 = v51;
                    v37 = v52;
                    if (v54 != 2) {
                        // 0x403354
                        v38 = v52;
                        if (v54 == 3) {
                            // 0x403359
                            *v39 = *v39 | 8;
                            v38 = v52;
                        }
                        goto lab_0x403363;
                    } else {
                        goto lab_0x40334e;
                    }
                }
            }
        }
    }
  lab_0x403369:;
    // 0x403369
    int32_t v55; // 0x4031d2
    *(int32_t *)(v55 - 4) = (int32_t)g93;
    return SetHandleCount((int32_t)&g112);
  lab_0x403363:
    // 0x403363
    v55 = v38;
    int32_t v56 = v36 + 1; // 0x403363
    v34 = v56;
    v35 = v55;
    if (v56 == 3) {
        // break -> 0x403369
        goto lab_0x403369;
    }
    goto lab_0x403304;
  lab_0x40334e:
    // 0x40334e
    *v39 = *v39 | 64;
    v38 = v37;
    goto lab_0x403363;
  lab_0x4032f9:;
    int32_t v57 = v12 + 1; // 0x4032f9
    v10 += 4;
    v13 = v15;
    v8 = v9 + 1;
    v11 = v57;
    v6 = v15;
    if (v57 >= v16) {
        // break -> 0x403302
        goto lab_0x403302;
    }
    goto lab_0x4032bc;
  lab_0x4032db:;
    int32_t v58 = *(int32_t *)(4 * v12 / 32 + (int32_t)&g91); // 0x4032e5
    int32_t v59 = v58 + (8 * v12 & 248); // 0x4032ec
    *(int32_t *)v59 = v7;
    *(char *)(v59 + 4) = *v19;
    v15 = v14;
    goto lab_0x4032f9;
}

// Address range: 0x40337d - 0x403417
int32_t function_40337d(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod) {
    // 0x40337d
    if ((int32_t)g93 <= a1) {
        // 0x4033ff
        g51 = 0;
        g50 = 9;
        // 0x403413
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x4033a0
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x4033ff
        g51 = 0;
        g50 = 9;
        // 0x403413
        return -1;
    }
    int32_t hFile = function_404eab(a1); // 0x4033aa
    if (hFile == -1) {
        // 0x4033b5
        g50 = 9;
        // 0x403413
        return -1;
    }
    int32_t result = SetFilePointer((int32_t *)hFile, lDistanceToMove, NULL, dwMoveMethod); // 0x4033cc
    if (result == -1) {
        int32_t errorCode = GetLastError(); // 0x4033d9
        if (errorCode != 0) {
            // 0x4033e7
            function_40492a(errorCode);
            // 0x403413
            return -1;
        }
    }
    char * v3 = (char *)(*v1 + v2); // 0x4033f2
    *v3 = *v3 & -3;
    // 0x403413
    return result;
}

// Address range: 0x403417 - 0x403587
int32_t function_403417(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    char v1 = *(char *)a2; // 0x403430
    int32_t v2 = 265; // 0x403417
    int32_t v3; // 0x403417
    int32_t v4; // 0x403417
    switch (v1) {
        case 114: {
            // 0x403449
            v3 = 0;
            v4 = g74 | 1;
            // break -> 0x403458
            break;
        }
        default: {
            // 0x40343a
            v2 = 769;
            if (v1 != 119) {
                // 0x403582
                return 0;
            }
        }
        case 97: {
            // 0x403455
            v3 = v2;
            v4 = g74 | 2;
            // break -> 0x403458
            break;
        }
    }
    int32_t v5 = a2 + 1; // 0x40345b
    char v6 = *(char *)v5; // 0x40345b
    int32_t v7 = v5; // 0x403461
    int32_t v8 = 0; // 0x403461
    int32_t v9 = 0; // 0x403461
    int32_t v10 = v3; // 0x403461
    int32_t v11 = v4; // 0x403461
    if (v6 != 0) {
        int32_t v12 = v9;
        int32_t v13 = v8;
        int32_t v14; // 0x403417
        int32_t v15; // 0x403417
        if (v6 > 84) {
            switch (v6) {
                case 98: {
                    // 0x403536
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x403542
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x8000;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
                case 99: {
                    // 0x40351f
                    if (v12 != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x403524
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 | 0x4000;
                    // break -> 0x40345b
                    break;
                }
                case 110: {
                    // 0x403508
                    if (v12 != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x40350d
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 & -0x4001;
                    // break -> 0x40345b
                    break;
                }
                default: {
                    // 0x4034f6
                    if (v6 != 116) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x4034fb
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x403500
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x4000;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
            }
        } else {
            switch (v6) {
                case 84: {
                    // 0x4034d9
                    if ((v3 & 0x1000) != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x4034e2
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x1000;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
                case 43: {
                    // 0x4034c3
                    if ((v3 & 2) != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x4034c8
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 & -4 | 2;
                    v15 = v4 & -132 | 128;
                    // break -> 0x40345b
                    break;
                }
                case 68: {
                    // 0x4034b9
                    if ((v3 & 64) != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x4034be
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 64;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
                case 82: {
                    // 0x4034a4
                    if (v13 != 0) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x4034ad
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 16;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
                default: {
                    // 0x403488
                    if (v6 == 83 != (v13 == 0)) {
                        // break -> 0x40354a
                        break;
                    }
                    // 0x403498
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 32;
                    v15 = v4;
                    // break -> 0x40345b
                    break;
                }
            }
        }
        int32_t v16 = v15;
        int32_t v17 = v14;
        v7++;
        char v18 = *(char *)v7; // 0x40345b
        v10 = v17;
        v11 = v16;
        while (v18 != 0) {
            // 0x40346f
            v12 = v9;
            v13 = v8;
            int32_t v19 = v17;
            int32_t v20 = v16;
            char v21 = v18;
            if (v21 > 84) {
                switch (v21) {
                    case 98: {
                        // 0x403536
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x403542
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x8000;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                    case 99: {
                        // 0x40351f
                        if (v12 != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x403524
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 | 0x4000;
                        // break -> 0x40345b
                        break;
                    }
                    case 110: {
                        // 0x403508
                        if (v12 != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x40350d
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 & -0x4001;
                        // break -> 0x40345b
                        break;
                    }
                    default: {
                        // 0x4034f6
                        if (v21 != 116) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x4034fb
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x403500
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x4000;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                }
            } else {
                switch (v21) {
                    case 84: {
                        // 0x4034d9
                        if ((v19 & 0x1000) != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x4034e2
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x1000;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                    case 43: {
                        // 0x4034c3
                        if ((v19 & 2) != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x4034c8
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 & -4 | 2;
                        v15 = v20 & -132 | 128;
                        // break -> 0x40345b
                        break;
                    }
                    case 68: {
                        // 0x4034b9
                        if ((v19 & 64) != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x4034be
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 64;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                    case 82: {
                        // 0x4034a4
                        if (v13 != 0) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x4034ad
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 16;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                    default: {
                        // 0x403488
                        if (v21 == 83 != (v13 == 0)) {
                            // break -> 0x40354a
                            break;
                        }
                        // 0x403498
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 32;
                        v15 = v20;
                        // break -> 0x40345b
                        break;
                    }
                }
            }
            // 0x40345b
            v16 = v15;
            v17 = v14;
            v7++;
            v18 = *(char *)v7;
            v10 = v17;
            v11 = v16;
        }
    }
    uint32_t v22 = function_404ee8(a1, v10, a3, 420, (int32_t)&g112); // 0x403556
    int32_t result = 0; // 0x403562
    if (v22 >= 0) {
        // 0x403568
        g65++;
        *(int32_t *)(a4 + 12) = v11;
        *(int32_t *)(a4 + 4) = 0;
        *(int32_t *)a4 = 0;
        *(int32_t *)(a4 + 8) = 0;
        *(int32_t *)(a4 + 28) = 0;
        *(int32_t *)(a4 + 16) = v22;
        result = a4;
    }
    // 0x403582
    return result;
}

// Address range: 0x403587 - 0x4035ff
int32_t function_403587(void) {
    // 0x403587
    if (g104 < 1) {
        // 0x4035f8
        return 0;
    }
    int32_t v1 = g102; // 0x4035a1
    int32_t v2 = 0;
    int32_t v3 = *(int32_t *)v1; // 0x4035a3
    int32_t result; // 0x403587
    int32_t v4; // 0x4035b9
    while (v3 != 0) {
        // 0x4035a9
        if ((*(char *)(v3 + 12) & -125) == 0) {
            // 0x4035e2
            v4 = *(int32_t *)(4 * v2 + g102);
            result = 0;
            if (v4 == 0) {
                return result;
            } else {
                goto lab_0x4035e6;
            }
        }
        int32_t v5 = v2 + 1; // 0x4035af
        v1 += 4;
        if (v5 >= g104) {
            // 0x4035f8
            return 0;
        }
        v2 = v5;
        v3 = *(int32_t *)v1;
    }
    int32_t v6 = 4 * v2; // 0x4035c2
    *(int32_t *)(g102 + v6) = (int32_t)_malloc(32);
    int32_t v7 = *(int32_t *)(g102 + v6); // 0x4035d9
    v4 = v7;
    if (v7 == 0) {
        // 0x4035f8
        return 0;
    }
    goto lab_0x4035e6;
  lab_0x4035e6:
    // 0x4035e6
    *(int32_t *)(v4 + 16) = -1;
    *(int32_t *)(v4 + 4) = 0;
    *(int32_t *)(v4 + 12) = 0;
    *(int32_t *)(v4 + 8) = 0;
    *(int32_t *)v4 = 0;
    *(int32_t *)(v4 + 28) = 0;
    result = v4;
  lab_0x4035f8:
    // 0x4035f8
    return result;
}

// Address range: 0x4035ff - 0x40368c
int32_t function_4035ff(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x4035ff
    int32_t v1; // 0x4035ff
    if (function_404904(*(int32_t *)(a1 + 16), v1) == 0) {
        // 0x403688
        return 0;
    }
    int32_t v2 = &g70; // 0x403617
    if (a1 != (int32_t)&g25) {
        // 0x40361d
        v2 = (int32_t)&g70 + 4;
        if (a1 != (int32_t)&g26) {
            // 0x403688
            return 0;
        }
    }
    // 0x403628
    g65++;
    int16_t * v3 = (int16_t *)(a1 + 12); // 0x40362e
    if ((*v3 & 268) != 0) {
        // 0x403688
        return 0;
    }
    int32_t * v4 = (int32_t *)v2; // 0x403636
    int32_t v5 = *v4; // 0x403636
    int32_t v6 = v5; // 0x40364c
    if (v5 == 0) {
        int32_t * v7 = _malloc(0x1000); // 0x40364f
        v6 = (int32_t)v7;
        *v4 = v6;
        if (v7 == NULL) {
            int32_t v8 = a1 + 20; // 0x40365b
            *(int32_t *)(a1 + 8) = v8;
            *(int32_t *)a1 = v8;
            *(int32_t *)(a1 + 24) = 2;
            *(int32_t *)(a1 + 4) = 2;
            // 0x40367b
            *v3 = *v3 | 0x1102;
            return 1;
        }
    }
    // 0x40366e
    *(int32_t *)(a1 + 24) = 0x1000;
    *(int32_t *)(a1 + 8) = v6;
    *(int32_t *)a1 = v6;
    *(int32_t *)(a1 + 4) = 0x1000;
    // 0x40367b
    *v3 = *v3 | 0x1102;
    return 1;
}

// Address range: 0x40368c - 0x4036c9
int32_t function_40368c(int32_t a1, int32_t a2) {
    char * v1 = (char *)(a2 + 13);
    char v2 = *v1;
    int32_t result2; // 0x40368c
    if (a1 == 0) {
        // 0x4036b6
        result2 = a2;
        if ((v2 & 16) != 0) {
            // 0x4036c0
            result2 = function_40217a(a2);
        }
    } else {
        if ((v2 & 16) != 0) {
            int32_t result = function_40217a(a2); // 0x40369f
            *v1 = *v1 & -18;
            *(int32_t *)(a2 + 24) = 0;
            *(int32_t *)a2 = 0;
            *(int32_t *)(a2 + 8) = 0;
            return result;
        }
    }
    // 0x4036c7
    return result2;
}

// Address range: 0x4036c9 - 0x403dea
int32_t function_4036c9(int32_t a1, int32_t a2, int32_t * a3) {
    int32_t v1 = (int32_t)a3;
    char v2 = *(char *)a2; // 0x4036da
    int32_t result = 0; // bp-24, 0x4036e2
    if (v2 == 0) {
        // 0x403de2
        return 0;
    }
    int32_t v3 = &v1;
    char v4; // bp-588, 0x4036c9
    int32_t v5 = &v4;
    int32_t v6; // bp-76, 0x4036c9
    int32_t v7 = &v6;
    int32_t v8 = &result;
    char v9; // bp-26, 0x4036c9
    int32_t v10 = &v9;
    int32_t v11; // bp-60, 0x4036c9
    int32_t v12 = &v11;
    int32_t v13 = a2; // 0x4036c9
    int32_t v14 = 0; // 0x4036c9
    int32_t v15; // bp-600, 0x4036c9
    int32_t v16 = &v15; // 0x4036c9
    char v17 = v2; // 0x403dd4
    int32_t v18 = 0; // 0x4036c9
    int32_t v19; // 0x4036c9
    char v20; // 0x4036c9
    int32_t v21; // 0x4036c9
    int32_t v22; // 0x4036c9
    int32_t v23; // 0x4036c9
    char * v24; // 0x4036c9
    int32_t v25; // 0x4036c9
    char * v26; // 0x4036c9
    int16_t (*v27)[7]; // 0x4036c9
    int16_t (*v28)[7]; // 0x4036c9
    int16_t (*v29)[7]; // 0x4036c9
    int16_t (*v30)[7]; // 0x4036c9
    int32_t v31; // 0x4036c9
    int32_t v32; // 0x4036c9
    int32_t v33; // 0x4036c9
    int32_t v34; // 0x4036c9
    int32_t v35; // 0x4036c9
    int32_t v36; // 0x4036c9
    int32_t v37; // 0x4036c9
    int32_t v38; // 0x4036c9
    int32_t v39; // 0x4036c9
    int32_t v40; // 0x4036c9
    int32_t v41; // 0x4036c9
    int32_t v42; // 0x4036c9
    int32_t v43; // 0x4036c9
    int32_t v44; // 0x4036c9
    int32_t v45; // 0x4036c9
    int32_t v46; // 0x4036c9
    int32_t v47; // 0x4036c9
    int32_t v48; // 0x4036c9
    int32_t v49; // 0x4036c9
    int32_t v50; // 0x4036c9
    int32_t v51; // 0x4036c9
    int32_t v52; // 0x4036c9
    int32_t v53; // 0x4036c9
    int32_t v54; // 0x4036c9
    int32_t v55; // 0x4036c9
    int32_t v56; // 0x4036c9
    int32_t v57; // 0x4036c9
    int32_t v58; // 0x4036c9
    int32_t v59; // 0x4036c9
    int32_t v60; // 0x4036c9
    int32_t v61; // 0x4036c9
    int32_t v62; // 0x4036c9
    int32_t v63; // 0x4036c9
    int32_t v64; // 0x4036c9
    int32_t v65; // 0x4036c9
    char v66; // 0x4036c9
    char v67; // 0x4036c9
    char v68; // 0x4036c9
    char v69; // 0x4036c9
    char v70; // 0x4036c9
    char v71; // 0x4036c9
    char v72; // 0x4036c9
    int16_t v73; // 0x4036c9
    int16_t v74; // 0x4036c9
    int16_t v75; // 0x4036c9
    int16_t v76; // 0x4036c9
    int16_t v77; // 0x4036c9
    int32_t v78; // 0x4036c9
    int32_t v79; // 0x4039ef
    int32_t * v80; // 0x4039ef
    while (true) {
      lab_0x403706:
        // 0x403706
        v31 = v18;
        v35 = v34;
        v62 = v61;
        v53 = v52;
        v46 = v45;
        v41 = v40;
        v74 = v73;
        v49 = v48;
        v67 = v66;
        v28 = v27;
        v57 = v56;
        v20 = v17;
        v22 = v16;
        v25 = v13;
        int32_t v81 = 0; // 0x403709
        if (v20 <= 120) {
            char v82 = *(char *)((int32_t)v20 + 0x40609c); // 0x403713
            v81 = v82 & 15;
        }
        // 0x403720
        v19 = v20;
        v24 = (char *)(v25 + 1);
        char v83 = *(char *)(v14 + (int32_t)&g1 + 8 * v81); // 0x403720
        int32_t v84 = v83 / 16; // 0x403728
        g117 = v84;
        v18 = v31;
        v39 = v35;
        v14 = v84;
        v65 = v62;
        v55 = v53;
        v47 = v46;
        v44 = v41;
        v77 = v74;
        v51 = v49;
        v72 = v67;
        v26 = v24;
        v30 = v28;
        v60 = v57;
        v16 = v22;
        switch (v84) {
            case 0: {
                goto lab_0x403868;
            }
            case 1: {
                // 0x40373e
                v18 = v31;
                v39 = -1;
                v14 = 1;
                v65 = 0;
                v55 = 0;
                v47 = 0;
                v44 = 0;
                v77 = 0;
                v51 = 0;
                v72 = v67;
                v26 = v24;
                v30 = v28;
                v60 = v57;
                v16 = v22;
                goto lab_0x403dd1;
            }
            case 2: {
                switch (0x1000000 * v19) {
                    case 0x20000000: {
                        // 0x40379c
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 2;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x403dd1
                        break;
                    }
                    case 0x23000000: {
                        // 0x403793
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | -128;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x403dd1
                        break;
                    }
                    case 0x2b000000: {
                        // 0x40378a
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 1;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x403dd1
                        break;
                    }
                    default: {
                        int32_t v85 = (int32_t)v20 - 45; // 0x40376c
                        if (v85 == 0) {
                            // 0x403781
                            v18 = v31;
                            v39 = v35;
                            v14 = 2;
                            v65 = v62;
                            v55 = v53;
                            v47 = v46;
                            v44 = v41;
                            v77 = v74 | 4;
                            v51 = v49;
                            v72 = v67;
                            v26 = v24;
                            v30 = v28;
                            v60 = v57;
                            v16 = v22;
                        } else {
                            // 0x40376f
                            v18 = v31;
                            v39 = v35;
                            v14 = 2;
                            v65 = v62;
                            v55 = v53;
                            v47 = v46;
                            v44 = v41;
                            v77 = v85 != 3 ? v74 : v74 | 8;
                            v51 = v49;
                            v72 = v67;
                            v26 = v24;
                            v30 = v28;
                            v60 = v57;
                            v16 = v22;
                        }
                        // break -> 0x403dd1
                        break;
                    }
                }
                goto lab_0x403dd1;
            }
            case 3: {
                if (v20 != 42) {
                    // 0x4037cd
                    v18 = v31;
                    v39 = v35;
                    v14 = 3;
                    v65 = v62;
                    v55 = v53;
                    v47 = (int32_t)v20 - 48 + 10 * v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                } else {
                    // 0x4037aa
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v86 = function_403ea8(3); // 0x4037ae
                    v18 = v31;
                    v39 = v35;
                    v14 = 3;
                    v65 = v62;
                    v55 = v53;
                    v47 = v86;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                    if (v86 < 0) {
                        // 0x4037bf
                        v18 = v31;
                        v39 = v35;
                        v14 = 3;
                        v65 = v62;
                        v55 = v53;
                        v47 = -v86;
                        v44 = v41;
                        v77 = v74 | 4;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                    }
                }
                goto lab_0x403dd1;
            }
            case 4: {
                // 0x4037dc
                v18 = v31;
                v39 = 0;
                v14 = 4;
                v65 = v62;
                v55 = v53;
                v47 = v46;
                v44 = v41;
                v77 = v74;
                v51 = v49;
                v72 = v67;
                v26 = v24;
                v30 = v28;
                v60 = v57;
                v16 = v22;
                goto lab_0x403dd1;
            }
            case 5: {
                if (v20 != 42) {
                    // 0x403807
                    v18 = v31;
                    v39 = (int32_t)v20 - 48 + 10 * v35;
                    v14 = 5;
                    v65 = v62;
                    v55 = v53;
                    v47 = v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                } else {
                    // 0x4037e9
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v87 = function_403ea8(5); // 0x4037ed
                    v18 = v31;
                    v39 = v87 >= 0 ? v87 : -1;
                    v14 = 5;
                    v65 = v62;
                    v55 = v53;
                    v47 = v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                }
                goto lab_0x403dd1;
            }
            case 6: {
                switch (v20) {
                    case 73: {
                        // 0x40384c
                        if (*v24 != 54) {
                            goto lab_0x403868;
                        } else {
                            // 0x403851
                            if (*(char *)(v25 + 2) != 52) {
                                goto lab_0x403868;
                            } else {
                                // 0x403857
                                v18 = v31;
                                v39 = v35;
                                v14 = 6;
                                v65 = v62;
                                v55 = v53;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67 | -128;
                                v26 = (char *)(v25 + 3);
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                                goto lab_0x403dd1;
                            }
                        }
                    }
                    case 104: {
                        // 0x403843
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 32;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x403dd1;
                    }
                    case 108: {
                        // 0x40383a
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 16;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x403dd1;
                    }
                    default: {
                        char v88 = v20 != 119 ? v67 : v67 | 8;
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74;
                        v51 = v49;
                        v72 = v88;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x403dd1;
                    }
                }
            }
            case 7: {
                int32_t v89 = 0x1000000 * v19;
                if (v89 > 0x67000000) {
                    // 0x403ad4
                    v68 = v67;
                    v36 = 8;
                    v78 = 7;
                    v32 = 10;
                    v37 = v35;
                    v42 = v41;
                    v75 = v74;
                    v70 = v67;
                    v58 = v57;
                    switch ((char)((v89 - 0x69000000) / 0x1000000)) {
                        case 0: {
                            goto lab_0x403bae;
                        }
                        case 5: {
                            // 0x403b84
                            *(int32_t *)(v22 - 4) = v3;
                            int32_t v90 = function_403ea8(7); // 0x403b88
                            if ((v74 & 32) == 0) {
                                // 0x403b9d
                                *(int32_t *)v90 = result;
                                v18 = v31;
                                v39 = v35;
                                v14 = 7;
                                v65 = v62;
                                v55 = 1;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67;
                                v26 = v24;
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                            } else {
                                // 0x403b94
                                *(int16_t *)v90 = (int16_t)result;
                                v18 = v31;
                                v39 = v35;
                                v14 = 7;
                                v65 = v62;
                                v55 = 1;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67;
                                v26 = v24;
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                            }
                            goto lab_0x403dd1;
                        }
                        case 6: {
                            // 0x403b71
                            v32 = 8;
                            v37 = v35;
                            v42 = v41;
                            v75 = v74;
                            v70 = (char)(v74 / 64) & 2 | v67;
                            v58 = v57;
                            goto lab_0x403bb9;
                        }
                        case 7: {
                            goto lab_0x403b4f;
                        }
                        case 10: {
                            goto lab_0x4038f6;
                        }
                        case 12: {
                            goto lab_0x403bb9;
                        }
                        default: {
                            // 0x403b01
                            v36 = v35;
                            v78 = 39;
                            if (v20 != 120) {
                                goto lab_0x403cd3;
                            } else {
                                goto lab_0x403b4f;
                            }
                        }
                    }
                } else {
                    // 0x4038b8
                    v63 = v62;
                    v21 = v19;
                    if (v89 > 0x64000000) {
                        goto lab_0x403957;
                    } else {
                        int32_t v91 = v20; // 0x4038ac
                        if (v89 > 0x58000000) {
                            if (v20 == 90) {
                                // 0x4039ec
                                v79 = v22 - 4;
                                v80 = (int32_t *)v79;
                                *v80 = v3;
                                int32_t v92 = function_403ea8(7); // 0x4039f0
                                if (v92 == 0) {
                                    goto lab_0x403a2d;
                                } else {
                                    int32_t v93 = *(int32_t *)(v92 + 4); // 0x4039fa
                                    if (v93 == 0) {
                                        goto lab_0x403a2d;
                                    } else {
                                        if ((v67 & 8) == 0) {
                                            int16_t v94 = *(int16_t *)v92; // 0x403a25
                                            v33 = v94;
                                            v38 = v35;
                                            v64 = v62;
                                            v54 = v53;
                                            v43 = v41;
                                            v76 = v74;
                                            v50 = 0;
                                            v71 = v67;
                                            v29 = (int16_t (*)[7])v93;
                                            v59 = v57;
                                            v23 = v22;
                                        } else {
                                            int16_t v95 = *(int16_t *)v92; // 0x403a07
                                            v33 = (int32_t)v95 / 2;
                                            v38 = v35;
                                            v64 = v62;
                                            v54 = v53;
                                            v43 = v41;
                                            v76 = v74;
                                            v50 = 1;
                                            v71 = v67;
                                            v29 = (int16_t (*)[7])v93;
                                            v59 = v57;
                                            v23 = v22;
                                        }
                                        goto lab_0x403cd3;
                                    }
                                }
                            } else {
                                // 0x4039ba
                                v69 = v67;
                                v33 = v31;
                                v38 = v35;
                                v64 = v62;
                                v54 = v53;
                                v43 = v41;
                                v76 = v74;
                                v50 = v49;
                                v71 = v67;
                                v29 = v28;
                                v59 = v57;
                                v23 = v22;
                                switch (v91) {
                                    case 99: {
                                        goto lab_0x403984;
                                    }
                                    case 100: {
                                        goto lab_0x403bae;
                                    }
                                    default: {
                                        goto lab_0x403cd3;
                                    }
                                }
                            }
                        } else {
                            // 0x4038ca
                            v36 = v35;
                            v78 = 7;
                            switch (v89) {
                                case 0x58000000: {
                                    goto lab_0x403b4f;
                                }
                                case 0x43000000: {
                                    char v96 = (v74 & 2096) != 0 ? v67 : v67 | 8;
                                    v69 = v96;
                                    goto lab_0x403984;
                                }
                                case 0x45000000: {
                                    // 0x40394d
                                    v63 = 1;
                                    v21 = v20 + 32;
                                    goto lab_0x403957;
                                }
                                default: {
                                    int32_t v97 = v91 - 71; // 0x4038de
                                    if (v97 == 0) {
                                        // 0x40394d
                                        v63 = 1;
                                        v21 = v20 + 32;
                                        goto lab_0x403957;
                                    } else {
                                        // 0x4038e1
                                        v33 = v31;
                                        v38 = v35;
                                        v64 = v62;
                                        v54 = v53;
                                        v43 = v41;
                                        v76 = v74;
                                        v50 = v49;
                                        v71 = v67;
                                        v29 = v28;
                                        v59 = v57;
                                        v23 = v22;
                                        if (v97 != 12) {
                                            goto lab_0x403cd3;
                                        } else {
                                            char v98 = (v74 & 2096) != 0 ? v67 : v67 | 8;
                                            v68 = v98;
                                            goto lab_0x4038f6;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            default: {
                goto lab_0x403dd1;
            }
        }
    }
  lab_0x403dd1_2:
    // 0x403de2
    return result;
  lab_0x403868:;
    int32_t * v99 = (int32_t *)(v22 - 4);
    int32_t * v100; // 0x4036c9
    int32_t * v101; // 0x4036c9
    int32_t v102; // 0x4036c9
    char * v103; // 0x4036c9
    if (*(char *)(*(int32_t *)0x407908 + (2 * v19 || 1)) > -1) {
        // 0x403868
        v101 = (int32_t *)(v22 - 12);
        v100 = (int32_t *)(v22 - 8);
        v103 = v24;
        v102 = v19;
    } else {
        // 0x40387b
        *v99 = v8;
        int32_t * v104 = (int32_t *)(v22 - 8);
        *v104 = a1;
        int32_t * v105 = (int32_t *)(v22 - 12);
        *v105 = (int32_t)v20;
        function_403e0a(0, (int32_t)&g112, (int32_t)&g112);
        v101 = v105;
        v100 = v104;
        v103 = (char *)(v25 + 2);
        v102 = (int32_t)*v24;
    }
    // 0x403894
    *v99 = v8;
    *v100 = a1;
    *v101 = 0x1000000 * v102 / 0x1000000;
    function_403e0a((int32_t)v103, (int32_t)&g112, (int32_t)&g112);
    v18 = v31;
    v39 = v35;
    v14 = 0;
    v65 = v62;
    v55 = v53;
    v47 = v46;
    v44 = v41;
    v77 = v74;
    v51 = 0;
    v72 = v67;
    v26 = v103;
    v30 = v28;
    v60 = v57;
    v16 = v22;
    goto lab_0x403dd1;
  lab_0x403dd1:
    // 0x403dd1
    v17 = *v26;
    if (v17 == 0) {
        // break -> 0x403dd1
        goto lab_0x403dd1_2;
    }
    // 0x4036f5
    v13 = (int32_t)v26;
    v56 = v60;
    v27 = v30;
    v66 = v72;
    v48 = v51;
    v73 = v77;
    v40 = v44;
    v45 = v47;
    v52 = v55;
    v61 = v65;
    v34 = v39;
    if (result < 0) {
        // 0x403de2
        return result;
    }
    goto lab_0x403706;
  lab_0x403bae:
    // 0x403bae
    v32 = 10;
    v37 = v35;
    v42 = v41;
    v75 = v74 | 64;
    v70 = v67;
    v58 = v57;
    goto lab_0x403bb9;
  lab_0x403b4f:;
    int32_t v198 = v78;
    int32_t v199 = v36;
    v32 = 16;
    v37 = v199;
    v42 = v41;
    v75 = v74;
    v70 = v67;
    v58 = v198;
    if ((char)v74 <= 255) {
        // 0x403b5c
        v9 = 48;
        v32 = 16;
        v37 = v199;
        v42 = 2;
        v75 = v74;
        v70 = v67;
        v58 = v198;
    }
    goto lab_0x403bb9;
  lab_0x4038f6:;
    char v200 = v68;
    int32_t v201 = v35 != -1 ? v35 : 0x7fffffff;
    *(int32_t *)(v22 - 4) = v3;
    int32_t v202 = function_403ea8((int32_t)&g112); // 0x403907
    int16_t (*v203)[7] = (int16_t (*)[7])v202; // 0x403915
    if ((v74 & 2064) == 0) {
        // 0x403b1c
        if (v201 != 0) {
            int32_t v204; // 0x4036c9
            while (*(char *)v204 != 0) {
                // 0x403b37
                int32_t v205; // 0x4036c9
                int32_t v206 = v205;
                int32_t v207 = v206 - 1;
                int32_t v208; // 0x4036c9
                int32_t v209 = v208 + 1; // 0x403b37
                v205 = v207;
                v204 = v209;
                if (v207 == 0) {
                    // break -> 0x403b3a
                    break;
                }
                v208 = v204;
                char v210 = *(char *)v208; // 0x403b32
            }
        }
        // 0x403b3a
        v33 = 0;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v200;
        v29 = v202 != 0 ? v203 : (int16_t (*)[7])g32;
        v59 = v57;
        v23 = v22;
    } else {
        int32_t v211 = v202 != 0 ? v202 : (int32_t)g33;
        int32_t v212 = v201; // 0x403939
        int32_t v213 = v211; // 0x403939
        int32_t v214 = v211; // 0x403939
        if (v201 != 0) {
            int32_t v215 = v213;
            v214 = v215;
            while (*(int16_t *)v215 != 0) {
                int32_t v216 = v212 - 1;
                int32_t v217 = v215 + 2; // 0x40394a
                v212 = v216;
                v213 = v217;
                v214 = v217;
                if (v216 == 0) {
                    // break -> 0x403b13
                    break;
                }
                v215 = v213;
                v214 = v215;
            }
        }
        // 0x403b13
        v33 = (v214 - v211) / 2;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = 1;
        v71 = v200;
        v29 = v202 != 0 ? v203 : g33;
        v59 = v57;
        v23 = v22;
    }
    goto lab_0x403cd3;
  lab_0x403bb9:;
    int32_t v106 = v58;
    char v107 = v70;
    int16_t v108 = v75;
    int32_t v109 = v37;
    int32_t v110 = v32;
    int16_t v111; // 0x4036c9
    int32_t v112; // 0x4036c9
    int32_t v113; // 0x4036c9
    int32_t v114; // 0x4036c9
    int32_t v115; // 0x4036c9
    char v116; // 0x4036c9
    int32_t v117; // 0x4036c9
    int16_t v118; // 0x4036c9
    if (v107 > -1) {
        // 0x403bcb
        v118 = v108 & 64;
        *(int32_t *)(v22 - 4) = v3;
        int32_t v119 = function_403ea8(v110);
        if ((v108 & 32) == 0) {
            // 0x403bf2
            v112 = v119;
            v116 = v107;
            v115 = v119;
            v117 = 0;
            if (v118 == 0) {
                goto lab_0x403c31;
            } else {
                goto lab_0x403be4;
            }
        } else {
            if (v118 == 0) {
                // 0x403be7
                v112 = v119 & 0xffff;
            } else {
                // 0x403bdb
                v112 = 0x10000 * v119 / 0x10000;
            }
            goto lab_0x403be4;
        }
    } else {
        // 0x403bbf
        *(int32_t *)(v22 - 4) = v3;
        v111 = v108 & 64;
        v113 = function_403eb5(v110);
        v114 = 0;
        goto lab_0x403c0c;
    }
  lab_0x403957:;
    int32_t v120 = v21;
    int32_t v121 = 6; // 0x403966
    if (v35 >= 0) {
        // 0x403a3b
        v121 = v35;
        if (v35 == 0) {
            // 0x403a3d
            v121 = v120 != 103 ? v35 : 1;
        }
    }
    int32_t v122 = v1; // 0x403a49
    int32_t v123 = v22 - 4; // 0x403a4c
    int32_t * v124 = (int32_t *)v123; // 0x403a4c
    *v124 = v63;
    v1 = v122 + 8;
    *(int32_t *)(v22 - 8) = v121;
    v6 = *(int32_t *)v122;
    *(int32_t *)(v22 - 12) = 0x1000000 * v120 / 0x1000000;
    *(int32_t *)(v22 - 16) = v5;
    *(int32_t *)(v22 - 20) = v7;
    function_405a8f();
    if ((char)v74 <= -1 && v121 == 0) {
        // 0x403a8d
        *v124 = v5;
        function_405a8f();
    }
    if ((char)v74 > -1 == v120 == 103) {
        // 0x403aa4
        *v124 = v5;
        function_405a8f();
    }
    // 0x403ab2
    int32_t v125; // bp-587, 0x4036c9
    int16_t (*v126)[7] = v4 != 45 ? (int16_t (*)[7])&v4 : (int16_t (*)[7])&v125;
    *v124 = v4 != 45 ? v5 : (int32_t)&v125;
    int32_t v127 = v121; // 0x403ac8
    int32_t v128 = v63; // 0x403ac8
    int16_t v129 = v74 | 64; // 0x403ac8
    char v130 = v67 | (char)(v4 == 45); // 0x403ac8
    int16_t (*v131)[7] = v126; // 0x403ac8
    int32_t v132 = v123; // 0x403ac8
    goto lab_0x403ac9;
  lab_0x403cd3:;
    int32_t v133 = v23;
    int32_t v134 = v59;
    int16_t (*v135)[7] = v29;
    char v136 = v71;
    int32_t v137 = v50;
    int16_t v138 = v76;
    int32_t v139 = v43;
    int32_t v140 = v54;
    int32_t v141 = v64;
    int32_t v142 = v38;
    int32_t v143 = v33;
    v18 = v143;
    v39 = v142;
    v14 = 7;
    v65 = v141;
    v55 = v140;
    v47 = v46;
    v44 = v139;
    v77 = v138;
    v51 = v137;
    v72 = v136;
    v26 = v24;
    v30 = v135;
    v60 = v134;
    v16 = v133;
    if (v140 == 0) {
        int32_t v144 = v138; // 0x403cdd
        int32_t v145 = v139; // 0x403ce3
        if ((v138 & 64) != 0) {
            if ((v144 & 256) == 0) {
                if ((v144 & 1) == 0) {
                    // 0x403cfb
                    v145 = v139;
                    if ((v144 & 2) != 0) {
                        // 0x403d00
                        v9 = 32;
                        v145 = 1;
                    }
                } else {
                    // 0x403cf5
                    v9 = 43;
                    v145 = 1;
                }
            } else {
                // 0x403cea
                v9 = 45;
                v145 = 1;
            }
        }
        int32_t v146 = v145;
        int32_t v147 = v46 - v146 - v143; // 0x403d11
        int32_t * v148 = (int32_t *)(v133 - 4);
        int32_t * v149; // 0x4036c9
        int32_t * v150; // 0x4036c9
        int32_t * v151; // 0x4036c9
        if ((v144 & 12) != 0) {
            // 0x403d0b
            v151 = (int32_t *)(v133 - 16);
            v150 = (int32_t *)(v133 - 12);
            v149 = (int32_t *)(v133 - 8);
        } else {
            // 0x403d19
            *v148 = v8;
            int32_t * v152 = (int32_t *)(v133 - 8);
            *v152 = a1;
            int32_t * v153 = (int32_t *)(v133 - 12);
            *v153 = v147;
            int32_t * v154 = (int32_t *)(v133 - 16);
            *v154 = 32;
            function_403e3f((int32_t)&g112, (int32_t)&g112);
            v151 = v154;
            v150 = v153;
            v149 = v152;
        }
        int32_t * v155 = v149;
        int32_t * v156 = v150;
        int32_t * v157 = v151;
        *v148 = v8;
        *v155 = a1;
        *v156 = v146;
        *v157 = v10;
        function_403e70((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        if ((v144 & 8) != 0) {
            if ((v144 & 4) == 0) {
                // 0x403d4b
                *v148 = v8;
                *v155 = a1;
                *v156 = v147;
                *v157 = 48;
                function_403e3f((int32_t)&g112, (int32_t)&g112);
            }
        }
        if (v143 < 1 || v137 == 0) {
            // 0x403da4
            *v148 = v8;
            *v155 = a1;
            *v156 = v143;
            *v157 = (int32_t)v135;
            function_403e70((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        } else {
            int32_t v158 = (int32_t)v135;
            int32_t v159 = v143;
            *v148 = v159 & -0x10000 | (int32_t)*(int16_t *)v158;
            *v155 = v12;
            int32_t v160 = function_40522b((int32_t)&g112, (int32_t)&g112); // 0x403d7c
            while (v160 >= 1) {
                int32_t v161 = v159 - 1;
                *v148 = v8;
                *v155 = a1;
                *v156 = v160;
                *v157 = v12;
                function_403e70((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
                int32_t v162 = v158 + 2; // 0x403da0
                if (v161 == 0) {
                    // break -> 0x403db9
                    break;
                }
                v158 = v162;
                v159 = v161;
                *v148 = v159 & -0x10000 | (int32_t)*(int16_t *)v158;
                *v155 = v12;
                v160 = function_40522b((int32_t)&g112, (int32_t)&g112);
            }
        }
        // 0x403db9
        v18 = v143;
        v39 = v142;
        v14 = 7;
        v65 = v141;
        v55 = v140;
        v47 = v46;
        v44 = v146;
        v77 = v138;
        v51 = v137;
        v72 = v136;
        v26 = v24;
        v30 = v135;
        v60 = v134;
        v16 = v133;
        if ((v138 & 4) != 0) {
            // 0x403dbf
            *v148 = v8;
            *v155 = a1;
            *v156 = v147;
            *v157 = 32;
            function_403e3f((int32_t)&g112, (int32_t)&g112);
            v18 = v143;
            v39 = v142;
            v14 = 7;
            v65 = v141;
            v55 = v140;
            v47 = v46;
            v44 = v146;
            v77 = v138;
            v51 = v137;
            v72 = v136;
            v26 = v24;
            v30 = v135;
            v60 = v134;
            v16 = v133;
        }
    }
    goto lab_0x403dd1;
  lab_0x403ac9:
    // 0x403ac9
    v33 = function_4051b0((int32_t)&g112);
    v38 = v127;
    v64 = v128;
    v54 = v53;
    v43 = v41;
    v76 = v129;
    v50 = v49;
    v71 = v130;
    v29 = v131;
    v59 = v57;
    v23 = v132 + 4;
    goto lab_0x403cd3;
  lab_0x403c0c:;
    int32_t v163 = v114;
    int32_t v164 = v113;
    v116 = v107;
    v115 = v164;
    v117 = v163;
    if (v111 != 0) {
        // 0x403c12
        v116 = v107;
        v115 = v164;
        v117 = v163;
        if (v163 < 0 && v163 >= 0 != v163 != 0) {
            // 0x403c1c
            v116 = v107 | 1;
            v115 = -v164;
            v117 = -((v163 + (int32_t)(v164 != 0)));
        }
    }
    goto lab_0x403c31;
  lab_0x403c31:;
    char v165 = v116;
    int32_t v166 = v165 <= -1 ? v117 : 0;
    int32_t v167 = v109 >= 0 ? v109 : 1;
    int32_t v168 = v167 - 1; // 0x403c60
    int32_t v169 = v168; // 0x403c65
    int32_t v170 = v166; // 0x403c65
    int32_t v171 = v115; // 0x403c65
    int32_t v172 = v22; // 0x403c65
    int32_t v173; // bp-77, 0x4036c9
    int16_t (*v174)[7] = (int16_t (*)[7])&v173; // 0x403c65
    int16_t (*v175)[7] = (int16_t (*)[7])&v173; // 0x403c65
    int32_t v176 = v22; // 0x403c65
    int32_t v177 = v168; // 0x403c65
    if (v167 >= 0 != v167 != 0 != ((v166 || v115) == 0)) {
        int32_t v178 = v169;
        *(int32_t *)(v172 - 4) = 0;
        *(int32_t *)(v172 - 8) = v110;
        *(int32_t *)(v172 - 12) = v170;
        *(int32_t *)(v172 - 16) = v171;
        int32_t v179 = __aullrem(v110, 0); // 0x403c7b
        *(int32_t *)(v172 - 20) = 0;
        int32_t v180 = v179 + 48; // 0x403c85
        *(int32_t *)(v172 - 24) = v110;
        *(int32_t *)(v172 - 28) = v170;
        int32_t v181 = v172 - 32; // 0x403c8c
        *(int32_t *)v181 = v171;
        int32_t v182 = __aulldiv(); // 0x403c8d
        int32_t v183 = v180 < 58 ? 0 : v106;
        int16_t (*v184)[7] = (int16_t (*)[7])((int32_t)v174 - 1);
        *(char *)v174 = (char)(v183 + v180);
        int32_t v185 = v178 - 1; // 0x403c60
        v170 = 0;
        v171 = v182;
        v172 = v181;
        v174 = v184;
        v175 = v184;
        v176 = v181;
        v177 = v185;
        while (v178 >= 0 != v178 != 0 != (v182 == 0)) {
            // 0x403c6d
            v178 = v185;
            *(int32_t *)(v172 - 4) = 0;
            *(int32_t *)(v172 - 8) = v110;
            *(int32_t *)(v172 - 12) = v170;
            *(int32_t *)(v172 - 16) = v171;
            v179 = __aullrem(v110, 0);
            *(int32_t *)(v172 - 20) = 0;
            v180 = v179 + 48;
            *(int32_t *)(v172 - 24) = v110;
            *(int32_t *)(v172 - 28) = v170;
            v181 = v172 - 32;
            *(int32_t *)v181 = v171;
            v182 = __aulldiv();
            v183 = v180 < 58 ? 0 : v106;
            v184 = (int16_t (*)[7])((int32_t)v174 - 1);
            *(char *)v174 = (char)(v183 + v180);
            v185 = v178 - 1;
            v170 = 0;
            v171 = v182;
            v172 = v181;
            v174 = v184;
            v175 = v184;
            v176 = v181;
            v177 = v185;
        }
    }
    int16_t v186 = v109 >= 0 ? v108 & -9 : v108;
    int32_t v187 = (v166 | v115) != 0 ? v42 : 0;
    int32_t v188 = v177;
    int32_t v189 = v176;
    int16_t (*v190)[7] = v175;
    int32_t v191 = (int32_t)v190; // 0x403cab
    int32_t v192 = (int32_t)&v173 - v191; // 0x403cab
    int32_t v193 = v191 + 1; // 0x403cae
    int16_t (*v194)[7] = (int16_t (*)[7])v193; // 0x403cae
    v33 = v192;
    v38 = v188;
    v64 = v62;
    v54 = v53;
    v43 = v187;
    v76 = v186;
    v50 = v49;
    v71 = v165;
    v29 = v194;
    v59 = v106;
    v23 = v189;
    if ((v165 & 2) != 0) {
        // 0x403cba
        v33 = v192;
        v38 = v188;
        v64 = v62;
        v54 = v53;
        v43 = v187;
        v76 = v186;
        v50 = v49;
        v71 = v165;
        v29 = v194;
        v59 = v106;
        v23 = v189;
        if (v192 != 0 != (*(char *)v193 == 48)) {
            // 0x403cc6
            *(char *)v190 = 48;
            v33 = v192 + 1;
            v38 = v188;
            v64 = v62;
            v54 = v53;
            v43 = v187;
            v76 = v186;
            v50 = v49;
            v71 = v165;
            v29 = v190;
            v59 = v106;
            v23 = v189;
        }
    }
    goto lab_0x403cd3;
  lab_0x403be4:
    // 0x403be4
    v111 = v118;
    v113 = v112;
    v114 = v112 >> 31;
    goto lab_0x403c0c;
  lab_0x403a2d:;
    char (*v195)[7] = g32; // 0x403a2d
    *v80 = (int32_t)v195;
    v127 = v35;
    v128 = v62;
    v129 = v74;
    v130 = v67;
    v131 = (int16_t (*)[7])v195;
    v132 = v79;
    goto lab_0x403ac9;
  lab_0x403984:;
    char v196 = v69;
    *(int32_t *)(v22 - 4) = v3;
    if ((v74 & 2064) == 0) {
        // 0x4039cb
        v4 = function_403ea8((int32_t)&g112);
        v33 = 1;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v196;
        v29 = (int16_t (*)[7])&v4;
        v59 = v57;
        v23 = v22;
    } else {
        // 0x403990
        *(int32_t *)(v22 - 8) = function_403ec5((int32_t)&g112);
        *(int32_t *)(v22 - 12) = v5;
        int32_t v197 = function_40522b((int32_t)&g112, (int32_t)&g112); // 0x40399d
        v33 = v197;
        v38 = v35;
        v64 = v62;
        v54 = v197 >= 0 ? v53 : 1;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v196;
        v29 = (int16_t (*)[7])&v4;
        v59 = v57;
        v23 = v22;
    }
    goto lab_0x403cd3;
}

// Address range: 0x403e0a - 0x403e3f
int32_t function_403e0a(int32_t a1, int32_t a2, int32_t result) {
    int32_t v1 = 0x1000000 * a1 / 0x1000000;
    int32_t * v2 = (int32_t *)(a2 + 4); // 0x403e10
    uint32_t v3 = *v2 - 1; // 0x403e10
    *v2 = v3;
    int32_t * v4; // 0x403e0a
    if (v3 >= 0) {
        int32_t * v5 = (int32_t *)a2; // 0x403e15
        *(char *)*v5 = (char)v1;
        *v5 = *v5 + 1;
        // 0x403e3b
        v4 = (int32_t *)result;
        *v4 = *v4 + 1;
        return result;
    }
    int32_t * v6 = (int32_t *)result;
    if (function_401e7d(v1, a2) == -1) {
        // 0x403e36
        *v6 = -1;
        return result;
    }
    // 0x403e3b
    v4 = v6;
    *v4 = *v4 + 1;
    return result;
}

// Address range: 0x403e3f - 0x403e70
int32_t function_403e3f(int32_t result, int32_t a2) {
    // 0x403e3f
    if (result < 1) {
        // 0x403e6d
        return result;
    }
    // 0x403e50
    int32_t v1; // bp-8, 0x403e3f
    int32_t v2 = &v1; // 0x403e40
    int32_t v3 = result;
    *(int32_t *)(v2 - 4) = a2;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
    *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
    int32_t v4 = function_403e0a((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x403e59
    int32_t result2 = v4; // 0x403e64
    while (*(int32_t *)a2 != -1) {
        // 0x403e66
        v3--;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x403e6d
            break;
        }
        *(int32_t *)(v2 - 4) = a2;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
        *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
        v4 = function_403e0a((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        result2 = v4;
    }
    // 0x403e6d
    return result2;
}

// Address range: 0x403e70 - 0x403ea8
int32_t function_403e70(int32_t a1, int32_t result, int32_t a3) {
    // 0x403e70
    if (result < 1) {
        // 0x403ea4
        return result;
    }
    // 0x403e86
    int32_t v1; // bp-12, 0x403e70
    int32_t v2 = &v1; // 0x403e79
    int32_t v3 = result;
    int32_t v4 = a1; // 0x403e70
    *(int32_t *)(v2 - 4) = a3;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
    *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
    int32_t v5 = function_403e0a((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x403e90
    int32_t result2 = v5; // 0x403e9b
    while (*(int32_t *)a3 != -1) {
        // 0x403e9d
        v3--;
        v4++;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x403ea4
            break;
        }
        *(int32_t *)(v2 - 4) = a3;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
        *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
        v5 = function_403e0a((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        result2 = v5;
    }
    // 0x403ea4
    return result2;
}

// Address range: 0x403ea8 - 0x403eb5
int32_t function_403ea8(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x403eac
    int32_t v2 = *v1; // 0x403eac
    *v1 = v2 + 4;
    return *(int32_t *)v2;
}

// Address range: 0x403eb5 - 0x403ec5
int32_t function_403eb5(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x403eb9
    int32_t v2 = *v1; // 0x403eb9
    *v1 = v2 + 8;
    return *(int32_t *)v2;
}

// Address range: 0x403ec5 - 0x403ed3
int32_t function_403ec5(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x403ec9
    int32_t v2 = *v1; // 0x403ec9
    int32_t v3 = v2 + 4; // 0x403ec9
    *v1 = v3;
    return v3 & -0x10000 | (int32_t)*(int16_t *)v2;
}

// Address range: 0x403ed3 - 0x403f50
int32_t function_403ed3(int32_t a1, int32_t a2) {
    uint32_t v1 = a2 * a1; // 0x403eda
    int32_t v2 = v1; // 0x403ee4
    if (v1 < 0xffffffe1) {
        // 0x403ee6
        v2 = v1 != 0 ? v1 + 15 & -16 : 16;
    }
    // 0x403ef3
    int32_t v3; // bp-12, 0x403ed3
    int32_t v4 = &v3;
    int32_t v5 = v4; // 0x403ef8
    int32_t v6 = 0; // 0x403ef8
    int32_t * v7; // 0x403ed3
    int32_t result; // 0x403ed3
    int32_t * v8; // 0x403f18
    int32_t v9; // 0x403f03
    if (v2 < 0xffffffe1) {
        // 0x403efa
        v7 = (int32_t *)(v4 - 4);
        if (v1 <= g30) {
            // 0x403f02
            *v7 = v1;
            v9 = function_402955((int32_t)&g112);
            if (v9 != 0) {
                // 0x403f3a
                *v7 = v1;
                *(int32_t *)(v4 - 8) = 0;
                *(int32_t *)(v4 - 12) = v9;
                function_405390((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
                result = v9;
                return result;
            }
        }
        // 0x403f0f
        *v7 = v2;
        *(int32_t *)(v4 - 8) = 8;
        v5 = v4 - 12;
        *(int32_t *)v5 = g100;
        v8 = HeapAlloc(&g112, (int32_t)&g112, (int32_t)&g112);
        v6 = (int32_t)v8;
        if (v8 != NULL) {
            // break -> 0x403f48
            break;
        }
    }
    // 0x403f24
    result = v6;
    while (g68 != 0) {
        // 0x403f2d
        *(int32_t *)(v5 - 4) = v2;
        int32_t v10 = __callnewh((int32_t)&g112); // 0x403f2e
        result = 0;
        if (v10 == 0) {
            // break -> 0x403f48
            break;
        }
        v4 = v5;
        v5 = v4;
        v6 = 0;
        if (v2 < 0xffffffe1) {
            // 0x403efa
            v7 = (int32_t *)(v4 - 4);
            if (v1 <= g30) {
                // 0x403f02
                *v7 = v1;
                v9 = function_402955((int32_t)&g112);
                if (v9 != 0) {
                    // 0x403f3a
                    *v7 = v1;
                    *(int32_t *)(v4 - 8) = 0;
                    *(int32_t *)(v4 - 12) = v9;
                    function_405390((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
                    result = v9;
                    return result;
                }
            }
            // 0x403f0f
            *v7 = v2;
            *(int32_t *)(v4 - 8) = 8;
            v5 = v4 - 12;
            *(int32_t *)v5 = g100;
            v8 = HeapAlloc(&g112, (int32_t)&g112, (int32_t)&g112);
            v6 = (int32_t)v8;
            result = v6;
            if (v8 != NULL) {
                // break -> 0x403f48
                break;
            }
        }
        // 0x403f24
        result = v6;
    }
  lab_0x403f48:
    // 0x403f48
    return result;
}

// Address range: 0x403f50 - 0x403fa8
int32_t function_403f50(void) {
    // 0x403f50
    if (g104 < 4) {
        // 0x403fa3
        return 0;
    }
    // 0x403f5f
    int32_t v1; // bp-8, 0x403f50
    int32_t * v2 = (int32_t *)((int32_t)&v1 - 4);
    int32_t v3 = 0;
    uint32_t v4 = 3;
    int32_t v5 = 4 * v4; // 0x403f64
    int32_t v6 = *(int32_t *)(g102 + v5); // 0x403f64
    int32_t v7 = v3; // 0x403f69
    int32_t v8; // 0x403f50
    int32_t v9; // 0x403f50
    if (v6 != 0) {
        // 0x403f6b
        v8 = v3;
        if ((*(char *)(v6 + 12) & -125) != 0) {
            // 0x403f71
            *v2 = v6;
            v8 = v3 + (int32_t)(function_40176e((int32_t)&g112) != -1);
        }
        // 0x403f7e
        v9 = v8;
        v7 = v9;
        if (v4 >= 20) {
            // 0x403f83
            *v2 = *(int32_t *)(g102 + v5);
            function_40163a((int32_t)&g112);
            *(int32_t *)(g102 + v5) = 0;
            v7 = v9;
        }
    }
    int32_t result = v7;
    int32_t v10 = v4 + 1; // 0x403f9a
    while (v10 < g104) {
        // 0x403f5f
        v3 = result;
        v4 = v10;
        v5 = 4 * v4;
        v6 = *(int32_t *)(g102 + v5);
        v7 = v3;
        if (v6 != 0) {
            // 0x403f6b
            v8 = v3;
            if ((*(char *)(v6 + 12) & -125) != 0) {
                // 0x403f71
                *v2 = v6;
                v8 = v3 + (int32_t)(function_40176e((int32_t)&g112) != -1);
            }
            // 0x403f7e
            v9 = v8;
            v7 = v9;
            if (v4 >= 20) {
                // 0x403f83
                *v2 = *(int32_t *)(g102 + v5);
                function_40163a((int32_t)&g112);
                *(int32_t *)(g102 + v5) = 0;
                v7 = v9;
            }
        }
        // 0x403f9a
        result = v7;
        v10 = v4 + 1;
    }
    // 0x403fa3
    return result;
}

// Address range: 0x403fa8 - 0x4040e9
int32_t function_403fa8(int32_t a1, int32_t ExceptionInfo) {
    // 0x403fa8
    int32_t v1; // 0x403fa8
    int32_t v2; // 0x403fa8
    int32_t v3 = function_4040e9(a1, v2, v1); // 0x403faf
    if (v3 == 0) {
        // 0x4040e6
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    int32_t * v4 = (int32_t *)(v3 + 8); // 0x403fbd
    int32_t v5 = *v4; // 0x403fbd
    if (v5 == 0) {
        // 0x4040e6
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    if (v5 == 5) {
        // 0x403fcd
        *v4 = 0;
        // 0x4040e6
        return 1;
    }
    // 0x403fd9
    if (v5 == 1) {
        // 0x4040e6
        return -1;
    }
    int32_t v6 = g71; // 0x403fe2
    g71 = ExceptionInfo;
    if (*(int32_t *)(v3 + 4) != 8) {
        // 0x4040c8
        *v4 = 0;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    int32_t v7 = g36; // 0x404000
    if (g37 + v7 > v7) {
        int32_t v8 = g37; // 0x404018
        int32_t v9 = 12 * v7 + (int32_t)&g35; // 0x404018
        *(int32_t *)v9 = 0;
        v8--;
        v9 += 12;
        while (v8 != 0) {
            // 0x40401f
            *(int32_t *)v9 = 0;
            v8--;
            v9 += 12;
        }
    }
    int32_t v10 = *(int32_t *)v3; // 0x404028
    int32_t v11 = g39; // 0x40402a
    if (v10 == -0x3fffff72) {
        // 0x404037
        g39 = 131;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff70) {
        // 0x40404a
        g39 = 129;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff6f) {
        // 0x40405d
        g39 = 132;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff6d) {
        // 0x404070
        g39 = 133;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff73) {
        // 0x404083
        g39 = 130;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff71) {
        // 0x404096
        g39 = 134;
        // 0x4040b3
        g39 = v11;
        // 0x4040d0
        g71 = v6;
        // 0x4040e6
        return -1;
    }
    if (v10 == -0x3fffff6e) {
        // 0x4040a9
        g39 = 138;
    }
    // 0x4040b3
    g39 = v11;
    // 0x4040d0
    g71 = v6;
    // 0x4040e6
    return -1;
}

// Address range: 0x4040e9 - 0x40412c
int32_t function_4040e9(int32_t a1, int32_t a2, int32_t a3) {
    uint32_t v1 = 12 * g38 + (int32_t)&g34;
    int32_t v2 = &g34; // 0x4040ff
    int32_t result = &g34; // 0x4040ff
    if (g34 != a1) {
        v2 += 12;
        result = v2;
        while (v2 < v1) {
            // 0x404112
            result = v2;
            if (*(int32_t *)v2 == a1) {
                // break -> 0x404116
                break;
            }
            v2 += 12;
            result = v2;
        }
    }
    // 0x404116
    if (result < v1) {
        // 0x404125
        if (*(int32_t *)result == a1) {
            // 0x40412b
            return result;
        }
    }
    // 0x40412b
    return 0;
}

// Address range: 0x40412c - 0x4041e5
int32_t function_40412c(void) {
    // 0x40412c
    if (g106 == 0) {
        // 0x404139
        int32_t v1; // 0x40412c
        int32_t v2; // 0x40412c
        int32_t v3; // 0x40412c
        function_4058a4(v1, v2, v3);
    }
    // 0x40413e
    int32_t v4; // bp-12, 0x40412c
    int32_t v5 = &v4; // 0x404136
    int32_t * v6 = (int32_t *)(v5 - 4);
    int32_t v7 = (int32_t)g66; // 0x404144
    int32_t v8 = 0; // 0x404144
    int32_t v9; // 0x40412c
    while (true) {
      lab_0x404146:
        // 0x404146
        v9 = v8;
        v8 = v9;
        int32_t v10; // 0x40412c
        switch (*(char *)v10) {
            case 0: {
                goto lab_0x40415e;
            }
            case 61: {
                goto lab_0x404151;
            }
            default: {
                // 0x404150
                v8 = v9 + 1;
                goto lab_0x404151;
            }
        }
    }
  lab_0x40415e:
    // 0x40415e
    *v6 = 4 * v9 + 4;
    int32_t * v11 = _malloc((int32_t)&g112); // 0x404166
    int32_t v12 = (int32_t)v11; // 0x404166
    g59 = v12;
    if (v11 == NULL) {
        // 0x404178
        *v6 = 9;
        __amsg_exit();
    }
    char * v13 = g66; // 0x404180
    char * v14 = v13; // 0x404188
    int32_t * v15 = v11; // 0x404188
    if (*v13 != 0) {
        int32_t * v16 = (int32_t *)(v5 - 8); // 0x40418b
        int32_t v17 = (int32_t)v13;
        *v16 = v17;
        int32_t v18 = function_4051b0((int32_t)&g112) + 1; // 0x404194
        int32_t v19 = v12; // 0x404198
        int32_t * v20; // 0x40419b
        int32_t * v21; // 0x4041a3
        if (*(char *)v17 != 61) {
            // 0x40419a
            *v16 = v18;
            v20 = _malloc((int32_t)&g112);
            v21 = (int32_t *)v12;
            *v21 = (int32_t)v20;
            if (v20 == NULL) {
                // 0x4041a7
                *v16 = 9;
                __amsg_exit();
            }
            // 0x4041af
            *v16 = v17;
            *(int32_t *)(v5 - 12) = *v21;
            function_4053f0((int32_t)&g112);
            v19 = v12 + 4;
        }
        int32_t v22 = v19;
        int32_t v23 = v18 + v17; // 0x4041bc
        while (*(char *)v23 != 0) {
            // 0x40418b
            v17 = v23;
            int32_t v24 = v22;
            *v16 = v17;
            v18 = function_4051b0((int32_t)&g112) + 1;
            v19 = v24;
            if (*(char *)v17 != 61) {
                // 0x40419a
                *v16 = v18;
                v20 = _malloc((int32_t)&g112);
                v21 = (int32_t *)v24;
                *v21 = (int32_t)v20;
                if (v20 == NULL) {
                    // 0x4041a7
                    *v16 = 9;
                    __amsg_exit();
                }
                // 0x4041af
                *v16 = v17;
                *(int32_t *)(v5 - 12) = *v21;
                function_4053f0((int32_t)&g112);
                v19 = v24 + 4;
            }
            // 0x4041bc
            v22 = v19;
            v23 = v18 + v17;
        }
        // 0x4041c2
        v14 = g66;
        v15 = (int32_t *)v22;
    }
    // 0x4041c3
    *v6 = (int32_t)v14;
    int32_t result = function_40163a((int32_t)&g112); // 0x4041c9
    g66 = NULL;
    *v15 = 0;
    g105 = 1;
    return result;
  lab_0x404151:
    // 0x404151
    *v6 = v7;
    v7 = v7 + 1 + function_4051b0((int32_t)&g112);
    goto lab_0x404146;
}

// Address range: 0x4041e5 - 0x40427e
int32_t function_4041e5(void) {
    // 0x4041e5
    if (g106 == 0) {
        // 0x4041f7
        int32_t v1; // 0x4041e5
        int32_t v2; // 0x4041e5
        int32_t v3; // 0x4041e5
        function_4058a4(v1, v2, v3);
    }
    // 0x4041fc
    GetModuleFileNameA(NULL, (char *)&g72, 260);
    char * v4 = g101; // 0x40420e
    g61 = (char *)&g72;
    int32_t v5 = *v4 == 0 ? (int32_t)&g72 : (int32_t)v4;
    int32_t v6; // bp-12, 0x4041e5
    int32_t v7; // bp-8, 0x4041e5
    function_40427e(v5, 0, 0, &v7, &v6);
    int32_t * v8 = _malloc(4 * v7 + v6); // 0x40423b
    if (v8 == NULL) {
        // 0x404249
        __amsg_exit();
    }
    int32_t v9 = (int32_t)v8; // 0x40423b
    function_40427e(v5, v9, 4 * v7 + v9, &v7, &v6);
    int32_t result = v7 - 1; // 0x40426d
    g58 = v9;
    g57 = result;
    return result;
}

// Address range: 0x40427e - 0x404432
int32_t function_40427e(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5) {
    // 0x40427e
    *a5 = 0;
    *a4 = 1;
    int32_t v1 = 0; // 0x40429e
    if (a2 != 0) {
        // 0x4042a0
        *(int32_t *)a2 = a3;
        v1 = a2 + 4;
    }
    int32_t v2 = a1; // 0x4042ab
    int32_t v3 = a3; // 0x4042ab
    int32_t v4 = a1; // 0x4042ab
    int32_t v5 = a3; // 0x4042ab
    int32_t v6; // 0x40427e
    int32_t v7; // 0x40427e
    int32_t v8; // 0x40427e
    int32_t v9; // 0x40427e
    int32_t v10; // 0x40427e
    int32_t v11; // 0x40427e
    if (*(char *)a1 != 34) {
        while (true) {
          lab_0x4042f1:;
            int32_t v12 = v5;
            int32_t v13 = v4;
            *a5 = *a5 + 1;
            char * v14 = (char *)v13;
            int32_t v15 = 0; // 0x4042f5
            if (v12 != 0) {
                // 0x4042f7
                *(char *)v12 = *v14;
                v15 = v12 + 1;
            }
            int32_t v16 = v15;
            unsigned char v17 = *v14; // 0x4042fc
            int32_t v18 = v13 + 1; // 0x4042fe
            int32_t v19 = v18; // 0x404309
            int32_t v20 = v16; // 0x404309
            if ((*(char *)((int32_t)v17 + (int32_t)&g89) & 4) != 0) {
                // 0x40430b
                *a5 = *a5 + 1;
                int32_t v21 = 0; // 0x40430f
                if (v16 != 0) {
                    // 0x404311
                    *(char *)v16 = *(char *)v18;
                    v21 = v16 + 1;
                }
                // 0x404316
                v19 = v13 + 2;
                v20 = v21;
            }
            // 0x404317
            v5 = v20;
            v4 = v19;
            switch (v17) {
                case 32: {
                    goto lab_0x40432c;
                }
                case 0: {
                    // 0x404329
                    v8 = v4 - 1;
                    v11 = v5;
                    goto lab_0x404334;
                }
                default: {
                    // 0x404320
                    if (v17 == 9) {
                        // break -> 0x40432c
                        break;
                    }
                    goto lab_0x4042f1;
                }
            }
        }
      lab_0x40432c:
        // 0x40432c
        v8 = v4;
        v11 = 0;
        if (v5 != 0) {
            // 0x404330
            *(char *)(v5 - 1) = 0;
            v8 = v4;
            v11 = v5;
        }
    } else {
        int32_t v22; // 0x40427e
        int32_t v23; // 0x40427e
        int32_t v24; // 0x4042ad
        char * v25; // 0x40427e
        while (true) {
          lab_0x4042ad_2:
            // 0x4042ad
            v23 = v3;
            v22 = v2;
            v24 = v22 + 1;
            v25 = (char *)v24;
            unsigned char v26 = *v25; // 0x4042ad
            switch (v26) {
                case 34: {
                    goto lab_0x4042df;
                }
                case 0: {
                    goto lab_0x4042df;
                }
                default: {
                    char v27 = *(char *)((int32_t)v26 + (int32_t)&g89); // 0x4042bd
                    v7 = v24;
                    v10 = v23;
                    if ((v27 & 4) == 0) {
                        goto lab_0x4042d2;
                    } else {
                        int32_t v28 = *a5; // 0x4042c6
                        *a5 = v28 + 1;
                        if (v23 == 0) {
                            // 0x4042d2
                            *a5 = v28 + 2;
                            v6 = v24;
                            v9 = 0;
                            goto lab_0x4042ad;
                        } else {
                            // 0x4042cc
                            *(char *)v23 = *v25;
                            v7 = v22 + 2;
                            v10 = v23 + 1;
                            goto lab_0x4042d2;
                        }
                    }
                }
            }
        }
      lab_0x4042df:
        // 0x4042df
        *a5 = *a5 + 1;
        int32_t v29 = 0; // 0x4042e3
        if (v23 != 0) {
            // 0x4042e5
            *(char *)v23 = 0;
            v29 = v23 + 1;
        }
        // 0x4042e9
        v8 = *v25 != 34 ? v24 : v22 + 2;
        v11 = v29;
    }
    goto lab_0x404334;
  lab_0x4043ad:;
    // 0x4043ad
    int32_t v67; // 0x40427e
    int32_t v79 = v67;
    int32_t v65; // 0x40427e
    int32_t v80 = v65;
    int32_t v64; // 0x40427e
    int32_t v82 = v64;
    int32_t v63; // 0x40427e
    int32_t v81 = v63;
    int32_t v66; // 0x40427e
    int32_t v83 = v66; // 0x4043b2
    int32_t v50; // 0x40427e
    int32_t v84 = v50; // 0x4043b2
    int32_t v85 = v50; // 0x4043b2
    if (v66 != 0) {
        int32_t v86 = v84;
        int32_t v87 = 0; // 0x4043b7
        if (v86 != 0) {
            // 0x4043b9
            *(char *)v86 = 92;
            v87 = v86 + 1;
        }
        // 0x4043bd
        *a5 = *a5 + 1;
        int32_t v88 = v83 - 1; // 0x4043bf
        v83 = v88;
        v85 = v87;
        while (v88 != 0) {
            // 0x4043b5
            v86 = v87;
            v87 = 0;
            if (v86 != 0) {
                // 0x4043b9
                *(char *)v86 = 92;
                v87 = v86 + 1;
            }
            // 0x4043bd
            *a5 = *a5 + 1;
            v88 = v83 - 1;
            v83 = v88;
            v85 = v87;
        }
    }
    int32_t v76 = v85;
    char * v78 = (char *)v80;
    unsigned char v89 = *v78; // 0x4043c2
    if (v89 == 0) {
        // break -> 0x404412
        goto lab_0x404412_2;
    }
    if (v81 != 0) {
        goto lab_0x4043d8;
    } else {
        switch (v89) {
            case 32: {
                goto lab_0x404412_2;
            }
            case 9: {
                goto lab_0x404412_2;
            }
            default: {
                goto lab_0x4043d8;
            }
        }
    }
  lab_0x4043d8:;
    int32_t v90 = v80; // 0x4043dc
    int32_t v91 = v76; // 0x4043dc
    if (v82 != 0) {
        char v92 = *(char *)((int32_t)v89 + (int32_t)&g89);
        int32_t v93; // 0x40427e
        int32_t v94; // 0x40427e
        if (v76 == 0) {
            // 0x4043fb
            v93 = v80;
            v94 = 0;
            if ((v92 & 4) != 0) {
                // 0x404407
                *a5 = *a5 + 1;
                v93 = v80 + 1;
                v94 = 0;
            }
        } else {
            char v95 = v89; // 0x4043ec
            int32_t v96 = v80; // 0x4043ec
            int32_t v97 = v76; // 0x4043ec
            if ((v92 & 4) != 0) {
                // 0x4043ee
                *(char *)v76 = v89;
                v96 = v80 + 1;
                *a5 = *a5 + 1;
                v95 = *(char *)v96;
                v97 = v76 + 1;
            }
            // 0x4043f4
            *(char *)v97 = v95;
            v93 = v96;
            v94 = v97 + 1;
        }
        // 0x40440a
        *a5 = *a5 + 1;
        v90 = v93;
        v91 = v94;
    }
    int32_t v45 = v81; // 0x40440d
    int32_t v46 = v90 + 1; // 0x40440d
    int32_t v47 = v91; // 0x40440d
    int32_t v48 = v79; // 0x40440d
    goto lab_0x40436a;
  lab_0x4043ab:;
    // 0x4043ab
    int32_t v68; // 0x40427e
    v63 = v68;
    int32_t v69; // 0x40427e
    v64 = v69;
    int32_t v70; // 0x40427e
    v65 = v70;
    int32_t v61; // 0x40427e
    v66 = v61 / 2;
    int32_t v71; // 0x40427e
    v67 = v71;
    goto lab_0x4043ad;
  lab_0x40439d:;
    // 0x40439d
    int32_t v51; // 0x40427e
    v68 = v51 == 0;
    int32_t v72; // 0x40427e
    v69 = v72;
    int32_t v73; // 0x40427e
    v70 = v73;
    int32_t v44; // 0x40427e
    v71 = v44;
    goto lab_0x4043ab;
  lab_0x4042d2:;
    int32_t v98 = v10;
    int32_t v99 = v7;
    *a5 = *a5 + 1;
    v6 = v99;
    v9 = 0;
    if (v98 != 0) {
        // 0x4042d8
        *(char *)v98 = *(char *)v99;
        v6 = v99;
        v9 = v98 + 1;
    }
    goto lab_0x4042ad;
  lab_0x4042ad:
    // 0x4042ad
    v2 = v6;
    v3 = v9;
    goto lab_0x4042ad_2;
  lab_0x404334:;
    char v30 = *(char *)v8; // 0x404338
    char v31 = v30; // 0x40433b
    int32_t v32 = v1; // 0x40433b
    int32_t v33 = v11; // 0x40433b
    int32_t v34 = v8; // 0x40433b
    int32_t v35 = 0; // 0x40433b
    int32_t v36 = v1; // 0x40433b
    if (v30 != 0) {
        while (true) {
            int32_t v37 = v33;
            int32_t v38 = v32;
            char v39 = v31; // 0x404341
            int32_t v40 = v34; // 0x404346
            if (v39 != 32 != v39 != 9) {
                int32_t v41 = v40 + 1; // 0x40434d
                char v42 = *(char *)v41; // 0x404341
                v40 = v41;
                while (v42 != 32 != v42 != 9) {
                    // 0x40434d
                    v41 = v40 + 1;
                    v42 = *(char *)v41;
                    v40 = v41;
                }
                // 0x404350
                v36 = v38;
                if (v42 == 0) {
                    // break -> 0x404421
                    break;
                }
            }
            int32_t v43 = 0; // 0x40435b
            if (v38 != 0) {
                // 0x40435d
                *(int32_t *)v38 = v37;
                v43 = v38 + 4;
            }
            // 0x404365
            v44 = v43;
            *a4 = *a4 + 1;
            v45 = v35;
            v46 = v34;
            v47 = v37;
            v48 = v43;
            while (true) {
              lab_0x40436a:;
                int32_t v49 = v48;
                v50 = v47;
                v51 = v45;
                char v52 = *(char *)v46; // 0x404373
                int32_t v53 = v46; // 0x404376
                int32_t v54 = v46; // 0x404376
                int32_t v55 = 0; // 0x404376
                char v56 = v52; // 0x404376
                if (v52 == 92) {
                    v54 = v53 + 1;
                    v55 = 1;
                    v56 = *(char *)v54;
                    while (v56 == 92) {
                        // 0x404378
                        v54 = v53 + 1;
                        int32_t v57; // 0x40427e
                        v55 = v57 + 1;
                        v56 = *(char *)v54;
                        v57 = v55;
                        v53 = v54;
                        int32_t v58 = v54; // 0x404376
                        int32_t v59 = v55; // 0x404376
                        char v60 = v56; // 0x404376
                    }
                }
                // 0x40437c
                v61 = v55;
                int32_t v62 = v54;
                v63 = v51;
                v64 = 1;
                v65 = v62;
                v66 = v61;
                v67 = v49;
                if (v56 != 34) {
                    goto lab_0x4043ad;
                } else {
                    // 0x404381
                    v68 = v51;
                    v69 = 1;
                    v70 = v62;
                    v71 = v49;
                    if ((v61 & 1) != 0) {
                        goto lab_0x4043ab;
                    } else {
                        if (v51 == 0) {
                            // 0x40439a
                            v72 = 0;
                            v73 = v62;
                            goto lab_0x40439d;
                        } else {
                            int32_t v74 = v62 + 1; // 0x40438d
                            v72 = 1;
                            v73 = v74;
                            if (*(char *)v74 != 34) {
                                // 0x40439a
                                v72 = 0;
                                v73 = v62;
                                goto lab_0x40439d;
                            } else {
                                goto lab_0x40439d;
                            }
                        }
                    }
                }
            }
          lab_0x404412_2:;
            int32_t v75 = 0; // 0x404414
            if (v76 != 0) {
                // 0x404416
                *(char *)v76 = 0;
                v75 = v76 + 1;
            }
            // 0x40441a
            *a5 = *a5 + 1;
            char v77 = *v78; // 0x404338
            v31 = v77;
            v32 = v79;
            v33 = v75;
            v34 = v80;
            v35 = v81;
            v36 = v79;
            if (v77 == 0) {
                // break -> 0x404421
                break;
            }
        }
    }
    // 0x404421
    if (v36 != 0) {
        // 0x404425
        *(int32_t *)v36 = 0;
    }
    // 0x404428
    *a4 = *a4 + 1;
    return (int32_t)a4;
}

// Address range: 0x404432 - 0x404564
int32_t function_404432(void) {
    int32_t v1 = g73; // 0x404434
    char * lpszEnvironmentBlock; // 0x404432
    int16_t * lpWideCharStr; // 0x404432
    if (v1 != 0) {
        if (v1 != 1) {
            // 0x40450a
            if (v1 != 2) {
                // 0x40455d
                return 0;
            }
            char * v2 = GetEnvironmentStrings(); // 0x404513
            lpszEnvironmentBlock = v2;
            if (v2 == NULL) {
                // 0x40455d
                return 0;
            }
            goto lab_0x40451f;
        } else {
            int16_t * v3 = GetEnvironmentStringsW(); // 0x40448d
            lpWideCharStr = v3;
            if (v3 == NULL) {
                // 0x40455d
                return 0;
            }
            goto lab_0x404499;
        }
    } else {
        int16_t * v4 = GetEnvironmentStringsW(); // 0x40444d
        if (v4 == NULL) {
            char * v5 = GetEnvironmentStrings(); // 0x404461
            if (v5 == NULL) {
                // 0x40455d
                return 0;
            }
            // 0x40450f
            g73 = 2;
            lpszEnvironmentBlock = v5;
            goto lab_0x40451f;
        } else {
            // 0x404489
            g73 = 1;
            lpWideCharStr = v4;
            goto lab_0x404499;
        }
    }
  lab_0x40451f:;
    int32_t v6 = (int32_t)lpszEnvironmentBlock;
    int32_t v7 = v6; // 0x404523
    int32_t v8 = v6; // 0x404523
    if (*lpszEnvironmentBlock != 0) {
        while (true) {
            int32_t v9 = v7;
            int32_t v10 = v9 + 1; // 0x404525
            int32_t v11 = v10; // 0x404528
            if (*(char *)v10 == 0) {
                // 0x40452a
                v11 = v9 + 2;
                v8 = v11;
                if (*(char *)v11 == 0) {
                    // break -> 0x40452f
                    break;
                }
            }
            // 0x404525
            v7 = v11;
        }
    }
    int32_t v12 = v8 - v6 + 1; // 0x404531
    int32_t * v13 = _malloc(v12); // 0x404535
    int32_t result = 0; // 0x40453f
    if (v13 != NULL) {
        int32_t v14 = (int32_t)v13; // 0x404535
        function_402250(v14, v6, v12);
        result = v14;
    }
    // 0x404550
    FreeEnvironmentStringsA(lpszEnvironmentBlock);
    // 0x40455d
    return result;
  lab_0x404499:;
    int32_t v15 = (int32_t)lpWideCharStr;
    int32_t v16 = v15; // 0x40449e
    int32_t v17 = v15; // 0x40449e
    if (*lpWideCharStr != 0) {
        while (true) {
            int32_t v18 = v16;
            int32_t v19 = v18 + 2; // 0x4044a1
            int32_t v20 = v19; // 0x4044a5
            if (*(int16_t *)v19 == 0) {
                // 0x4044a7
                v20 = v18 + 4;
                v17 = v20;
                if (*(int16_t *)v20 == 0) {
                    // break -> 0x4044ae
                    break;
                }
            }
            // 0x4044a0
            v16 = v20;
        }
    }
    int32_t v21 = 0; // bp-56, 0x4044c0
    int32_t v22 = &v21; // 0x4044c0
    int32_t cbMultiByte = WideCharToMultiByte(0, 0, lpWideCharStr, (v17 - v15) / 2 + 1, NULL, 0, NULL, NULL); // 0x4044c5
    int32_t result2 = 0; // 0x4044cb
    int32_t v23 = v22; // 0x4044cb
    if (cbMultiByte != 0) {
        int32_t * lpMultiByteStr = _malloc(cbMultiByte); // 0x4044ce
        result2 = 0;
        v23 = v22;
        if (lpMultiByteStr != NULL) {
            int32_t v24 = 0; // bp-88, 0x4044e6
            int32_t v25 = WideCharToMultiByte(0, 0, lpWideCharStr, 0, (char *)lpMultiByteStr, cbMultiByte, NULL, NULL); // 0x4044e7
            char * v26 = (char *)lpMultiByteStr; // 0x4044eb
            if (v25 == 0) {
                // 0x4044ed
                function_40163a((int32_t)lpMultiByteStr);
                v26 = NULL;
            }
            // 0x4044fb
            result2 = (int32_t)v26;
            v23 = &v24;
        }
    }
    // 0x4044ff
    *(int32_t *)(v23 - 4) = v15;
    FreeEnvironmentStringsW((int16_t *)&g112);
    // 0x40455d
    return result2;
}

// Address range: 0x404631 - 0x40463a
int32_t function_404631(void) {
    // 0x404631
    int32_t result; // 0x404631
    return result;
}

// Address range: 0x404654 - 0x404719
int32_t function_404654(int32_t a1, int32_t a2, int32_t a3) {
    // 0x404654
    int32_t v1; // 0x404654
    uint32_t v2; // 0x404654
    int32_t v3; // 0x404654
    *(char *)v1 = (char)(v2 / 256 ^ v1 ^ v3);
    int32_t v4; // 0x404654
    char * v5 = (char *)v4; // bp-4, 0x40465c
    int32_t v6 = (int32_t)&v5; // 0x40465d
    int32_t v7 = v6; // bp-28, 0x404665
    if ((*(int32_t *)(a1 + 4) & 6) != 0) {
        // 0x4046fc
        __local_unwind2();
        // 0x404711
        return 1;
    }
    int32_t v8 = a1; // bp-12, 0x40467a
    int32_t v9 = &v8; // 0x404683
    *(int32_t *)(a2 - 4) = v9;
    int32_t v10 = *(int32_t *)(a2 + 12); // 0x404689
    if (v10 == -1) {
        // 0x404711
        return 1;
    }
    int32_t v11 = &v7;
    int32_t v12 = 12 * v10;
    int32_t v13 = v12; // 0x40469c
    int32_t v14 = v9; // 0x40469c
    int32_t v15 = a2; // 0x40469c
    int32_t v16 = v11; // 0x40469c
    int32_t v17 = v6; // 0x40469c
    int32_t v18; // 0x40469e
    int32_t * v19; // 0x40469e
    int32_t * v20; // 0x40469f
    int32_t v21; // 0x4046a8
    int32_t v22; // 0x4046a9
    int32_t v23; // 0x404654
    int32_t v24; // 0x4046d9
    if (*(int32_t *)(*(int32_t *)(a2 + 8) + 4 + v12) != 0) {
        // 0x40469e
        v18 = v11 - 4;
        v19 = (int32_t *)v18;
        *v19 = v10;
        v20 = (int32_t *)(v11 - 8);
        *v20 = v6;
        v21 = *v19;
        v22 = *(int32_t *)(v6 + 12);
        if (v9 == 0) {
            // 0x40469e
            v13 = 12 * v21;
            v14 = 0;
            v15 = v22;
            v16 = v11;
            v17 = v6;
        } else {
            // 0x4046b0
            if (v9 < 0) {
                // break -> 0x404711
                break;
            }
            // 0x4046b2
            *v19 = v22;
            __global_unwind2();
            *v19 = v21;
            *v20 = v22;
            __local_unwind2();
            *v19 = 1;
            __NLG_Notify();
            v23 = 12 * v21;
            v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
            *(int32_t *)(v22 + 12) = v24;
            v13 = v23;
            v14 = v24;
            v15 = v22;
            v16 = v18;
            v17 = v22 + 16;
        }
    }
    int32_t v25 = v15;
    int32_t v26 = *(int32_t *)(v25 + 8); // 0x4046e3
    int32_t v27 = *(int32_t *)(v26 + v13); // 0x4046e9
    int32_t result = 1; // 0x404692
    while (v27 != -1) {
        int32_t v28 = v27;
        v11 = v16;
        int32_t v29 = v17;
        int32_t v30 = v14;
        v12 = 12 * v28;
        v13 = v12;
        v14 = v30;
        v15 = v25;
        v16 = v11;
        v17 = v29;
        if (*(int32_t *)(v26 + 4 + v12) != 0) {
            // 0x40469e
            v18 = v11 - 4;
            v19 = (int32_t *)v18;
            *v19 = v28;
            v20 = (int32_t *)(v11 - 8);
            *v20 = v29;
            v21 = *v19;
            v22 = *(int32_t *)(v29 + 12);
            if (v30 == 0) {
                // 0x40469e
                v13 = 12 * v21;
                v14 = 0;
                v15 = v22;
                v16 = v11;
                v17 = v29;
            } else {
                // 0x4046b0
                result = 0;
                if (v30 < 0) {
                    // break -> 0x404711
                    break;
                }
                // 0x4046b2
                *v19 = v22;
                __global_unwind2();
                *v19 = v21;
                *v20 = v22;
                __local_unwind2();
                *v19 = 1;
                __NLG_Notify();
                v23 = 12 * v21;
                v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
                *(int32_t *)(v22 + 12) = v24;
                v13 = v23;
                v14 = v24;
                v15 = v22;
                v16 = v18;
                v17 = v22 + 16;
            }
        }
        // 0x4046e3
        v25 = v15;
        v26 = *(int32_t *)(v25 + 8);
        v27 = *(int32_t *)(v26 + v13);
        result = 1;
    }
    // 0x404711
    return result;
}

// Address range: 0x404734 - 0x40476d
int32_t __FF_MSGBANNER(void) {
    // 0x404734
    if (g67 == 1) {
        // 0x40474b
        __NMSG_WRITE(252);
        // 0x40476c
        return __NMSG_WRITE(255);
    }
    // 0x40473e
    if (g67 != 0 || g29 != 1) {
        // 0x40476c
        return g67;
    }
    // 0x40474b
    __NMSG_WRITE(252);
    // 0x40476c
    return __NMSG_WRITE(255);
}

// Address range: 0x40476d - 0x4048c0
int32_t __NMSG_WRITE(int32_t a1) {
    int32_t result = &g40; // 0x40477b
    int32_t v1 = 0; // 0x40477b
    while (*(int32_t *)result != a1) {
        // 0x404784
        result += 8;
        v1++;
        if (result >= (int32_t)&g42) {
            // break -> 0x40478f
            break;
        }
    }
    int32_t v2 = 8 * v1; // 0x404792
    if (*(int32_t *)(v2 + (int32_t)&g40) != a1) {
        // 0x4048bd
        return result;
    }
    // 0x4047a1
    if (g67 != 1) {
        // 0x4047af
        if (g67 == 0 != (g29 == 1)) {
            // 0x4047c0
            if (a1 == 252) {
                // 0x4048bd
                return g67;
            }
            // 0x4047cc
            int32_t lpFilename; // bp-424, 0x40476d
            int32_t nameSize = GetModuleFileNameA(NULL, (char *)&lpFilename, 260); // 0x4047da
            int32_t v3 = &lpFilename;
            if (nameSize == 0) {
                // 0x4047e4
                function_4053f0(v3);
            }
            int32_t v4 = function_4051b0(v3); // 0x404805
            int32_t v5 = v3; // 0x40480f
            if (v4 >= 60) {
                // 0x404811
                int32_t v6; // bp-483, 0x40476d
                v5 = function_4051b0(v3) + (int32_t)&v6;
                function_401670(v5, (int32_t)"...", 3);
            }
            // 0x40483a
            int32_t v7; // bp-164, 0x40476d
            function_4053f0((int32_t)&v7);
            function_405400(&v7, v5);
            function_405400(&v7, (int32_t)"\n\n");
            function_405400(&v7, *(int32_t *)(v2 + (int32_t)&g41));
            // 0x4048bd
            return function_4058c0(&v7, "Microsoft Visual C++ Runtime Library", 0x12010);
        }
    }
    // 0x404897
    function_4051b0(*(int32_t *)(v2 + (int32_t)&g41));
    bool result2 = WriteFile(GetStdHandle(-12), &g112, (int32_t)&g112, &g112, (struct _OVERLAPPED *)&g112); // 0x4048b7
    // 0x4048bd
    return result2;
}

// Address range: 0x4048c0 - 0x404904
int32_t function_4048c0(int32_t a1) {
    // 0x4048c0
    g65++;
    int32_t * v1 = _malloc(0x1000); // 0x4048cb
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x4048d7
    *v2 = (int32_t)v1;
    int32_t * v3 = (int32_t *)(a1 + 12);
    int32_t v4 = *v3;
    if (v1 == NULL) {
        // 0x4048e9
        *v3 = v4 | 4;
        *v2 = a1 + 20;
        *(int32_t *)(a1 + 24) = 2;
    } else {
        // 0x4048dc
        *v3 = v4 | 8;
        *(int32_t *)(a1 + 24) = 0x1000;
    }
    int32_t result = *v2; // 0x4048fa
    *(int32_t *)(a1 + 4) = 0;
    *(int32_t *)a1 = result;
    return result;
}

// Address range: 0x404904 - 0x40492a
int32_t function_404904(uint32_t a1, int32_t a2) {
    // 0x404904
    if ((int32_t)g93 <= a1) {
        // 0x404910
        return 0;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x40491b
    return (int32_t)(*(char *)(v1 + (8 * a1 & 248 | 4)) & 64);
}

// Address range: 0x40492a - 0x404991
int32_t function_40492a(int32_t a1) {
    // 0x40492a
    g51 = a1;
    int32_t result = &g42; // 0x404936
    int32_t v1 = 0;
    while (*(int32_t *)result != a1) {
        // 0x40493f
        result += 8;
        if (result >= (int32_t)&g44) {
            if (a1 < 37) {
                // 0x404954
                g50 = 13;
                return result;
            }
            // 0x40496c
            g50 = a1 < 203 ? 8 : 22;
            return result;
        }
        v1++;
    }
    int32_t result2 = *(int32_t *)(8 * v1 + (int32_t)&g43); // 0x40495f
    g50 = result2;
    return result2;
}

// Address range: 0x404991 - 0x4049e8
int32_t function_404991(uint32_t a1) {
    // 0x404991
    if ((int32_t)g93 <= a1) {
        // 0x4049da
        g50 = 9;
        // 0x4049e7
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x4049a7
    if ((*(char *)(v1 + (8 * a1 & 248 | 4)) & 1) == 0) {
        // 0x4049da
        g50 = 9;
        // 0x4049e7
        return -1;
    }
    // 0x4049b5
    if (FlushFileBuffers((int32_t *)function_404eab(a1))) {
        // 0x4049e7
        return 0;
    }
    int32_t errorCode = GetLastError(); // 0x4049c7
    if (errorCode == 0) {
        // 0x4049e7
        return 0;
    }
    // 0x4049d5
    g51 = errorCode;
    // 0x4049da
    g50 = 9;
    // 0x4049e7
    return -1;
}

// Address range: 0x4049f0 - 0x404d25
int32_t function_4049f0(int32_t result5, uint32_t a2, uint32_t a3) {
    int32_t result3 = a3 + a2; // 0x404a02
    int32_t v1; // 0x4049f0
    int32_t v2; // 0x4049f0
    int32_t v3; // 0x4049f0
    int32_t v4; // 0x4049f0
    int32_t v5; // 0x4049f0
    int32_t result6; // 0x4049f0
    int32_t v6; // 0x4049f0
    int32_t v7; // 0x4049f0
    int32_t v8; // 0x4049f0
    int32_t v9; // 0x4049f0
    int32_t v10; // 0x4049f0
    int32_t v11; // 0x4049f0
    int32_t result2; // 0x4049f0
    int32_t result; // 0x4049f0
    if (result5 > a2 == result3 > result5) {
        int32_t v12 = a3 - 4; // 0x404b88
        int32_t v13 = v12 + a2; // 0x404b88
        int32_t v14 = v12 + result5; // 0x404b8c
        int32_t v15 = v14 & 3; // 0x404b90
        if (v15 != 0) {
            // 0x404bbc
            g111 = a3;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a3) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x404ce8;
                }
                case 2: {
                    goto lab_0x404cf8;
                }
                case 3: {
                    goto lab_0x404d0c;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a3 / 4));
            g110 = v16;
            if (a3 < 4) {
                // 0x404a38
                return result3;
            }
            int32_t v17 = a3 & 3; // 0x404b9b
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a3 & -4); // 0x404ba4
            g120 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x404ce8;
                }
                case 2: {
                    goto lab_0x404cf8;
                }
                case 3: {
                    goto lab_0x404d0c;
                }
                default: {
                    // 0x404bb02
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x404a10
        if (result4 != 0) {
            // 0x404a2c
            result = result5;
            if (a3 >= 4) {
                // 0x404a38
                return result4;
            }
            // 0x404a38
            return result;
        }
        int32_t v19 = a3 / 4; // 0x404a18
        g119 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x404a18
                result6 = a3 & -4;
                goto lab_0x404b1c;
            }
            case 2: {
                // 0x404a18
                v3 = a3 & -4;
                goto lab_0x404b14;
            }
            case 3: {
                // 0x404a18
                v4 = a3 & -4;
                goto lab_0x404b0c;
            }
            case 4: {
                // 0x404a18
                v5 = a3 & -4;
                goto lab_0x404b04;
            }
            case 5: {
                // 0x404a18
                v1 = a3 & -4;
                goto lab_0x404afc;
            }
            case 6: {
                // 0x404a18
                v2 = a3 & -4;
                goto lab_0x404af4;
            }
            case 7: {
                int32_t v20 = a3 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a2);
                v2 = v20;
                goto lab_0x404af4;
            }
            default: {
                int32_t v22 = a3 & 3; // 0x404a1b
                __asm_rep_movsd_memcpy((char *)result5, (char *)a2, v19);
                g118 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x404a38
                    return result5;
                }
                // 0x404a38
                return result2;
            }
        }
    }
  lab_0x404ce8:
    // 0x404ce8
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x404cf8:
    // 0x404cf8
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x404d0c:
    // 0x404d0c
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x404b1c:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a2);
    // 0x404a38
    return result6;
  lab_0x404b14:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a2);
    result6 = v3;
    goto lab_0x404b1c;
  lab_0x404b0c:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a2);
    v3 = v4;
    goto lab_0x404b14;
  lab_0x404b04:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a2);
    v4 = v5;
    goto lab_0x404b0c;
  lab_0x404afc:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a2);
    v5 = v1;
    goto lab_0x404b04;
  lab_0x404af4:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a2);
    v1 = v2;
    goto lab_0x404afc;
}

// Address range: 0x404d25 - 0x404dba
int32_t function_404d25(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11) {
    int32_t v1 = &g91; // 0x404d2f
    int32_t v2 = -1; // 0x404d2f
    int32_t v3 = 0; // 0x404d2f
    int32_t v4 = 0; // 0x404d2f
    int32_t result2; // 0x404d25
    int32_t v5; // 0x404d25
    while (true) {
        // 0x404d34
        v5 = v4;
        result2 = v2;
        int32_t * v6 = (int32_t *)v1; // 0x404d34
        uint32_t v7 = *v6; // 0x404d34
        if (v7 == 0) {
            // break -> 0x404d71
            break;
        }
        int32_t v8 = v3;
        uint32_t v9 = v7 + 256; // 0x404d3a
        int32_t v10 = v7; // 0x404d42
        int32_t v11 = result2; // 0x404d42
        int32_t result; // 0x404d25
        if (v7 < 0xffffff00) {
            int32_t v12 = v10;
            while ((*(char *)(v12 + 4) & 1) != 0) {
                int32_t v13 = v12 + 8; // 0x404d4a
                v10 = v13;
                v11 = result2;
                if (v13 >= v9) {
                    goto lab_0x404d60;
                }
                v12 = v10;
            }
            // 0x404d4f
            *(int32_t *)v12 = -1;
            int32_t v14 = (v12 - *v6) / 8 + v8; // 0x404d57
            v11 = v14;
            result = v14;
            if (v14 != -1) {
                // 0x404db4
                return result;
            }
        }
      lab_0x404d60:
        // 0x404d60
        v2 = v11;
        v1 += 4;
        v3 = v8 + 32;
        v4 = v5 + 1;
        result = v2;
        if (v1 >= (int32_t)&g93) {
            // 0x404db4
            return result;
        }
    }
    int32_t * v15 = _malloc(256); // 0x404d77
    if (v15 == NULL) {
        // 0x404db4
        return result2;
    }
    int32_t v16 = (int32_t)v15; // 0x404d77
    int32_t * v17 = (int32_t *)(4 * v5 + (int32_t)&g91); // 0x404d95
    *v17 = v16;
    if (v15 >= (int32_t *)-256) {
        // 0x404db4
        return 32 * v5;
    }
    for (int32_t i = v16; i < *v17 + 256; i += 8) {
        // 0x404d9b
        *(char *)(i + 4) = 0;
        *(int32_t *)i = -1;
        *(char *)(i + 5) = 10;
    }
    // 0x404db4
    return 32 * v5;
}

// Address range: 0x404dba - 0x404e31
int32_t function_404dba(uint32_t a1, int32_t hHandle) {
    // 0x404dba
    if ((int32_t)g93 <= a1) {
        // 0x404e1a
        g51 = 0;
        g50 = 9;
        // 0x404e2e
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x404dd9
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x404ddc
    int32_t * v3 = (int32_t *)(*v2 + v1);
    if (*v3 != -1) {
        // 0x404e1a
        g51 = 0;
        g50 = 9;
        // 0x404e2e
        return -1;
    }
    // 0x404de4
    if (g29 != 1) {
        // 0x404e10
        *v3 = hHandle;
        // 0x404e2e
        return 0;
    }
    int32_t nStdHandle = -10; // 0x404df5
    if (a1 != 0) {
        int32_t v4 = a1 - 1; // 0x404df7
        nStdHandle = -11;
        if (v4 != 0) {
            // 0x404dfa
            nStdHandle = -12;
            if (v4 != 1) {
                // 0x404e10
                *v3 = hHandle;
                // 0x404e2e
                return 0;
            }
        }
    }
    // 0x404e0a
    SetStdHandle(nStdHandle, (int32_t *)hHandle);
    // 0x404e10
    *(int32_t *)(*v2 + v1) = hHandle;
    // 0x404e2e
    return 0;
}

// Address range: 0x404e31 - 0x404eab
int32_t function_404e31(uint32_t a1) {
    // 0x404e31
    if ((int32_t)g93 <= a1) {
        // 0x404e94
        g51 = 0;
        g50 = 9;
        // 0x404ea8
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x404e50
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x404e53
    int32_t v3 = *v2 + v1;
    if ((*(char *)(v3 + 4) & 1) == 0) {
        // 0x404e94
        g51 = 0;
        g50 = 9;
        // 0x404ea8
        return -1;
    }
    int32_t * v4 = (int32_t *)v3;
    if (*v4 == -1) {
        // 0x404e94
        g51 = 0;
        g50 = 9;
        // 0x404ea8
        return -1;
    }
    // 0x404e62
    if (g29 != 1) {
        // 0x404e8a
        *v4 = -1;
        // 0x404ea8
        return 0;
    }
    int32_t nStdHandle = -10; // 0x404e6f
    if (a1 != 0) {
        int32_t v5 = a1 - 1; // 0x404e71
        nStdHandle = -11;
        if (v5 != 0) {
            // 0x404e74
            nStdHandle = -12;
            if (v5 != 1) {
                // 0x404e8a
                *v4 = -1;
                // 0x404ea8
                return 0;
            }
        }
    }
    // 0x404e84
    SetStdHandle(nStdHandle, NULL);
    // 0x404e8a
    *(int32_t *)(*v2 + v1) = -1;
    // 0x404ea8
    return 0;
}

// Address range: 0x404eab - 0x404ee8
int32_t function_404eab(uint32_t a1) {
    // 0x404eab
    if ((int32_t)g93 <= a1) {
        // 0x404ed3
        g51 = 0;
        g50 = 9;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x404ebf
    int32_t v2 = v1 + (8 * a1 & 248);
    if ((*(char *)(v2 + 4) & 1) != 0) {
        // 0x404ed0
        return *(int32_t *)v2;
    }
    // 0x404ed3
    g51 = 0;
    g50 = 9;
    return -1;
}

// Address range: 0x404ee8 - 0x4051a1
int32_t function_404ee8(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    int32_t v1 = 0x1000000 * a4 / 0x1000000;
    int32_t lpSecurityAttributes = 12; // bp-32, 0x404ef9
    char v2 = (char)(a2 / 8) & 16;
    char v3 = v2; // 0x404f20
    if ((int16_t)a2 > -1) {
        // 0x404f22
        v3 = (a2 & 0x4000) == 0 == g79 == 0x8000 ? v2 : v2 | -128;
    }
    char v4 = v3;
    int32_t dwDesiredAccess = -0x40000000; // 0x404ee8
    switch (a2 & 3) {
        case 0: {
            // 0x404f6b
            dwDesiredAccess = -0x80000000;
            goto lab_0x404f72;
        }
        case 1: {
            // 0x404f62
            dwDesiredAccess = 0x40000000;
            goto lab_0x404f72;
        }
        case 2: {
            goto lab_0x404f72;
        }
        default: {
            goto lab_0x404f44;
        }
    }
  lab_0x404f72:;
    int32_t dwShareMode = 2; // 0x404ee8
    switch (a3) {
        case 16: {
            // 0x404fa0
            dwShareMode = 0;
            goto lab_0x404fa3;
        }
        case 32: {
            // 0x404f97
            dwShareMode = 1;
            goto lab_0x404fa3;
        }
        case 48: {
            goto lab_0x404fa3;
        }
        default: {
            // 0x404f84
            dwShareMode = 3;
            if (a3 != 64) {
                // 0x404f44
                g50 = 22;
                g51 = 0;
                // 0x40519c
                return -1;
            }
            goto lab_0x404fa3;
        }
    }
  lab_0x404fa3:;
    uint32_t v5 = a2 & 1792; // 0x404fad
    int32_t dwCreationDisposition; // 0x404ee8
    if (v5 > 1024) {
        // 0x404fed
        dwCreationDisposition = 1;
        switch (v5) {
            case 1280: {
                goto lab_0x405016;
            }
            case 1536: {
                // 0x405006
                dwCreationDisposition = 5;
                goto lab_0x405016;
            }
            case 1792: {
                goto lab_0x405016;
            }
            default: {
                goto lab_0x404f44;
            }
        }
    } else {
        // 0x404fb8
        dwCreationDisposition = 4;
        switch (v5 / 256) {
            case 4: {
                // 0x404fe8
                dwCreationDisposition = 3;
                goto lab_0x405016;
            }
            case 0: {
                // 0x404fe8
                dwCreationDisposition = 3;
                goto lab_0x405016;
            }
            case 1: {
                goto lab_0x405016;
            }
            case 2: {
                // 0x405006
                dwCreationDisposition = 5;
                goto lab_0x405016;
            }
            default: {
                // 0x404fca
                dwCreationDisposition = 2;
                if (v5 != 768) {
                  lab_0x404f44:
                    // 0x404f44
                    g50 = 22;
                    g51 = 0;
                    // 0x40519c
                    return -1;
                }
                goto lab_0x405016;
            }
        }
    }
  lab_0x405016:;
    int32_t v6 = 128; // 0x405020
    if ((a2 & 256) != 0) {
        // 0x405022
        v6 = (char)((g52 ^ 128) & a5) <= -1 ? 128 : 1;
    }
    int32_t v7 = a2 / 16 & 256 | 0x100000 * a2 & 0x4000000 | v6;
    int32_t dwFlagsAndAttributes; // 0x404ee8
    if ((a2 & 32) == 0) {
        // 0x405056
        dwFlagsAndAttributes = v7 | 0x1000000 * a2 & 0x10000000;
    } else {
        // 0x40504e
        dwFlagsAndAttributes = v7 | 0x8000000;
    }
    // 0x405060
    int32_t v8; // 0x404ee8
    int32_t v9; // 0x404ee8
    int32_t v10; // 0x404ee8
    int32_t v11; // 0x404ee8
    int32_t result = function_404d25(v8, v9, v11, 12, 0, (int32_t)((char)a2 > -1), dwShareMode, dwDesiredAccess, dwCreationDisposition, v4, v10); // 0x405060
    if (result == -1) {
        // 0x40506e
        g51 = 0;
        g50 = 24;
        // 0x40519c
        return -1;
    }
    int32_t v12 = lpFileName; // bp-72, 0x405091
    int32_t * fileHandle = CreateFileA((char *)lpFileName, dwDesiredAccess, dwShareMode, (struct _SECURITY_ATTRIBUTES *)&lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, NULL); // 0x405094
    int32_t * v13 = &v12; // 0x40509e
    if (fileHandle != (int32_t *)-1) {
        int32_t v14 = (int32_t)fileHandle; // 0x405094
        int32_t v15 = GetFileType(fileHandle); // 0x4050a1
        int32_t v16; // bp-80, 0x404ee8
        if (v15 != 0) {
            char v17; // 0x404ee8
            if (v15 != 2) {
                // 0x4050d1
                v17 = v15 != 3 ? v4 : v4 | 8;
            } else {
                // 0x4050cb
                v17 = v4 | 64;
            }
            // 0x4050da
            v16 = v14;
            function_404dba(result, v14);
            char v18 = v17 | 1; // 0x4050ea
            int32_t * v19 = (int32_t *)(4 * result / 32 + (int32_t)&g91); // 0x4050ff
            int32_t v20 = 8 * result & 248 | 4;
            *(char *)(*v19 + v20) = v18;
            if ((a2 & 2) != 0 && v18 <= -1 && (v17 & 72) == 0) {
                // 0x405115
                v16 = 2;
                int32_t v21 = function_40337d(result, -1, 2); // 0x40511a
                if (v21 != -1) {
                    // 0x405138
                    v1 = 0;
                    v16 = 1;
                    if (function_402fc1(result, (int32_t)&v1, 1) == 0) {
                        // 0x40514f
                        if ((char)v1 == 26) {
                            // 0x405155
                            v16 = v21;
                            if (function_405949(result, v21) == -1) {
                                // 0x405177
                                v16 = result;
                                function_402e0a(result);
                                // 0x40519c
                                return -1;
                            }
                        }
                    }
                    // 0x405165
                    v16 = 0;
                    if (function_40337d(result, 0, 0) == -1) {
                        // 0x405177
                        v16 = result;
                        function_402e0a(result);
                        // 0x40519c
                        return -1;
                    }
                } else {
                    // 0x40512a
                    if (g51 != 131) {
                        // 0x405177
                        v16 = result;
                        function_402e0a(result);
                        // 0x40519c
                        return -1;
                    }
                }
            }
            // 0x405183
            if ((a2 & 8) != 0 && (v17 & 72) == 0) {
                char * v22 = (char *)(*v19 + v20); // 0x405191
                *v22 = *v22 | 32;
            }
            // 0x40519c
            return result;
        }
        // 0x4050ab
        v16 = v14;
        CloseHandle(fileHandle);
        v13 = &v16;
    }
    // 0x4050b2
    *(int32_t *)((int32_t)v13 - 4) = GetLastError();
    function_40492a((int32_t)&g112);
    // 0x40519c
    return -1;
}

// Address range: 0x4051b0 - 0x40522b
int32_t function_4051b0(int32_t a1) {
    int32_t v1 = a1; // 0x4051ba
    if ((a1 & 3) != 0) {
        int32_t v2 = a1;
        int32_t v3 = v2 + 1; // 0x4051be
        while (*(char *)v2 != 0) {
            // 0x4051c3
            v1 = v3;
            if ((v3 & 3) == 0) {
                goto lab_0x4051d0;
            }
            v2 = v3;
            v3 = v2 + 1;
        }
        // 0x405203
        return v3 + -1 - a1;
    }
  lab_0x4051d0:;
    int32_t v4 = v1; // 0x4051b0
    int32_t v5; // 0x4051b0
    while (true) {
        // 0x4051d0
        v5 = v4;
        uint32_t v6 = *(int32_t *)v5; // 0x4051d0
        int32_t v7 = v5 + 4; // 0x4051de
        if (((v6 ^ -0x7efeff00 ^ v6 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v6 == 0) {
                // break -> 0x405221
                break;
            }
            if ((v6 & 0xff00) == 0) {
                // 0x405217
                return 1 - a1 + v5;
            }
            if ((v6 & 0xff0000) == 0) {
                // 0x40520d
                return 2 - a1 + v5;
            }
            int32_t v8 = v7; // 0x4051ff
            if (v6 < 0x1000000) {
                // 0x405203
                return v8 + -1 - a1;
            }
        }
        // 0x4051d0
        v4 = v7;
    }
    // 0x405221
    return v5 - a1;
}

// Address range: 0x40522b - 0x405293
int32_t function_40522b(int32_t lpMultiByteStr, int32_t a2) {
    int32_t v1 = 0x10000 * a2 / 0x10000;
    int32_t lpWideCharStr = v1;
    int32_t lpUsedDefaultChar = lpMultiByteStr;
    if (lpMultiByteStr == 0) {
        // 0x405235
        return lpMultiByteStr;
    }
    // 0x405237
    if (g80 == 0) {
        if ((int16_t)v1 < 256) {
            // 0x40524b
            *(char *)lpMultiByteStr = (char)v1;
            return 1;
        }
        // 0x405284
        g50 = 42;
        // 0x405235
        return -1;
    }
    // 0x405252
    lpUsedDefaultChar = 0;
    int32_t result = WideCharToMultiByte(g81, 544, (int16_t *)&lpWideCharStr, 1, (char *)lpMultiByteStr, (int32_t)g49, NULL, (bool *)&lpUsedDefaultChar); // 0x405274
    if (result != 0 == lpUsedDefaultChar == 0) {
        // 0x405235
        return result;
    }
    // 0x405284
    g50 = 42;
    // 0x405235
    return -1;
}

// Address range: 0x405390 - 0x4053e8
int32_t function_405390(int32_t result, int32_t a2, int32_t a3) {
    // 0x405390
    if (a3 == 0) {
        // 0x4053dd
        return result;
    }
    int32_t v1 = a2 & 255;
    int32_t v2 = v1; // 0x4053a8
    int32_t v3 = a3; // 0x4053a8
    int32_t v4 = result; // 0x4053a8
    if (a3 >= 4) {
        int32_t v5 = -result & 3; // 0x4053ac
        int32_t v6 = a3; // 0x4053af
        int32_t v7 = result; // 0x4053af
        if (v5 != 0) {
            int32_t v8 = v5; // 0x4053b1
            *(char *)result = (char)a2;
            int32_t v9 = result + 1; // 0x4053b5
            v8--;
            int32_t v10 = v9; // 0x4053b7
            while (v8 != 0) {
                // 0x4053b3
                *(char *)v10 = (char)a2;
                v9 = v10 + 1;
                v8--;
                v10 = v9;
            }
            // 0x4053b9
            v6 = a3 - v5;
            v7 = v9;
        }
        int32_t v11 = 0x1010101 * v1; // 0x4053c5
        int32_t v12 = v6 & 3; // 0x4053c9
        v2 = v11;
        v3 = v12;
        v4 = v7;
        if (v6 >= 4) {
            uint32_t v13 = v6 / 4; // 0x4053cc
            __asm_rep_stosd_memset((char *)v7, v11, v13);
            v2 = v11;
            v3 = v12;
            bool v14; // 0x405390
            v4 = v13 * (v14 ? -4 : 4) + v7;
            if (v12 == 0) {
                // 0x4053dd
                return result;
            }
        }
    }
    int32_t v15 = v3; // 0x4053da
    int32_t v16 = v4; // 0x405390
    *(char *)v16 = (char)v2;
    v15--;
    v16++;
    while (v15 != 0) {
        // 0x4053d7
        *(char *)v16 = (char)v2;
        v15--;
        v16++;
    }
    // 0x4053dd
    return result;
}

// Address range: 0x4053f0 - 0x4053f7
int32_t function_4053f0(int32_t a1) {
    // 0x4053f0
    int32_t v1; // 0x4053f0
    return function_405461(v1, (int32_t)&g112, (int32_t)&g112);
}

// Address range: 0x405400 - 0x405461
int32_t function_405400(int32_t * a1, int32_t a2) {
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1; // 0x40540b
    int32_t v3 = v1; // 0x40540b
    int32_t result; // 0x405452
    if ((v1 & 3) != 0) {
        while (*(char *)v2 != 0) {
            // 0x405414
            v2++;
            v3 = v2;
            if ((v2 & 3) == 0) {
                goto lab_0x40541c;
            }
        }
        // 0x40544f
        result = function_405461((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        return result;
    }
  lab_0x40541c:;
    int32_t v4 = v3; // 0x405400
    uint32_t result4; // 0x40541c
    while (true) {
        // 0x40541c
        result4 = *(int32_t *)v4;
        if (((result4 ^ -0x7efeff00 ^ result4 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)result4 == 0) {
                // break -> 0x40545e
                break;
            }
            if ((result4 & 0xff00) == 0) {
                int32_t result2 = function_405461((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x40545c
                return result2;
            }
            if ((result4 & 0xff0000) == 0) {
                int32_t result3 = function_405461((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x405457
                return result3;
            }
            if (result4 < 0x1000000) {
                // 0x40544f
                result = function_405461((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
                return result;
            }
        }
        // 0x40541c
        v4 += 4;
    }
    // 0x40545e
    return result4;
}

// Address range: 0x405461 - 0x4054e0
int32_t function_405461(int32_t a1, int32_t result, int32_t a3) {
    int32_t v1 = a3; // 0x40546b
    int32_t v2 = a3; // 0x40546b
    int32_t v3; // 0x405461
    if ((a3 & 3) != 0) {
        char v4 = *(char *)v1; // 0x40546d
        int32_t v5; // 0x405461
        while (v4 != 0) {
            // 0x405474
            v1++;
            *(char *)v5 = v4;
            int32_t v6 = v5 + 1; // 0x405476
            v5 = v6;
            v2 = v1;
            v3 = v6;
            if ((v1 & 3) == 0) {
                goto lab_0x405486;
            }
            v4 = *(char *)v1;
        }
        // 0x4054d8
        *(char *)v5 = 0;
        return result;
    }
  lab_0x405486:;
    int32_t v7 = v2; // 0x405461
    int32_t v8 = v3; // 0x405461
    int32_t v9; // 0x405461
    while (true) {
        int32_t v10 = v8;
        uint32_t v11 = *(int32_t *)v7;
        if (((v11 ^ -0x7efeff00 ^ v11 + 0x7efefeff) & -0x7efeff00) != 0) {
            // 0x4054a0
            v9 = v10;
            if ((char)v11 == 0) {
                // break -> 0x4054d8
                break;
            }
            if ((v11 & 0xff00) == 0) {
                // 0x4054cf
                *(int16_t *)v10 = (int16_t)v11;
                return result;
            }
            if ((v11 & 0xff0000) == 0) {
                // 0x4054c2
                *(int16_t *)v10 = (int16_t)v11;
                *(char *)(v10 + 2) = 0;
                return result;
            }
            if (v11 < 0x1000000) {
                // 0x4054ba
                *(int32_t *)v10 = v11;
                return result;
            }
        }
        // 0x405481
        *(int32_t *)v10 = v11;
        v7 += 4;
        v8 = v10 + 4;
    }
    // 0x4054d8
    *(char *)v9 = 0;
    return result;
}

// Address range: 0x4054e0 - 0x405679
int32_t function_4054e0(int32_t a1) {
    // 0x4054e0
    int32_t v1; // 0x4054e0
    int32_t v2; // 0x4054e0
    int32_t v3; // 0x4054e0
    int32_t CodePage = function_405679(a1, v1, v2, v3); // 0x4054ec
    if (CodePage == g84) {
        // 0x405674
        return 0;
    }
    int32_t v4 = &g46; // 0x405507
    if (CodePage == 0) {
      lab_0x405663:
        // 0x405663
        function_4056f6();
        // 0x405668
        function_40571f();
        // 0x405674
        return 0;
    }
    int32_t v5 = 0;
    while (*(int32_t *)v4 != CodePage) {
        // 0x405518
        v4 += 48;
        if (v4 >= (int32_t)&g49) {
            // 0x405523
            int32_t lpCPInfo; // bp-28, 0x4054e0
            GetCPInfo(CodePage, (struct _cpinfo *)&lpCPInfo);
            if (g75 == 0) {
                return -1;
            } else {
                goto lab_0x405663;
            }
        }
        v5++;
    }
    // 0x40558a
    __asm_rep_stosd_memset((char *)&g88, 0, 64);
    int32_t v6 = 48 * v5; // 0x40559c
    bool v7; // 0x4054e0
    char * v8 = v7 ? (char *)((int32_t)&g88 - 256) : (char *)((int32_t)&g88 + 256); // 0x40559f
    *v8 = 0;
    int32_t v9 = v6 + (int32_t)&g48;
    int32_t v10 = 0;
    char v11 = *(char *)v9; // 0x4055a6
    unsigned char v12; // 0x4055b4
    int32_t v13; // 0x4054e0
    int32_t v14; // 0x4054e0
    int32_t v15; // 0x4054e0
    char * v16; // 0x4054e0
    unsigned char v17; // 0x4055ad
    int32_t v18; // 0x4055d3
    char v19; // 0x4055d4
    char * v20; // 0x4055c7
    if (v11 != 0) {
        // 0x4055ad
        v16 = (char *)(v10 + (int32_t)&g45);
        v19 = v11;
        v15 = v9;
        v17 = *(char *)(v15 + 1);
        while (v17 != 0) {
            // 0x4055b4
            v12 = v19;
            if (v17 >= v12) {
                // 0x4055be
                v14 = v12;
                v20 = (char *)(v14 + (int32_t)&g89);
                *v20 = *v20 | *v16;
                v13 = v14 + 1;
                while (v14 != (int32_t)v17) {
                    // 0x4055c7
                    v14 = v13;
                    v20 = (char *)(v14 + (int32_t)&g89);
                    *v20 = *v20 | *v16;
                    v13 = v14 + 1;
                }
            }
            // 0x4055d2
            v18 = v15 + 2;
            v19 = *(char *)v18;
            if (v19 == 0) {
                // break -> 0x4055d9
                break;
            }
            v15 = v18;
            v17 = *(char *)(v15 + 1);
        }
    }
    int32_t v21 = v10 + 1; // 0x4055d9
    int32_t v22 = v9 + 8; // 0x4055e3
    while (v21 != 4) {
        // 0x4055a6
        v9 = v22;
        v10 = v21;
        v11 = *(char *)v9;
        if (v11 != 0) {
            // 0x4055ad
            v16 = (char *)(v10 + (int32_t)&g45);
            v19 = v11;
            v15 = v9;
            v17 = *(char *)(v15 + 1);
            while (v17 != 0) {
                // 0x4055b4
                v12 = v19;
                if (v17 >= v12) {
                    // 0x4055be
                    v14 = v12;
                    v20 = (char *)(v14 + (int32_t)&g89);
                    *v20 = *v20 | *v16;
                    v13 = v14 + 1;
                    while (v14 != (int32_t)v17) {
                        // 0x4055c7
                        v14 = v13;
                        v20 = (char *)(v14 + (int32_t)&g89);
                        *v20 = *v20 | *v16;
                        v13 = v14 + 1;
                    }
                }
                // 0x4055d2
                v18 = v15 + 2;
                v19 = *(char *)v18;
                if (v19 == 0) {
                    // break -> 0x4055d9
                    break;
                }
                v15 = v18;
                v17 = *(char *)(v15 + 1);
            }
        }
        // 0x4055d9
        v21 = v10 + 1;
        v22 = v9 + 8;
    }
    // 0x4055e5
    g86 = 1;
    g84 = CodePage;
    int32_t v23 = function_4056c3(CodePage); // 0x4055f8
    int32_t v24 = v6 + (int32_t)&g47; // 0x4055fd
    g85 = *(int32_t *)v24;
    int32_t v25 = v7 ? -4 : 4; // 0x405608
    int32_t v26 = v25 + (int32_t)&g85; // 0x405608
    int32_t v27 = v24 + v25; // 0x405608
    *(int32_t *)v26 = *(int32_t *)v27;
    g90 = v23;
    *(int32_t *)(v26 + v25) = *(int32_t *)(v27 + v25);
    // 0x405668
    function_40571f();
    // 0x405674
    return 0;
}

// Address range: 0x405679 - 0x40567d
int32_t function_405679(int32_t result, int32_t a2, int32_t a3, int32_t a4) {
    // 0x405679
    return result;
}

// Address range: 0x4056c3 - 0x4056f6
int32_t function_4056c3(int32_t a1) {
    int32_t result = 1041; // 0x4056c3
    switch (a1) {
        case 936: {
            // 0x4056db
            return 2052;
        }
        default: {
            int32_t v1 = a1 - 949; // 0x4056d3
            result = 1042;
            if (v1 != 0) {
                // 0x4056d8
                result = v1 == 1 ? 1028 : 0;
            }
        }
        case 932: {
            // 0x4056db
            return result;
        }
    }
}

// Address range: 0x4056f6 - 0x40571f
int32_t function_4056f6(void) {
    // 0x4056f6
    __asm_rep_stosd_memset((char *)&g88, 0, 64);
    bool v1; // 0x4056f6
    char * v2 = v1 ? (char *)((int32_t)&g88 - 256) : (char *)((int32_t)&g88 + 256); // 0x405703
    *v2 = 0;
    g84 = 0;
    g86 = 0;
    g90 = 0;
    g85 = 0;
    int32_t * v3 = v1 ? (int32_t *)((int32_t)&g85 - 4) : (int32_t *)((int32_t)&g85 + 4); // 0x40571b
    *v3 = 0;
    int32_t * v4 = v1 ? (int32_t *)((int32_t)&g85 - 8) : (int32_t *)((int32_t)&g85 + 8); // 0x40571c
    *v4 = 0;
    return 0;
}

// Address range: 0x40571f - 0x4058a4
int32_t function_40571f(void) {
    // 0x40571f
    int32_t lpCPInfo; // bp-24, 0x40571f
    GetCPInfo(g84, (struct _cpinfo *)&lpCPInfo);
    int32_t v1 = 0; // 0x40585a
    int32_t v2; // 0x40571f
    while (true) {
      lab_0x40585f:
        // 0x40585f
        v2 = v1;
        int32_t v3; // 0x40571f
        if (v2 < 91) {
            char * v4 = (char *)(v2 + (int32_t)&g89); // 0x405869
            *v4 = *v4 | 16;
            // 0x405875
            v3 = v2 + 32;
            *(char *)(v2 + (int32_t)&g87) = (char)v3;
            goto lab_0x40589c;
        } else {
            if (v2 < 123) {
                char * v5 = (char *)(v2 + (int32_t)&g89); // 0x405887
                *v5 = *v5 | 32;
                // 0x405875
                v3 = v2 + 224;
                *(char *)(v2 + (int32_t)&g87) = (char)v3;
                goto lab_0x40589c;
            } else {
                // 0x405895
                *(char *)(v2 + (int32_t)&g87) = 0;
                goto lab_0x40589c;
            }
        }
    }
    // 0x4058a1
    return 256;
  lab_0x40589c:
    // 0x40589c
    v1 = v2 + 1;
    if (v1 == 256) {
        return 256;
    }
    goto lab_0x40585f;
}

// Address range: 0x4058a4 - 0x4058c0
int32_t function_4058a4(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4058a4
    int32_t result; // 0x4058a4
    if (g106 == 0) {
        int32_t v1 = function_4054e0(-3); // 0x4058af
        g106 = 1;
        result = v1;
    }
    // 0x4058bf
    return result;
}

// Address range: 0x4058c0 - 0x405949
int32_t function_4058c0(int32_t * a1, char * a2, int32_t a3) {
    // 0x4058c0
    int32_t v1; // bp-12, 0x4058c0
    int32_t * v2 = &v1; // 0x4058cb
    if (g76 == 0) {
        int32_t * moduleHandle = LoadLibraryA("user32.dll"); // 0x4058d2
        if (moduleHandle == NULL) {
            // 0x405941
            return 0;
        }
        int32_t (*func)() = GetProcAddress(moduleHandle, "MessageBoxA"); // 0x4058ea
        g76 = (int32_t)func;
        if (func == NULL) {
            // 0x405941
            return 0;
        }
        int32_t (*func2)() = GetProcAddress(moduleHandle, "GetActiveWindow"); // 0x4058fb
        int32_t v3 = (int32_t)moduleHandle; // bp-40, 0x405902
        g77 = (int32_t)func2;
        g78 = (int32_t)GetProcAddress(moduleHandle, "GetLastActivePopup");
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t result = 0; // 0x405916
    int32_t v5 = 0; // 0x405916
    int32_t v6 = v4; // 0x405916
    if (g77 != 0) {
        // 0x405920
        result = 0;
        v5 = g77;
        v6 = v4;
        if (g78 != 0) {
            int32_t v7 = v4 - 4; // 0x405929
            *(int32_t *)v7 = g77;
            result = g78;
            v5 = g78;
            v6 = v7;
        }
    }
    int32_t v8 = v6;
    *(int32_t *)(v8 - 4) = *(int32_t *)(v8 + 24);
    *(int32_t *)(v8 - 8) = *(int32_t *)(v8 + 20);
    *(int32_t *)(v8 - 12) = *(int32_t *)(v8 + 16);
    *(int32_t *)(v8 - 16) = v5;
    // 0x405941
    return result;
}

// Address range: 0x405949 - 0x405a8f
int32_t function_405949(uint32_t a1, int32_t a2) {
    // 0x405949
    int32_t v1; // 0x405949
    function_405eb0(v1);
    if ((int32_t)g93 <= a1) {
        // 0x405a7e
        g50 = 9;
        // 0x405a8b
        return -1;
    }
    int32_t v2 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x405973
    if ((*(char *)(v2 + (8 * a1 & 248 | 4)) & 1) == 0) {
        // 0x405a7e
        g50 = 9;
        // 0x405a8b
        return -1;
    }
    int32_t v3 = 1; // bp-16, 0x405985
    int32_t v4 = 0; // bp-20, 0x405987
    int32_t v5 = function_40337d(a1, 0, 1); // 0x405989
    if (v5 == -1) {
        // 0x405a8b
        return -1;
    }
    // 0x40599d
    v3 = 2;
    v4 = 0;
    int32_t v6 = function_40337d(a1, 0, 2); // 0x4059a1
    if (v6 == -1) {
        // 0x405a8b
        return -1;
    }
    int32_t v7 = &v3; // 0x4059b2
    int32_t v8 = a2 - v6; // 0x4059b6
    int32_t result; // 0x405949
    int32_t v9; // 0x405949
    if (v8 < 1) {
        // 0x405a2b
        v9 = v7;
        result = 0;
        if (v8 != 0) {
            // 0x405a2d
            function_40337d(a1, a2, 0);
            int32_t hFile = function_404eab(a1); // 0x405a39
            v4 = hFile;
            int32_t v10 = &v4; // 0x405a41
            bool v11 = SetEndOfFile((int32_t *)hFile); // 0x405a42
            int32_t v12 = !v11; // 0x405a50
            v9 = v10;
            result = v12;
            if (!v11) {
                // 0x405a56
                g50 = 13;
                g51 = GetLastError();
                v9 = v10;
                result = v12;
            }
        }
    } else {
        // 0x4059bc
        v4 = 0x1000;
        int32_t v13; // bp-4100, 0x405949
        int32_t v14 = &v13; // 0x4059c8
        function_405390(v14, 0, 0x1000);
        int32_t v15 = function_405e30(a1, 0x8000); // 0x4059d4
        int32_t * v16 = (int32_t *)(v7 - 4);
        int32_t * v17 = (int32_t *)(v7 - 8);
        int32_t v18 = v8;
        *v16 = v18 < 0x1000 ? v18 : 0x1000;
        *v17 = v14;
        *(int32_t *)(v7 - 12) = a1;
        int32_t v19 = function_401f92((int32_t)&g112, (int32_t)&g112, (int32_t)&g112); // 0x4059f3
        int32_t v20; // 0x405949
        while (v19 != -1) {
            int32_t v21 = v18 - v19; // 0x405a00
            v20 = 0;
            if (v21 < 1) {
                goto lab_0x405a1e;
            }
            v18 = v21;
            *v16 = v18 < 0x1000 ? v18 : 0x1000;
            *v17 = v14;
            *(int32_t *)(v7 - 12) = a1;
            v19 = function_401f92((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
        }
        // 0x405a08
        v20 = -1;
        if (g51 == 5) {
            // 0x405a11
            g50 = 13;
            v20 = -1;
        }
      lab_0x405a1e:
        // 0x405a1e
        *v16 = v15;
        *v17 = a1;
        function_405e30((int32_t)&g112, (int32_t)&g112);
        v9 = v7;
        result = v20;
    }
    // 0x405a6b
    *(int32_t *)(v9 - 4) = 0;
    *(int32_t *)(v9 - 8) = v5;
    *(int32_t *)(v9 - 12) = a1;
    function_40337d((int32_t)&g112, (int32_t)&g112, (int32_t)&g112);
    // 0x405a8b
    return result;
}

// Address range: 0x405a8f - 0x405a98
int32_t function_405a8f(void) {
    // 0x405a8f
    return __amsg_exit();
}

// Address range: 0x405a98 - 0x405cbc
int32_t function_405a98(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x405aad
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g82; // 0x405ac6
    int32_t v3; // bp-60, 0x405a98
    int32_t * v4 = &v3; // 0x405ac6
    if (g82 == 0) {
        int32_t v5 = 0; // bp-84, 0x405ad9
        if (LCMapStringW(0, 256, (int16_t *)&g3, 1, NULL, 0) == 0) {
            int32_t v6 = 0; // bp-108, 0x405af5
            if (LCMapStringA(0, 256, (char *)&g2, 1, NULL, 0) == 0) {
                // 0x405c28
                __writefsdword(0, v1);
                return 0;
            }
            // 0x405b04
            g82 = 2;
            v2 = 2;
            v4 = &v6;
        } else {
            // 0x405ae4
            g82 = 1;
            v2 = 1;
            v4 = &v5;
        }
    }
    int32_t v7 = (int32_t)a5;
    int32_t v8 = (int32_t)v4;
    int32_t v9 = v2; // 0x405b11
    int32_t v10 = v7; // 0x405b11
    if (a5 > NULL) {
        // 0x405b13
        *(int32_t *)(v8 - 4) = v7;
        *(int32_t *)(v8 - 8) = a4;
        v10 = function_405cbc((int32_t)&g112, (int32_t)&g112);
        v9 = g82;
    }
    // 0x405b23
    if (v9 == 2) {
        // 0x405b2d
        *(int32_t *)(v8 - 4) = a7;
        *(int32_t *)(v8 - 8) = a6;
        *(int32_t *)(v8 - 12) = v10;
        *(int32_t *)(v8 - 16) = a4;
        *(int32_t *)(v8 - 20) = a2;
        *(int32_t *)(v8 - 24) = a1;
        int32_t result = LCMapStringA((int32_t)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112); // 0x405b3f
        // 0x405c28
        __writefsdword(0, v1);
        return result;
    }
    // 0x405b4a
    if (v9 != 1) {
        // 0x405c28
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v11 = a8 != 0 ? a8 : g81;
    *(int32_t *)(v8 - 4) = 0;
    *(int32_t *)(v8 - 8) = 0;
    *(int32_t *)(v8 - 12) = v10;
    *(int32_t *)(v8 - 16) = a4;
    *(int32_t *)(v8 - 20) = a9 == 0 ? 1 : 9;
    int32_t v12 = v8 - 24; // 0x405b74
    *(int32_t *)v12 = v11;
    int32_t v13 = MultiByteToWideChar((int32_t)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405b77
    if (v13 == 0) {
        // 0x405c28
        __writefsdword(0, v1);
        return 0;
    }
    // 0x405b8a
    function_405eb0(v13);
    if (v12 == 0) {
        // 0x405c28
        __writefsdword(0, v1);
        return 0;
    }
    // 0x405bc0
    *(int32_t *)(v8 - 28) = v13;
    *(int32_t *)(v8 - 32) = v12;
    *(int32_t *)(v8 - 36) = v10;
    *(int32_t *)(v8 - 40) = a4;
    *(int32_t *)(v8 - 44) = 1;
    *(int32_t *)(v8 - 48) = v11;
    int32_t v14 = MultiByteToWideChar((int32_t)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405bcf
    if (v14 == 0) {
        // 0x405c28
        __writefsdword(0, v1);
        return 0;
    }
    // 0x405bd9
    *(int32_t *)(v8 - 52) = 0;
    *(int32_t *)(v8 - 56) = 0;
    *(int32_t *)(v8 - 60) = v13;
    *(int32_t *)(v8 - 64) = v12;
    *(int32_t *)(v8 - 68) = a2;
    int32_t v15 = v8 - 72; // 0x405be2
    *(int32_t *)v15 = a1;
    int32_t Locale = LCMapStringW((int32_t)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405be5
    if (Locale == 0) {
        // 0x405c28
        __writefsdword(0, v1);
        return 0;
    }
    int32_t result2; // 0x405a98
    if (((int32_t)a3 & 4) == 0) {
        // 0x405c3a
        function_405eb0(Locale);
        if (v15 == 0) {
            // 0x405c28
            __writefsdword(0, v1);
            return 0;
        }
        // 0x405c72
        *(int32_t *)(v8 - 76) = Locale;
        *(int32_t *)(v8 - 80) = v15;
        *(int32_t *)(v8 - 84) = v13;
        *(int32_t *)(v8 - 88) = v12;
        *(int32_t *)(v8 - 92) = a2;
        *(int32_t *)(v8 - 96) = a1;
        int32_t v16 = LCMapStringW((int32_t)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405c80
        if (v16 == 0) {
            // 0x405c28
            __writefsdword(0, v1);
            return 0;
        }
        // 0x405c8a
        *(int32_t *)(v8 - 100) = 0;
        *(int32_t *)(v8 - 104) = 0;
        int32_t * v17 = (int32_t *)(v8 - 108);
        int32_t v18; // 0x405a98
        if (a7 != 0) {
            // 0x405c95
            *v17 = a7;
            int32_t v19 = v8 - 112; // 0x405c98
            *(int32_t *)v19 = a6;
            v18 = v19;
        } else {
            // 0x405c91
            *v17 = 0;
            int32_t v20 = v8 - 112; // 0x405c92
            *(int32_t *)v20 = 0;
            v18 = v20;
        }
        // 0x405c9b
        *(int32_t *)(v18 - 4) = Locale;
        *(int32_t *)(v18 - 8) = v15;
        *(int32_t *)(v18 - 12) = 544;
        *(int32_t *)(v18 - 16) = v11;
        int32_t v21 = WideCharToMultiByte((int32_t)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (char *)&g112, (bool *)&g112); // 0x405ca5
        result2 = v21;
        if (v21 == 0) {
            // 0x405c28
            __writefsdword(0, v1);
            return 0;
        }
    } else {
        // 0x405bfa
        result2 = Locale;
        if (a7 != 0) {
            // 0x405c03
            if (Locale > a7) {
                // 0x405c28
                __writefsdword(0, v1);
                return 0;
            }
            // 0x405c08
            *(int32_t *)(v8 - 76) = a7;
            *(int32_t *)(v8 - 80) = a6;
            *(int32_t *)(v8 - 84) = v13;
            *(int32_t *)(v8 - 88) = v12;
            *(int32_t *)(v8 - 92) = a2;
            *(int32_t *)(v8 - 96) = a1;
            int32_t v22 = LCMapStringW(Locale, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405c18
            result2 = Locale;
            if (v22 == 0) {
                // 0x405c28
                __writefsdword(0, v1);
                return 0;
            }
        }
    }
    // 0x405c28
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x405cbc - 0x405ce7
int32_t function_405cbc(int32_t a1, int32_t result) {
    int32_t v1 = a1; // 0x405cca
    int32_t v2 = result; // 0x405cca
    int32_t v3 = a1; // 0x405cca
    if (result != 0) {
        v3 = v1;
        while (*(char *)v1 != 0) {
            // 0x405cd1
            v2--;
            v1++;
            v3 = v1;
            if (v2 == 0) {
                // break -> 0x405cd9
                break;
            }
            v3 = v1;
        }
    }
    // 0x405cd9
    if (*(char *)v3 != 0) {
        // 0x405ce4
        return result;
    }
    // 0x405cdf
    return v3 - a1;
}

// Address range: 0x405ce7 - 0x405e30
int32_t function_405ce7(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x405cfc
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g83; // 0x405d16
    int32_t v3; // bp-56, 0x405ce7
    int32_t * v4 = &v3; // 0x405d16
    if (g83 == 0) {
        int32_t v5 = 1; // bp-72, 0x405d25
        int32_t lpCharType; // bp-32, 0x405ce7
        bool v6 = GetStringTypeW(1, (int16_t *)&g3, 1, (int16_t *)&lpCharType); // 0x405d26
        int32_t v7 = 1; // 0x405d2e
        v4 = &v5;
        if (!v6) {
            int32_t v8 = 0; // bp-92, 0x405d3f
            bool v9 = GetStringTypeA(0, 1, (char *)&g2, 1, (int16_t *)&lpCharType); // 0x405d40
            v7 = 2;
            v4 = &v8;
            if (!v9) {
                // 0x405e1e
                __writefsdword(0, v1);
                return 0;
            }
        }
        // 0x405d51
        v2 = v7;
        g83 = v2;
    }
    int32_t v10 = (int32_t)a4;
    int32_t v11 = (int32_t)v4;
    if (v2 == 2) {
        // 0x405d5b
        *(int32_t *)(v11 - 4) = v10;
        *(int32_t *)(v11 - 8) = a3;
        *(int32_t *)(v11 - 12) = (int32_t)a2;
        *(int32_t *)(v11 - 16) = a1;
        *(int32_t *)(v11 - 20) = a6 != 0 ? a6 : g80;
        bool result = GetStringTypeA((int32_t)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (int16_t *)&g112); // 0x405d74
        // 0x405e1e
        __writefsdword(0, v1);
        return result;
    }
    // 0x405d7f
    if (v2 != 1) {
        // 0x405e1e
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v12 = a5 != 0 ? a5 : g81;
    *(int32_t *)(v11 - 4) = 0;
    *(int32_t *)(v11 - 8) = 0;
    *(int32_t *)(v11 - 12) = a3;
    int32_t v13 = (int32_t)a2; // 0x405d9a
    *(int32_t *)(v11 - 16) = v13;
    *(int32_t *)(v11 - 20) = a7 == 0 ? 1 : 9;
    int32_t v14 = v11 - 24; // 0x405da9
    *(int32_t *)v14 = v12;
    int32_t v15 = MultiByteToWideChar((int32_t)&g112, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405dac
    if (v15 == 0) {
        // 0x405e1e
        __writefsdword(0, v1);
        return 0;
    }
    // 0x405db9
    function_405eb0(v15);
    int32_t * v16 = (int32_t *)(v11 - 28); // 0x405dd3
    *v16 = 2 * v15;
    int32_t * v17 = (int32_t *)(v11 - 32); // 0x405dd4
    *v17 = 0;
    int32_t * v18 = (int32_t *)(v11 - 36); // 0x405dd5
    *v18 = v14;
    function_405390(v14, (int32_t)&g112, (int32_t)&g112);
    if (v14 == 0) {
        // 0x405e1e
        __writefsdword(0, v1);
        return 0;
    }
    // 0x405df3
    *v16 = v15;
    *v17 = v14;
    *v18 = a3;
    *(int32_t *)(v11 - 40) = v13;
    *(int32_t *)(v11 - 44) = 1;
    *(int32_t *)(v11 - 48) = v12;
    int32_t v19 = MultiByteToWideChar(-1, (int32_t)&g112, (char *)&g112, (int32_t)&g112, (int16_t *)&g112, (int32_t)&g112); // 0x405e02
    int32_t result2 = 0; // 0x405e0a
    if (v19 != 0) {
        // 0x405e0c
        *(int32_t *)(v11 - 52) = v10;
        *(int32_t *)(v11 - 56) = v19;
        *(int32_t *)(v11 - 60) = v14;
        *(int32_t *)(v11 - 64) = a1;
        bool v20 = GetStringTypeW((int32_t)&g112, (int16_t *)&g112, (int32_t)&g112, (int16_t *)&g112); // 0x405e14
        result2 = v20;
    }
    // 0x405e1e
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x405e30 - 0x405ea6
int32_t function_405e30(uint32_t a1, int32_t a2) {
    // 0x405e30
    if ((int32_t)g93 <= a1) {
        // 0x405ea1
        g50 = 9;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g91); // 0x405e45
    char * v2 = (char *)(v1 + (8 * a1 & 248 | 4)); // 0x405e50
    unsigned char v3 = *v2; // 0x405e50
    if ((v3 & 1) == 0) {
        // 0x405ea1
        g50 = 9;
        return -1;
    }
    if (a2 == 0x8000) {
        // 0x405e7d
        *v2 = v3 & 127;
        return v3 > 255 ? 0x8000 : 0x4000;
    }
    // 0x405e70
    if (a2 != 0x4000) {
        // 0x405ea1
        g50 = 22;
        return -1;
    }
    // 0x405e7d
    *v2 = v3 | -128;
    return v3 > -1 ? 0x8000 : 0x4000;
}

// Address range: 0x405eb0 - 0x405edf
int32_t function_405eb0(int32_t result) {
    // 0x405eb0
    int32_t v1; // 0x405eb0
    int32_t v2 = &v1; // 0x405eb6
    int32_t v3 = v2; // 0x405eba
    uint32_t v4; // 0x405eb0
    if (v4 < 0x1000) {
        // 0x405ed0
        int32_t v5; // 0x405eb0
        *(int32_t *)(-4 - v5 + v2) = result;
        return result;
    }
    v3 -= 0x1000;
    int32_t v6; // 0x405eb0
    int32_t v7 = v6 - 0x1000; // 0x405ec2
    while (v7 >= 0x1000) {
        // 0x405ebc
        v3 -= 0x1000;
        v7 -= 0x1000;
    }
    // 0x405ed0
    *(int32_t *)(-4 - v7 + v3) = result;
    return result;
}

// Address range: 0x405ee0 - 0x405ee6
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue) {
    // 0x405ee0
    RtlUnwind(TargetFrame, TargetIp, ExceptionRecord, ReturnValue);
}

// Address range: 0x287aad7 - 0x287aad8
int32_t function_287aad7(void) {
    // 0x287aad7
    int32_t result; // 0x287aad7
    return result;
}

// Address range: 0x287d277 - 0x287d278
int32_t function_287d277(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8) {
    // 0x287d277
    int32_t result; // 0x287d277
    return result;
}

// Address range: 0xf9c37359 - 0xf9c3735a
int32_t function_f9c37359(void) {
    // 0xf9c37359
    int32_t result; // 0xf9c37359
    return result;
}

// --------------- Statically Linked Functions ----------------

// int32_t __amsg_exit(void);
// int32_t __aulldiv(void);
// int32_t __aullrem(int32_t a1, int32_t a2);
// int32_t __global_unwind2(void);
// int32_t __local_unwind2(void);
// int32_t __NLG_Notify(void);
// int32_t _flsall(int32_t a1);
// void * malloc(size_t size);

// --------------- Dynamically Linked Functions ---------------

// BOOL CloseHandle(_In_ HANDLE hObject);
// HANDLE CreateFileA(_In_ LPCSTR lpFileName, _In_ DWORD dwDesiredAccess, _In_ DWORD dwShareMode, _In_opt_ LPSECURITY_ATTRIBUTES lpSecurityAttributes, _In_ DWORD dwCreationDisposition, _In_ DWORD dwFlagsAndAttributes, _In_opt_ HANDLE hTemplateFile);
// VOID ExitProcess(_In_ UINT uExitCode);
// BOOL FlushFileBuffers(_In_ HANDLE hFile);
// BOOL FreeEnvironmentStringsA(_In_ LPCH penv);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// LPSTR GetCommandLineA(VOID);
// BOOL GetCPInfo(_In_ UINT CodePage, _Out_ LPCPINFO lpCPInfo);
// HANDLE GetCurrentProcess(VOID);
// LPCH GetEnvironmentStrings(VOID);
// LPWCH GetEnvironmentStringsW(void);
// DWORD GetFileType(_In_ HANDLE hFile);
// DWORD GetLastError(VOID);
// DWORD GetModuleFileNameA(_In_opt_ HMODULE hModule, LPSTR lpFilename, _In_ DWORD nSize);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// VOID GetStartupInfoA(_Out_ LPSTARTUPINFOA lpStartupInfo);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// BOOL GetStringTypeA(_In_ LCID Locale, _In_ DWORD dwInfoType, LPCSTR lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// BOOL GetStringTypeW(_In_ DWORD dwInfoType, LPCWCH lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// NOT_BUILD_WINDOWS_DEPRECATE DWORD GetVersion(VOID);
// LPVOID HeapAlloc(_In_ HANDLE hHeap, _In_ DWORD dwFlags, _In_ SIZE_T dwBytes);
// HANDLE HeapCreate(_In_ DWORD flOptions, _In_ SIZE_T dwInitialSize, _In_ SIZE_T dwMaximumSize);
// BOOL HeapDestroy(_In_ HANDLE hHeap);
// BOOL HeapFree(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem);
// LPVOID HeapReAlloc(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem, _In_ SIZE_T dwBytes);
// int LCMapStringA(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCSTR lpSrcStr, _In_ int cchSrc, LPSTR lpDestStr, _In_ int cchDest);
// int LCMapStringW(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCWSTR lpSrcStr, _In_ int cchSrc, LPWSTR lpDestStr, _In_ int cchDest);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// int MultiByteToWideChar(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCCH lpMultiByteStr, _In_ int cbMultiByte, LPWSTR lpWideCharStr, _In_ int cchWideChar);
// BOOL ReadFile(_In_ HANDLE hFile, LPVOID lpBuffer, _In_ DWORD nNumberOfBytesToRead, _Out_opt_ LPDWORD lpNumberOfBytesRead, _Inout_opt_ LPOVERLAPPED lpOverlapped);
// VOID RtlUnwind(_In_opt_ PVOID TargetFrame, _In_opt_ PVOID TargetIp, _In_opt_ PEXCEPTION_RECORD ExceptionRecord, _In_ PVOID ReturnValue);
// BOOL SetEndOfFile(_In_ HANDLE hFile);
// DWORD SetFilePointer(_In_ HANDLE hFile, _In_ LONG lDistanceToMove, _Inout_opt_ PLONG lpDistanceToMoveHigh, _In_ DWORD dwMoveMethod);
// UINT SetHandleCount(_In_ UINT uNumber);
// BOOL SetStdHandle(_In_ DWORD nStdHandle, _In_ HANDLE hHandle);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// LONG UnhandledExceptionFilter(_In_ struct _EXCEPTION_POINTERS * ExceptionInfo);
// LPVOID VirtualAlloc(_In_opt_ LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD flAllocationType, _In_ DWORD flProtect);
// BOOL VirtualFree(LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD dwFreeType);
// int WideCharToMultiByte(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCWCH lpWideCharStr, _In_ int cchWideChar, LPSTR lpMultiByteStr, _In_ int cbMultiByte, _In_opt_ LPCCH lpDefaultChar, _Out_opt_ LPBOOL lpUsedDefaultChar);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (6.0)
// Detected language: C++
// Detected functions: 100
